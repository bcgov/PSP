/* ---------------------------------------------------------------------- */
/* Script generated with: DeZign for Databases 12.4.2                     */
/* Target DBMS:           MS SQL Server 2017                              */
/* Project file:          PIMS S13.00.dez                                 */
/* Project name:          MoTI Property Services Project                  */
/* Author:                Doug Filteau                                    */
/* Script type:           Database creation script                        */
/* Created on:            2021-10-22 09:47                                */
/* ---------------------------------------------------------------------- */


/* ---------------------------------------------------------------------- */
/* Add sequences                                                          */
/* ---------------------------------------------------------------------- */

CREATE SEQUENCE [dbo].[PIMS_LEASE_TERM_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_PAYMENT_FORECAST_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_PAYMENT_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_PAYMENT_PERIOD_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_TERM_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_TENANT_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_PAYMENT_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_PAYMENT_PERIOD_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_INSURANCE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_SECURITY_DEPOSIT_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_TAX_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_IMPROVEMENT_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_SECURITY_DEPOSIT_RETURN_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_TAX_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_SECURITY_DEPOSIT_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_SECURITY_DEPOSIT_RETURN_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_INSURANCE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_TENANT_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_IMPROVEMENT_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_TASK_TEMPLATE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACTIVITY_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_USER_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACTIVITY_MODEL_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_USER_ORGANIZATION_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ADDRESS_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_USER_ROLE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_CLAIM_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_WORKFLOW_MODEL_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_CONTACT_METHOD_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ORGANIZATION_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PERSON_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PERSON_ORGANIZATION_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_NOTE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_PROPERTY_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_WORKFLOW_MODEL_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_ACTIVITY_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_EVALUATION_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_ORGANIZATION_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_SERVICE_FILE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ROLE_CLAIM_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ROLE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_TASK_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACCESS_REQUEST_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_PAYMENT_FORECAST_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_ACTIVITY_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_ACTIVITY_PERIOD_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_LEASE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_L_FILE_NO_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_LEASE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_LEASE_H_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACTIVITY_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_WORKFLOW_MODEL_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_TASK_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACTIVITY_MODEL_TASK_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_TASK_TEMPLATE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACTIVITY_SERVICE_FILE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACTIVITY_TASK_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_USER_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_PROPERTY_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_WORKFLOW_MODEL_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_ACTIVITY_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_USER_TASK_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ORGANIZATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PERSON_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PERSON_ORGANIZATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACCESS_REQUEST_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_NOTE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ACTIVITY_MODEL_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ADDRESS_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_USER_ORGANIZATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ROLE_CLAIM_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ROLE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_USER_ROLE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_CLAIM_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_NUMBER_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_CONTACT_METHOD_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROJECT_ORGANIZATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_ORGANIZATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_STRUCTURE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_ASSET_EVALUATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_EVALUATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_STRUCTURE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_BUILDING_CONSTRUCTION_TYPE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_BUILDING_OCCUPANT_TYPE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_BUILDING_PREDOMINATE_USE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_BUILDING_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_BUILDING_EVALUATION_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_BUILDING_FISCAL_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


CREATE SEQUENCE [dbo].[PIMS_PROPERTY_SERVICE_FILE_ID_SEQ]
  AS bigint 
  START WITH 1
  INCREMENT BY 1 
  MINVALUE  1
  MAXVALUE  2147483647 
  NO CYCLE
  CACHE 50
GO


/* ---------------------------------------------------------------------- */
/* Add tables                                                             */
/* ---------------------------------------------------------------------- */

/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACTIVITY_MODEL"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACTIVITY_MODEL] (
    [ACTIVITY_MODEL_ID] BIGINT CONSTRAINT [ACTMDL_ACTIVITY_MODEL_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ACTIVITY_MODEL_ID_SEQ] NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ACTMDL_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ACTMDL_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACTMDL_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACTMDL_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACTMDL_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ACTMDL_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACTMDL_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ACTMDL_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ACTMDL_PK] PRIMARY KEY CLUSTERED ([ACTIVITY_MODEL_ID])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_WORKFLOW_MODEL_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_WORKFLOW_MODEL_TYPE] (
    [WORKFLOW_MODEL_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [WFLMDT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [WFLMDT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [WFLMDT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [WFLMDT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [WFLMDT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [WFLMDT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [WFLMDT_PK] PRIMARY KEY CLUSTERED ([WORKFLOW_MODEL_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_TYPE"                                     */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_TYPE] (
    [PROPERTY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRPTYP_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPTYP_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTYP_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTYP_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTYP_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTYP_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPTYP_PK] PRIMARY KEY CLUSTERED ([PROPERTY_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_REGION"                                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_REGION] (
    [REGION_CODE] SMALLINT NOT NULL,
    [REGION_NAME] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [REGION_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [REGION_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [REGION_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [REGION_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [REGION_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [REGION_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [REGION_PK] PRIMARY KEY CLUSTERED ([REGION_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_COUNTRY"                                           */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_COUNTRY] (
    [COUNTRY_ID] SMALLINT NOT NULL,
    [COUNTRY_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [CNTRY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [CNTRY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [CNTRY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [CNTRY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [CNTRY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [CNTRY_PK] PRIMARY KEY CLUSTERED ([COUNTRY_ID])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ADDRESS_USAGE_TYPE"                                */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ADDRESS_USAGE_TYPE] (
    [ADDRESS_USAGE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ADUSGT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ADUSGT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ADUSGT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ADUSGT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ADUSGT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ADUSGT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ADUSGT_PK] PRIMARY KEY CLUSTERED ([ADDRESS_USAGE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_CLAIM"                                             */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_CLAIM] (
    [CLAIM_ID] BIGINT CONSTRAINT [CLMTYP_CLAIM_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_CLAIM_ID_SEQ] NOT NULL,
    [CLAIM_UID] UNIQUEIDENTIFIER NOT NULL,
    [KEYCLOAK_ROLE_ID] UNIQUEIDENTIFIER,
    [NAME] NVARCHAR(100) NOT NULL,
    [DESCRIPTION] NVARCHAR(500) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [CLMTYP_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [CLMTYP_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [CLMTYP_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [CLMTYP_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [CLMTYP_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [CLMTYP_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [CLMTYP_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [CLMTYP_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [CLMTYP_PK] PRIMARY KEY CLUSTERED ([CLAIM_ID])
)
GO


CREATE NONCLUSTERED INDEX [CLMTYP_CLAIM_UID_IDX] ON [dbo].[PIMS_CLAIM] ([CLAIM_UID] ASC)
GO


CREATE NONCLUSTERED INDEX [CLMTYP_KEYCLOAK_ROLE_ID_IDX] ON [dbo].[PIMS_CLAIM] ([KEYCLOAK_ROLE_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_TYPE"                                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_TYPE] (
    [PROJECT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRJTYP_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRJTYP_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRJTYP_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRJTYP_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRJTYP_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRJTYP_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRJTYP_PK] PRIMARY KEY CLUSTERED ([PROJECT_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_TASK_TEMPLATE_TYPE"                                */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_TASK_TEMPLATE_TYPE] (
    [TASK_TEMPLATE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [TSKTMT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [TSKTMT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTMT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TSKTMT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTMT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TSKTMT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [TSKTMT_PK] PRIMARY KEY CLUSTERED ([TASK_TEMPLATE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ORGANIZATION_TYPE"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ORGANIZATION_TYPE] (
    [ORGANIZATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ORGTYP_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ORGTYP_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ORGTYP_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ORGTYP_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ORGTYP_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ORGTYP_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ORGTYP_PK] PRIMARY KEY CLUSTERED ([ORGANIZATION_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACCESS_REQUEST_STATUS_TYPE"                        */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACCESS_REQUEST_STATUS_TYPE] (
    [ACCESS_REQUEST_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ARQSTT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ARQSTT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ARQSTT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ARQSTT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ARQSTT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ARQSTT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ARQSTT_PK] PRIMARY KEY CLUSTERED ([ACCESS_REQUEST_STATUS_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_STATUS_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_STATUS_TYPE] (
    [PROJECT_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [CODE_GROUP] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [TEXT] NVARCHAR(1000) NOT NULL,
    [IS_MILESTONE] BIT CONSTRAINT [PRJSTY_IS_MILESTONE_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [IS_TERMINAL] BIT CONSTRAINT [PRJSTY_IS_TERMINAL_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRJSTY_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRJSTY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRJSTY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRJSTY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRJSTY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRJSTY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRJSTY_PK] PRIMARY KEY CLUSTERED ([PROJECT_STATUS_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_SERVICE_FILE_TYPE"                        */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_SERVICE_FILE_TYPE] (
    [PROPERTY_SERVICE_FILE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRSVFT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRSVFT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRSVFT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRSVFT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRSVFT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRSVFT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRSVFT_PK] PRIMARY KEY CLUSTERED ([PROPERTY_SERVICE_FILE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_RISK_TYPE"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_RISK_TYPE] (
    [PROJECT_RISK_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRJRSK_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRJRSK_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRJRSK_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRJRSK_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRJRSK_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRJRSK_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRJRSK_PK] PRIMARY KEY CLUSTERED ([PROJECT_RISK_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_TIER_TYPE"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_TIER_TYPE] (
    [PROJECT_TIER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PROJTR_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PROJTR_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROJTR_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PROJTR_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROJTR_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PROJTR_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PROJTR_PK] PRIMARY KEY CLUSTERED ([PROJECT_TIER_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ROLE"                                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ROLE] (
    [ROLE_ID] BIGINT CONSTRAINT [ROLE_ROLE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ROLE_ID_SEQ] NOT NULL,
    [ROLE_UID] UNIQUEIDENTIFIER NOT NULL,
    [KEYCLOAK_GROUP_ID] UNIQUEIDENTIFIER,
    [NAME] NVARCHAR(100) NOT NULL,
    [DESCRIPTION] NVARCHAR(500),
    [IS_PUBLIC] BIT CONSTRAINT [ROLE_IS_PUBLIC_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ROLE_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [SORT_ORDER] INTEGER NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ROLE_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ROLE_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ROLE_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ROLE_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ROLE_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ROLE_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ROLE_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ROLE_PK] PRIMARY KEY CLUSTERED ([ROLE_ID])
)
GO


CREATE NONCLUSTERED INDEX [ROLE_ROLE_UID_IDX] ON [dbo].[PIMS_ROLE] ([ROLE_UID] ASC)
GO


CREATE NONCLUSTERED INDEX [ROLE_KEYCLOAK_GROUP_ID_IDX] ON [dbo].[PIMS_ROLE] ([KEYCLOAK_GROUP_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_CLASSIFICATION_TYPE"                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_CLASSIFICATION_TYPE] (
    [PROPERTY_CLASSIFICATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRPCLT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPCLT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPCLT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPCLT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPCLT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPCLT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPCLT_PK] PRIMARY KEY CLUSTERED ([PROPERTY_CLASSIFICATION_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_CONTACT_METHOD_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_CONTACT_METHOD_TYPE] (
    [CONTACT_METHOD_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [CNTMTT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [CNTMTT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [CNTMTT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [CNTMTT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [CNTMTT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [CNTMTT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [CNTMTT_PK] PRIMARY KEY CLUSTERED ([CONTACT_METHOD_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_TENURE_TYPE"                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_TENURE_TYPE] (
    [PROPERTY_TENURE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRPTNR_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPTNR_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTNR_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTNR_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTNR_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTNR_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPTNR_PK] PRIMARY KEY CLUSTERED ([PROPERTY_TENURE_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'A code table to store property tenure codes. Tenure is defined as : "The act, right, manner or term of holding something(as a landed property)" In this case, tenure is required on Properties to indicate MoTI''s legal tenure on the property. The land parcel still accurately describes the legal title of the land parcel but the individual properties each can have different tenures by MoTI.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_TENURE_TYPE', NULL, NULL
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_AREA_UNIT_TYPE"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_AREA_UNIT_TYPE] (
    [AREA_UNIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ARUNIT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ARUNIT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ARUNIT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ARUNIT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ARUNIT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ARUNIT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ARUNIT_PK] PRIMARY KEY CLUSTERED ([AREA_UNIT_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'The area unit used for measuring Properties.  The units must be in metric: square metres or hectares.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_AREA_UNIT_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'The area unit used for measuring Properties.  The units must be in metric: square metres or hectares.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_AREA_UNIT_TYPE', 'COLUMN', N'AREA_UNIT_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Translation of the code value into a description that can be displayed to the user.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_AREA_UNIT_TYPE', 'COLUMN', N'DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Indicates if the code value is still active or is now disabled.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_AREA_UNIT_TYPE', 'COLUMN', N'IS_DISABLED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Order in which to display the code values, if required.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_AREA_UNIT_TYPE', 'COLUMN', N'DISPLAY_ORDER'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.__EFMigrationsHistory"                                  */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[__EFMigrationsHistory] (
    [MigrationId] NVARCHAR(150) NOT NULL,
    [ProductVersion] NVARCHAR(32),
    CONSTRAINT [MIGHIS_PK] PRIMARY KEY CLUSTERED ([MigrationId])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_DATA_SOURCE_TYPE"                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_DATA_SOURCE_TYPE] (
    [PROPERTY_DATA_SOURCE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PIDSRT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PIDSRT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PIDSRT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PIDSRT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PIDSRT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PIDSRT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PIDSRT_PK] PRIMARY KEY CLUSTERED ([PROPERTY_DATA_SOURCE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_STATUS_TYPE"                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_STATUS_TYPE] (
    [PROPERTY_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRPSTS_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPSTS_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPSTS_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPSTS_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPSTS_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPSTS_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPSTS_PK] PRIMARY KEY CLUSTERED ([PROPERTY_STATUS_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ORG_IDENTIFIER_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ORG_IDENTIFIER_TYPE] (
    [ORG_IDENTIFIER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ORGIDT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ORGIDT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ORGIDT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ORGIDT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ORGIDT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ORGIDT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ORGIDT_PK] PRIMARY KEY CLUSTERED ([ORG_IDENTIFIER_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMSX_TableDefinitions"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMSX_TableDefinitions] (
    [TABLE_NAME] NVARCHAR(255),
    [TABLE_ALIAS] NVARCHAR(255),
    [HIST_REQUIRED] NVARCHAR(1),
    [DESCRIPTION] NVARCHAR(max)
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_CATEGORY_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_CATEGORY_TYPE] (
    [LEASE_CATEGORY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LSCATT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSCATT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSCATT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSCATT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSCATT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSCATT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSCATT_PK] PRIMARY KEY CLUSTERED ([LEASE_CATEGORY_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PMT_FREQ_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PMT_FREQ_TYPE] (
    [LEASE_PMT_FREQ_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LSPMTF_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSPMTF_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSPMTF_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSPMTF_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSPMTF_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSPMTF_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSPMTF_PK] PRIMARY KEY CLUSTERED ([LEASE_PMT_FREQ_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PROGRAM_TYPE"                                */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PROGRAM_TYPE] (
    [LEASE_PROGRAM_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LSPRGT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSPRGT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSPRGT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSPRGT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSPRGT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSPRGT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSPRGT_PK] PRIMARY KEY CLUSTERED ([LEASE_PROGRAM_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LESSOR_TYPE"                                       */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LESSOR_TYPE] (
    [LESSOR_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LSSRTY_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSSRTY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSSRTY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSSRTY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSSRTY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSSRTY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSSRTY_PK] PRIMARY KEY CLUSTERED ([LESSOR_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAY_RVBL_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAY_RVBL_TYPE] (
    [LEASE_PAY_RVBL_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LSPRTY_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSPRTY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSPRTY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSPRTY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSPRTY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSPRTY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSPRTY_PK] PRIMARY KEY CLUSTERED ([LEASE_PAY_RVBL_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_LICENSE_TYPE"                                */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_LICENSE_TYPE] (
    [LEASE_LICENSE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LELIST_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LELIST_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LELIST_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LELIST_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LELIST_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LELIST_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LELIST_PK] PRIMARY KEY CLUSTERED ([LEASE_LICENSE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_INSURANCE_PAYEE_TYPE"                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_INSURANCE_PAYEE_TYPE] (
    [INSURANCE_PAYEE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [INSPAY_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [INSPAY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [INSPAY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [INSPAY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [INSPAY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [INSPAY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [INSPAY_PK] PRIMARY KEY CLUSTERED ([INSURANCE_PAYEE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_INSURANCE_TYPE"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_INSURANCE_TYPE] (
    [INSURANCE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [INSPYT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [INSPYT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [INSPYT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [INSPYT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [INSPYT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [INSPYT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [INSPYT_PK] PRIMARY KEY CLUSTERED ([INSURANCE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_SECURITY_DEPOSIT_TYPE"                             */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_SECURITY_DEPOSIT_TYPE] (
    [SECURITY_DEPOSIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [SECDPT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [SECDPT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [SECDPT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [SECDPT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [SECDPT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [SECDPT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [SECDPT_PK] PRIMARY KEY CLUSTERED ([SECURITY_DEPOSIT_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_SEC_DEP_HOLDER_TYPE"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_SEC_DEP_HOLDER_TYPE] (
    [SEC_DEP_HOLDER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [SCHLDT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [SCHLDT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [SCHLDT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [SCHLDT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [SCHLDT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [SCHLDT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [SCHLDT_PK] PRIMARY KEY CLUSTERED ([SEC_DEP_HOLDER_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PURPOSE_TYPE"                                */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PURPOSE_TYPE] (
    [LEASE_PURPOSE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LPRPTY_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LPRPTY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LPRPTY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LPRPTY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LPRPTY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LPRPTY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LPRPTY_PK] PRIMARY KEY CLUSTERED ([LEASE_PURPOSE_TYPE_CODE])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_TAX_REMIT_TYPE"                           */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_TAX_REMIT_TYPE] (
    [PROPERTY_TAX_REMIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PTRMTT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PTRMTT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PTRMTT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PTRMTT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PTRMTT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PTRMTT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PTRMTT_PK] PRIMARY KEY CLUSTERED ([PROPERTY_TAX_REMIT_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of property tax remittance types', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_TAX_REMIT_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code value of property tax remittance types', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_TAX_REMIT_TYPE', 'COLUMN', N'PROPERTY_TAX_REMIT_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code description of property tax remittance types', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_TAX_REMIT_TYPE', 'COLUMN', N'DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is this code value disabled?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_TAX_REMIT_TYPE', 'COLUMN', N'IS_DISABLED'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_SURPLUS_DECLARATION_TYPE"                          */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_SURPLUS_DECLARATION_TYPE] (
    [SURPLUS_DECLARATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [SPDCLT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [SPDCLT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [SPDCLT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [SPDCLT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [SPDCLT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [SPDCLT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [SPDCLT_PK] PRIMARY KEY CLUSTERED ([SURPLUS_DECLARATION_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of the surplus property type.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SURPLUS_DECLARATION_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code value of the surplus property type', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SURPLUS_DECLARATION_TYPE', 'COLUMN', N'SURPLUS_DECLARATION_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code description of the surplus property type', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SURPLUS_DECLARATION_TYPE', 'COLUMN', N'DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Indicates that the code value is disabled', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SURPLUS_DECLARATION_TYPE', 'COLUMN', N'IS_DISABLED'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_IMPROVEMENT_TYPE"                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_IMPROVEMENT_TYPE] (
    [PROPERTY_IMPROVEMENT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PIMPRT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PIMPRT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PIMPRT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PIMPRT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PIMPRT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PIMPRT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PIMPRT_PK] PRIMARY KEY CLUSTERED ([PROPERTY_IMPROVEMENT_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of the types of improvements made to a property during the lease.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code value of the types of improvements made to a property during the lease.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT_TYPE', 'COLUMN', N'PROPERTY_IMPROVEMENT_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code description of the types of improvements made to a property during the lease.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT_TYPE', 'COLUMN', N'DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Indicates if the code is disabled', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT_TYPE', 'COLUMN', N'IS_DISABLED'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACCESS_REQUEST_HIST"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACCESS_REQUEST_HIST] (
    [_ACCESS_REQUEST_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ACCE___ACCE__77168B72] DEFAULT NEXT VALUE FOR [PIMS_ACCESS_REQUEST_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ACCE__EFFEC__780AAFAB] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ACCESS_REQUEST_ID] BIGINT NOT NULL,
    [USER_ID] BIGINT NOT NULL,
    [ROLE_ID] BIGINT,
    [ACCESS_REQUEST_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ACRQST_H_PK] PRIMARY KEY CLUSTERED ([_ACCESS_REQUEST_HIST_ID]),
    CONSTRAINT [PIMS_ACRQST_H_UK] UNIQUE ([_ACCESS_REQUEST_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACCESS_REQUEST_ORGANIZATION_HIST"                  */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION_HIST] (
    [_ACCESS_REQUEST_ORGANIZATION_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ACCE___ACCE__7CCF64C8] DEFAULT NEXT VALUE FOR [PIMS_ACCESS_REQUEST_ORGANIZATION_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ACCE__EFFEC__7DC38901] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ACCESS_REQUEST_ORGANIZATION_ID] BIGINT NOT NULL,
    [ORGANIZATION_ID] BIGINT,
    [ACCESS_REQUEST_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ACRQOR_H_PK] PRIMARY KEY CLUSTERED ([_ACCESS_REQUEST_ORGANIZATION_HIST_ID]),
    CONSTRAINT [PIMS_ACRQOR_H_UK] UNIQUE ([_ACCESS_REQUEST_ORGANIZATION_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACTIVITY_HIST"                                     */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACTIVITY_HIST] (
    [_ACTIVITY_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ACTI___ACTI__02883E1E] DEFAULT NEXT VALUE FOR [PIMS_ACTIVITY_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ACTI__EFFEC__037C6257] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ACTIVITY_ID] BIGINT NOT NULL,
    [PROJECT_ID] BIGINT,
    [WORKFLOW_ID] BIGINT,
    [ACTIVITY_MODEL_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ACTVTY_H_PK] PRIMARY KEY CLUSTERED ([_ACTIVITY_HIST_ID]),
    CONSTRAINT [PIMS_ACTVTY_H_UK] UNIQUE ([_ACTIVITY_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACTIVITY_MODEL_HIST"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACTIVITY_MODEL_HIST] (
    [_ACTIVITY_MODEL_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ACTI___ACTI__08411774] DEFAULT NEXT VALUE FOR [PIMS_ACTIVITY_MODEL_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ACTI__EFFEC__09353BAD] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ACTIVITY_MODEL_ID] BIGINT NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ACTMDL_H_PK] PRIMARY KEY CLUSTERED ([_ACTIVITY_MODEL_HIST_ID]),
    CONSTRAINT [PIMS_ACTMDL_H_UK] UNIQUE ([_ACTIVITY_MODEL_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ADDRESS_HIST"                                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ADDRESS_HIST] (
    [_ADDRESS_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ADDR___ADDR__0DF9F0CA] DEFAULT NEXT VALUE FOR [PIMS_ADDRESS_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ADDR__EFFEC__0EEE1503] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ADDRESS_ID] BIGINT NOT NULL,
    [ADDRESS_USAGE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [REGION_CODE] SMALLINT,
    [DISTRICT_CODE] SMALLINT,
    [PROVINCE_STATE_ID] SMALLINT NOT NULL,
    [COUNTRY_ID] SMALLINT,
    [STREET_ADDRESS_1] NVARCHAR(200),
    [STREET_ADDRESS_2] NVARCHAR(200),
    [STREET_ADDRESS_3] NVARCHAR(200),
    [MUNICIPALITY_NAME] NVARCHAR(200),
    [POSTAL_CODE] NVARCHAR(20),
    [LATITUDE] NUMERIC(18),
    [LONGITUDE] NUMERIC(18),
    [COMMENT] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ADDRSS_H_PK] PRIMARY KEY CLUSTERED ([_ADDRESS_HIST_ID]),
    CONSTRAINT [PIMS_ADDRSS_H_UK] UNIQUE ([_ADDRESS_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_CLAIM_HIST"                                        */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_CLAIM_HIST] (
    [_CLAIM_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_CLAI___CLAI__13B2CA20] DEFAULT NEXT VALUE FOR [PIMS_CLAIM_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_CLAI__EFFEC__14A6EE59] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [CLAIM_ID] BIGINT NOT NULL,
    [CLAIM_UID] UNIQUEIDENTIFIER NOT NULL,
    [KEYCLOAK_ROLE_ID] UNIQUEIDENTIFIER,
    [NAME] NVARCHAR(100) NOT NULL,
    [DESCRIPTION] NVARCHAR(500) NOT NULL,
    [IS_DISABLED] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_CLMTYP_H_PK] PRIMARY KEY CLUSTERED ([_CLAIM_HIST_ID]),
    CONSTRAINT [PIMS_CLMTYP_H_UK] UNIQUE ([_CLAIM_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_CONTACT_METHOD_HIST"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_CONTACT_METHOD_HIST] (
    [_CONTACT_METHOD_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_CONT___CONT__196BA376] DEFAULT NEXT VALUE FOR [PIMS_CONTACT_METHOD_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_CONT__EFFEC__1A5FC7AF] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [CONTACT_METHOD_ID] BIGINT NOT NULL,
    [CONTACT_METHOD_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PERSON_ID] BIGINT,
    [ORGANIZATION_ID] BIGINT,
    [CONTACT_METHOD_VALUE] NVARCHAR(200) NOT NULL,
    [IS_PREFERRED_METHOD] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_CNTMTH_H_PK] PRIMARY KEY CLUSTERED ([_CONTACT_METHOD_HIST_ID]),
    CONSTRAINT [PIMS_CNTMTH_H_UK] UNIQUE ([_CONTACT_METHOD_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_INSURANCE_HIST"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_INSURANCE_HIST] (
    [_INSURANCE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_INSU___INSU__1F247CCC] DEFAULT NEXT VALUE FOR [PIMS_INSURANCE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_INSU__EFFEC__2018A105] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [INSURANCE_ID] BIGINT NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [INSURANCE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [INSURER_ORG_ID] BIGINT NOT NULL,
    [INSURER_CONTACT_ID] BIGINT NOT NULL,
    [MOTI_RISK_MGMT_CONTACT_ID] BIGINT NOT NULL,
    [BCTFA_RISK_MGMT_CONTACT_ID] BIGINT NOT NULL,
    [INSURANCE_PAYEE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [OTHER_INSURANCE_TYPE] NVARCHAR(200),
    [COVERAGE_DESCRIPTION] NVARCHAR(2000),
    [COVERAGE_LIMIT] MONEY NOT NULL,
    [INSURED_VALUE] MONEY NOT NULL,
    [START_DATE] DATE NOT NULL,
    [EXPIRY_DATE] DATE NOT NULL,
    [RISK ASSESSMENT_COMPLETED_DATE] DATETIME,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_INSRNC_H_PK] PRIMARY KEY CLUSTERED ([_INSURANCE_HIST_ID]),
    CONSTRAINT [PIMS_INSRNC_H_UK] UNIQUE ([_INSURANCE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_HIST"                                        */
/* ---------------------------------------------------------------------- */



CREATE TABLE [dbo].[PIMS_LEASE_HIST] (
    [_LEASE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_LEAS___LEAS__24DD5622] DEFAULT NEXT VALUE FOR [PIMS_LEASE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_LEAS__EFFEC__25D17A5B] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [LEASE_ID] BIGINT NOT NULL,
    [MOTI_NAME_ID] BIGINT NOT NULL,
    [LEASE_PAY_RVBL_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_LICENSE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_CATEGORY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PURPOSE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PROGRAM_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_INITIATOR_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_RESPONSIBILITY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PMT_FREQ_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PURPOSE_OTHER_DESC] NVARCHAR(200),
    [L_FILE_NO] NVARCHAR(50),
    [TFA_FILE_NO] INTEGER,
    [PS_FILE_NO] NVARCHAR(50),
    [LEASE_DESCRIPTION] NVARCHAR(4000),
    [LEASE_NOTES] NVARCHAR(4000),
    [ORIG_START_DATE] DATETIME NOT NULL,
    [ORIG_EXPIRY_DATE] DATETIME,
    [IS_ORIG_EXPIRY_REQUIRED] BIT NOT NULL,
    [INCLUDED_RENEWALS] SMALLINT,
    [RENEWAL_COUNT] SMALLINT,
    [RENEWAL_TERM_MONTHS] SMALLINT CONSTRAINT [_RENEWAL_TERM_MONTHS_DEF] DEFAULT 0 NOT NULL,
    [LEASE_AMOUNT] MONEY,
    [RESPONSIBILITY_EFFECTIVE_DATE] DATETIME,
    [INSPECTION_DATE] DATETIME,
    [INSPECTION_NOTES] NVARCHAR(4000),
    [IS_SUBJECT_TO_RTA] BIT,
    [IS_COMM_BLDG] BIT,
    [IS_OTHER_IMPROVEMENT] BIT,
    [IS_EXPIRED] BIT NOT NULL,
    [HAS_PHYSICAL_FILE] BIT NOT NULL,
    [HAS_DIGITAL_FILE] BIT NOT NULL,
    [HAS_PHYSICIAL_LICENSE] BIT NOT NULL,
    [HAS_DIGITAL_LICENSE] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_LEASE_H_PK] PRIMARY KEY CLUSTERED ([_LEASE_HIST_ID]),
    CONSTRAINT [PIMS_LEASE_H_UK] UNIQUE ([_LEASE_HIST_ID], [END_DATE_HIST])
)
GO




EXECUTE sp_addextendedproperty N'MS_Description', N'Number of months included in lease renewal', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_HIST', 'COLUMN', N'RENEWAL_TERM_MONTHS'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_TENANT_HIST"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_TENANT_HIST] (
    [_LEASE_TENANT_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_LEAS___LEAS__3BC0BB7A] DEFAULT NEXT VALUE FOR [PIMS_LEASE_TENANT_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_LEAS__EFFEC__3CB4DFB3] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [LEASE_TENANT_ID] BIGINT NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [PERSON_ID] BIGINT,
    [ORGANIZATION_ID] BIGINT,
    [LESSOR_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [NOTE] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_TENANT_H_PK] PRIMARY KEY CLUSTERED ([_LEASE_TENANT_HIST_ID]),
    CONSTRAINT [PIMS_TENANT_H_UK] UNIQUE ([_LEASE_TENANT_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ORGANIZATION_HIST"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ORGANIZATION_HIST] (
    [_ORGANIZATION_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ORGA___ORGA__47326E26] DEFAULT NEXT VALUE FOR [PIMS_ORGANIZATION_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ORGA__EFFEC__4826925F] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ORGANIZATION_ID] BIGINT NOT NULL,
    [PRNT_ORGANIZATION_ID] BIGINT,
    [ADDRESS_ID] BIGINT NOT NULL,
    [REGION_CODE] SMALLINT,
    [DISTRICT_CODE] SMALLINT,
    [ORGANIZATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [ORG_IDENTIFIER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [ORGANIZATION_IDENTIFIER] NVARCHAR(100),
    [ORGANIZATION_NAME] NVARCHAR(200) NOT NULL,
    [ORGANIZATION_ALIAS] NVARCHAR(200),
    [WEBSITE] NVARCHAR(200),
    [IS_DISABLED] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ORG_H_PK] PRIMARY KEY CLUSTERED ([_ORGANIZATION_HIST_ID]),
    CONSTRAINT [PIMS_ORG_H_UK] UNIQUE ([_ORGANIZATION_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PERSON_HIST"                                       */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PERSON_HIST] (
    [_PERSON_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PERS___PERS__4CEB477C] DEFAULT NEXT VALUE FOR [PIMS_PERSON_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PERS__EFFEC__4DDF6BB5] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PERSON_ID] BIGINT NOT NULL,
    [ADDRESS_ID] BIGINT,
    [SURNAME] NVARCHAR(50) NOT NULL,
    [FIRST_NAME] NVARCHAR(50) NOT NULL,
    [MIDDLE_NAMES] NVARCHAR(200),
    [NAME_SUFFIX] NVARCHAR(50),
    [PREFERRED_NAME] NVARCHAR(200),
    [BIRTH_DATE] DATE,
    [IS_DISABLED] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PERSON_H_PK] PRIMARY KEY CLUSTERED ([_PERSON_HIST_ID]),
    CONSTRAINT [PIMS_PERSON_H_UK] UNIQUE ([_PERSON_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PERSON_ORGANIZATION_HIST"                          */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PERSON_ORGANIZATION_HIST] (
    [_PERSON_ORGANIZATION_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PERS___PERS__52A420D2] DEFAULT NEXT VALUE FOR [PIMS_PERSON_ORGANIZATION_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PERS__EFFEC__5398450B] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PERSON_ORGANIZATION_ID] BIGINT NOT NULL,
    [PERSON_ID] BIGINT,
    [ORGANIZATION_ID] BIGINT,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PERORG_H_PK] PRIMARY KEY CLUSTERED ([_PERSON_ORGANIZATION_HIST_ID]),
    CONSTRAINT [PIMS_PERORG_H_UK] UNIQUE ([_PERSON_ORGANIZATION_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_HIST"                                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_HIST] (
    [_PROJECT_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROJ___PROJ__585CFA28] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROJ__EFFEC__59511E61] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROJECT_ID] BIGINT NOT NULL,
    [PROJECT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROJECT_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROJECT_RISK_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROJECT_TIER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PROJCT_H_PK] PRIMARY KEY CLUSTERED ([_PROJECT_HIST_ID]),
    CONSTRAINT [PIMS_PROJCT_H_UK] UNIQUE ([_PROJECT_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_NOTE_HIST"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_NOTE_HIST] (
    [_PROJECT_NOTE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROJ___PROJ__5E15D37E] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_NOTE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROJ__EFFEC__5F09F7B7] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROJECT_NOTE_ID] BIGINT NOT NULL,
    [PROJECT_ID] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PROJNT_H_PK] PRIMARY KEY CLUSTERED ([_PROJECT_NOTE_HIST_ID]),
    CONSTRAINT [PIMS_PROJNT_H_UK] UNIQUE ([_PROJECT_NOTE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_PROPERTY_HIST"                             */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_PROPERTY_HIST] (
    [_PROJECT_PROPERTY_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROJ___PROJ__63CEACD4] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_PROPERTY_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROJ__EFFEC__64C2D10D] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROJECT_PROPERTY_ID] BIGINT NOT NULL,
    [PROJECT_ID] BIGINT NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRJPRP_H_PK] PRIMARY KEY CLUSTERED ([_PROJECT_PROPERTY_HIST_ID]),
    CONSTRAINT [PIMS_PRJPRP_H_UK] UNIQUE ([_PROJECT_PROPERTY_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_WORKFLOW_MODEL_HIST"                       */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_WORKFLOW_MODEL_HIST] (
    [_PROJECT_WORKFLOW_MODEL_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROJ___PROJ__6987862A] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_WORKFLOW_MODEL_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROJ__EFFEC__6A7BAA63] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROJECT_WORKFLOW_MODEL_ID] BIGINT NOT NULL,
    [PROJECT_ID] BIGINT NOT NULL,
    [WORKFLOW_MODEL_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRWKMD_H_PK] PRIMARY KEY CLUSTERED ([_PROJECT_WORKFLOW_MODEL_HIST_ID]),
    CONSTRAINT [PIMS_PRWKMD_H_UK] UNIQUE ([_PROJECT_WORKFLOW_MODEL_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_ACTIVITY_HIST"                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_ACTIVITY_HIST] (
    [_PROPERTY_ACTIVITY_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__6F405F80] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_ACTIVITY_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__703483B9] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_ACTIVITY_ID] BIGINT NOT NULL,
    [ACTIVITY_ID] BIGINT,
    [PROPERTY_ID] BIGINT,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRPACT_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_ACTIVITY_HIST_ID]),
    CONSTRAINT [PIMS_PRPACT_H_UK] UNIQUE ([_PROPERTY_ACTIVITY_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_EVALUATION_HIST"                          */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_EVALUATION_HIST] (
    [_PROPERTY_EVALUATION_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__74F938D6] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_EVALUATION_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__75ED5D0F] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_EVALUATION_ID] BIGINT NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [EVALUATION_DATE] DATE NOT NULL,
    [KEY] INTEGER NOT NULL,
    [VALUE] MONEY NOT NULL,
    [NOTE] NVARCHAR(1000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRPEVL_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_EVALUATION_HIST_ID]),
    CONSTRAINT [PIMS_PRPEVL_H_UK] UNIQUE ([_PROPERTY_EVALUATION_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_HIST"                                     */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_HIST] (
    [_PROPERTY_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__7AB2122C] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__7BA63665] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_ID] BIGINT NOT NULL,
    [PROPERTY_MANAGER_ID] BIGINT,
    [PROP_MGMT_ORG_ID] BIGINT,
    [PROPERTY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_CLASSIFICATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [ADDRESS_ID] BIGINT NOT NULL,
    [REGION_CODE] SMALLINT NOT NULL,
    [DISTRICT_CODE] SMALLINT NOT NULL,
    [PROPERTY_TENURE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_AREA_UNIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [SURPLUS_DECLARATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_DATA_SOURCE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_DATA_SOURCE_EFFECTIVE_DATE] DATE NOT NULL,
    [NAME] NVARCHAR(250),
    [DESCRIPTION] NVARCHAR(2000),
    [PID] INTEGER NOT NULL,
    [PIN] INTEGER,
    [LAND_AREA] REAL NOT NULL,
    [ENCUMBRANCE_REASON] NVARCHAR(500),
    [SURPLUS_DECLARATION_COMMENT] NVARCHAR(2000),
    [SURPLUS_DECLARATION_DATE] DATETIME,
    [IS_OWNED] BIT NOT NULL,
    [IS_PROPERTY_OF_INTEREST] BIT NOT NULL,
    [IS_VISIBLE_TO_OTHER_AGENCIES] BIT NOT NULL,
    [IS_SENSITIVE] BIT NOT NULL,
    [ZONING] NVARCHAR(50),
    [ZONING_POTENTIAL] NVARCHAR(50),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRPRTY_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_HIST_ID]),
    CONSTRAINT [PIMS_PRPRTY_H_UK] UNIQUE ([_PROPERTY_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_IMPROVEMENT_HIST"                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_IMPROVEMENT_HIST] (
    [_PROPERTY_IMPROVEMENT_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__006AEB82] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_IMPROVEMENT_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__015F0FBB] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_IMPROVEMENT_ID] BIGINT NOT NULL,
    [PROPERTY_LEASE_ID] BIGINT NOT NULL,
    [PROPERTY_IMPROVEMENT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [IMPROVEMENT_DESCRIPTION] NVARCHAR(2000) NOT NULL,
    [STRUCTURE_SIZE] NVARCHAR(2000),
    [UNIT] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PIMPRV_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_IMPROVEMENT_HIST_ID]),
    CONSTRAINT [PIMS_PIMPRV_H_UK] UNIQUE ([_PROPERTY_IMPROVEMENT_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_LEASE_HIST"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_LEASE_HIST] (
    [_PROPERTY_LEASE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__0623C4D8] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_LEASE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__0717E911] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_LEASE_ID] BIGINT NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PROPLS_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_LEASE_HIST_ID]),
    CONSTRAINT [PIMS_PROPLS_H_UK] UNIQUE ([_PROPERTY_LEASE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_ORGANIZATION_HIST"                        */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_ORGANIZATION_HIST] (
    [_PROPERTY_ORGANIZATION_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__0BDC9E2E] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_ORGANIZATION_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__0CD0C267] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_ORGANIZATION_ID] BIGINT NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [ORGANIZATION_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [IS_DISABLED] BIT,
    CONSTRAINT [PIMS_PRPORG_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_ORGANIZATION_HIST_ID]),
    CONSTRAINT [PIMS_PRPORG_H_UK] UNIQUE ([_PROPERTY_ORGANIZATION_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_PROPERTY_SERVICE_FILE_HIST"               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE_HIST] (
    [_PROPERTY_PROPERTY_SERVICE_FILE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__11957784] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_PROPERTY_SERVICE_FILE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__12899BBD] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_PROPERTY_SERVICE_FILE_ID] BIGINT NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [PROPERTY_SERVICE_FILE_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRPRSF_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_PROPERTY_SERVICE_FILE_HIST_ID]),
    CONSTRAINT [PIMS_PRPRSF_H_UK] UNIQUE ([_PROPERTY_PROPERTY_SERVICE_FILE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_SERVICE_FILE_HIST"                        */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_SERVICE_FILE_HIST] (
    [_PROPERTY_SERVICE_FILE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__174E50DA] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_SERVICE_FILE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__18427513] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_SERVICE_FILE_ID] BIGINT NOT NULL,
    [PROPERTY_SERVICE_FILE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRPSVC_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_SERVICE_FILE_HIST_ID]),
    CONSTRAINT [PIMS_PRPSVC_H_UK] UNIQUE ([_PROPERTY_SERVICE_FILE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_TAX_HIST"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_TAX_HIST] (
    [_PROPERTY_TAX_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_PROP___PROP__1D072A30] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_TAX_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_PROP__EFFEC__1DFB4E69] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [PROPERTY_TAX_ID] BIGINT NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [PROPERTY_TAX_REMIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [TAX_FOLIO_NO] NVARCHAR(50) NOT NULL,
    [PAYMENT_AMOUNT] MONEY NOT NULL,
    [LAST_PAYMENT_DATE] DATETIME,
    [PAYMENT_NOTES] MONEY,
    [BCTFA_NOTIFICATION_DATE] DATETIME,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_PRPTAX_H_PK] PRIMARY KEY CLUSTERED ([_PROPERTY_TAX_HIST_ID]),
    CONSTRAINT [PIMS_PRPTAX_H_UK] UNIQUE ([_PROPERTY_TAX_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ROLE_CLAIM_HIST"                                   */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ROLE_CLAIM_HIST] (
    [_ROLE_CLAIM_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ROLE___ROLE__22C00386] DEFAULT NEXT VALUE FOR [PIMS_ROLE_CLAIM_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ROLE__EFFEC__23B427BF] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ROLE_CLAIM_ID] BIGINT NOT NULL,
    [ROLE_ID] BIGINT NOT NULL,
    [CLAIM_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ROLCLM_H_PK] PRIMARY KEY CLUSTERED ([_ROLE_CLAIM_HIST_ID]),
    CONSTRAINT [PIMS_ROLCLM_H_UK] UNIQUE ([_ROLE_CLAIM_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ROLE_HIST"                                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ROLE_HIST] (
    [_ROLE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_ROLE___ROLE__2878DCDC] DEFAULT NEXT VALUE FOR [PIMS_ROLE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_ROLE__EFFEC__296D0115] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [ROLE_ID] BIGINT NOT NULL,
    [ROLE_UID] UNIQUEIDENTIFIER NOT NULL,
    [KEYCLOAK_GROUP_ID] UNIQUEIDENTIFIER,
    [NAME] NVARCHAR(100) NOT NULL,
    [DESCRIPTION] NVARCHAR(500),
    [IS_PUBLIC] BIT NOT NULL,
    [IS_DISABLED] BIT NOT NULL,
    [SORT_ORDER] INTEGER NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_ROLE_H_PK] PRIMARY KEY CLUSTERED ([_ROLE_HIST_ID]),
    CONSTRAINT [PIMS_ROLE_H_UK] UNIQUE ([_ROLE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_SECURITY_DEPOSIT_HIST"                             */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_SECURITY_DEPOSIT_HIST] (
    [_SECURITY_DEPOSIT_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_SECU___SECU__2E31B632] DEFAULT NEXT VALUE FOR [PIMS_SECURITY_DEPOSIT_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_SECU__EFFEC__2F25DA6B] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [SECURITY_DEPOSIT_ID] BIGINT NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [SEC_DEP_HOLDER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [SECURITY_DEPOSIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(2000) NOT NULL,
    [AMOUNT_PAID] MONEY NOT NULL,
    [TOTAL_AMOUNT] MONEY NOT NULL,
    [DEPOSIT_DATE] DATE NOT NULL,
    [ANNUAL_INTEREST_RATE] NUMERIC(18),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_SECDEP_H_PK] PRIMARY KEY CLUSTERED ([_SECURITY_DEPOSIT_HIST_ID]),
    CONSTRAINT [PIMS_SECDEP_H_UK] UNIQUE ([_SECURITY_DEPOSIT_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_SECURITY_DEPOSIT_RETURN_HIST"                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_SECURITY_DEPOSIT_RETURN_HIST] (
    [_SECURITY_DEPOSIT_RETURN_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_SECU___SECU__33EA8F88] DEFAULT NEXT VALUE FOR [PIMS_SECURITY_DEPOSIT_RETURN_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_SECU__EFFEC__34DEB3C1] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [SECURITY_DEPOSIT_RETURN_ID] BIGINT NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [SECURITY_DEPOSIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [TERMINATION_DATE] DATETIME NOT NULL,
    [DEPOSIT_TOTAL] MONEY NOT NULL,
    [CLAIMS_AGAINST] MONEY,
    [RETURN_AMOUNT] MONEY NOT NULL,
    [RETURN_DATE] DATETIME NOT NULL,
    [CHEQUE_NUMBER] NVARCHAR(50) NOT NULL,
    [PAYEE_NAME] NVARCHAR(100) NOT NULL,
    [PAYEE_ADDRESS] NVARCHAR(500) NOT NULL,
    [TERMINATION_NOTE] NVARCHAR(4000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_SDRTRN_H_PK] PRIMARY KEY CLUSTERED ([_SECURITY_DEPOSIT_RETURN_HIST_ID]),
    CONSTRAINT [PIMS_SDRTRN_H_UK] UNIQUE ([_SECURITY_DEPOSIT_RETURN_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_TASK_HIST"                                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_TASK_HIST] (
    [_TASK_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_TASK___TASK__39A368DE] DEFAULT NEXT VALUE FOR [PIMS_TASK_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_TASK__EFFEC__3A978D17] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [TASK_ID] BIGINT NOT NULL,
    [TASK_TEMPLATE_ID] BIGINT NOT NULL,
    [ACTIVITY_ID] BIGINT,
    [USER_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_TASK_H_PK] PRIMARY KEY CLUSTERED ([_TASK_HIST_ID]),
    CONSTRAINT [PIMS_TASK_H_UK] UNIQUE ([_TASK_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_HIST"                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_HIST] (
    [_TASK_TEMPLATE_ACTIVITY_MODEL_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_TASK___TASK__3F5C4234] DEFAULT NEXT VALUE FOR [PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_TASK__EFFEC__4050666D] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [TASK_TEMPLATE_ACTIVITY_MODEL_ID] BIGINT NOT NULL,
    [TASK_TEMPLATE_ID] BIGINT NOT NULL,
    [ACTIVITY_MODEL_ID] BIGINT NOT NULL,
    [IS_MANDATORY] BIT NOT NULL,
    [IMPLEMENTATION_ORDER] SMALLINT NOT NULL,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_TSKTAM_H_PK] PRIMARY KEY CLUSTERED ([_TASK_TEMPLATE_ACTIVITY_MODEL_HIST_ID]),
    CONSTRAINT [PIMS_TSKTAM_H_UK] UNIQUE ([_TASK_TEMPLATE_ACTIVITY_MODEL_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_TASK_TEMPLATE_HIST"                                */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_TASK_TEMPLATE_HIST] (
    [_TASK_TEMPLATE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_TASK___TASK__45151B8A] DEFAULT NEXT VALUE FOR [PIMS_TASK_TEMPLATE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_TASK__EFFEC__46093FC3] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [TASK_TEMPLATE_ID] BIGINT NOT NULL,
    [TASK_TEMPLATE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [IS_DISABLED] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_TSKTMP_H_PK] PRIMARY KEY CLUSTERED ([_TASK_TEMPLATE_HIST_ID]),
    CONSTRAINT [PIMS_TSKTMP_H_UK] UNIQUE ([_TASK_TEMPLATE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_USER_HIST"                                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_USER_HIST] (
    [_USER_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_USER___USER__4ACDF4E0] DEFAULT NEXT VALUE FOR [PIMS_USER_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_USER__EFFEC__4BC21919] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [USER_ID] BIGINT NOT NULL,
    [PERSON_ID] BIGINT NOT NULL,
    [BUSINESS_IDENTIFIER_VALUE] NVARCHAR(30) NOT NULL,
    [GUID_IDENTIFIER_VALUE] UNIQUEIDENTIFIER,
    [POSITION] NVARCHAR(100),
    [NOTE] NVARCHAR(1000),
    [LAST_LOGIN] DATETIME,
    [APPROVED_BY_ID] NVARCHAR(30),
    [ISSUE_DATE] DATETIME NOT NULL,
    [EXPIRY_DATE] DATETIME,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_USER_H_PK] PRIMARY KEY CLUSTERED ([_USER_HIST_ID]),
    CONSTRAINT [PIMS_USER_H_UK] UNIQUE ([_USER_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_USER_ORGANIZATION_HIST"                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_USER_ORGANIZATION_HIST] (
    [_USER_ORGANIZATION_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_USER___USER__5086CE36] DEFAULT NEXT VALUE FOR [PIMS_USER_ORGANIZATION_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_USER__EFFEC__517AF26F] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [USER_ORGANIZATION_ID] BIGINT NOT NULL,
    [ORGANIZATION_ID] BIGINT NOT NULL,
    [USER_ID] BIGINT NOT NULL,
    [ROLE_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_USRORG_H_PK] PRIMARY KEY CLUSTERED ([_USER_ORGANIZATION_HIST_ID]),
    CONSTRAINT [PIMS_USRORG_H_UK] UNIQUE ([_USER_ORGANIZATION_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_USER_ROLE_HIST"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_USER_ROLE_HIST] (
    [_USER_ROLE_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_USER___USER__563FA78C] DEFAULT NEXT VALUE FOR [PIMS_USER_ROLE_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_USER__EFFEC__5733CBC5] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [USER_ROLE_ID] BIGINT NOT NULL,
    [USER_ID] BIGINT NOT NULL,
    [ROLE_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_USERRL_H_PK] PRIMARY KEY CLUSTERED ([_USER_ROLE_HIST_ID]),
    CONSTRAINT [PIMS_USERRL_H_UK] UNIQUE ([_USER_ROLE_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_WORKFLOW_MODEL_HIST"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_WORKFLOW_MODEL_HIST] (
    [_WORKFLOW_MODEL_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_WORK___WORK__5BF880E2] DEFAULT NEXT VALUE FOR [PIMS_WORKFLOW_MODEL_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_WORK__EFFEC__5CECA51B] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [WORKFLOW_MODEL_ID] BIGINT NOT NULL,
    [WORKFLOW_MODEL_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [IS_DISABLED] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_WFLMDL_H_PK] PRIMARY KEY CLUSTERED ([_WORKFLOW_MODEL_HIST_ID]),
    CONSTRAINT [PIMS_WFLMDL_H_UK] UNIQUE ([_WORKFLOW_MODEL_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "etl.ETL_INTEREST_HOLDER_PERSON_ORG_LOG"                     */
/* ---------------------------------------------------------------------- */

CREATE TABLE [etl].[ETL_INTEREST_HOLDER_PERSON_ORG_LOG] (
    [SURNAME] NVARCHAR(50),
    [FIRST_NAME] NVARCHAR(50),
    [MIDDLE_NAME] NVARCHAR(200),
    [STREET_ADDRESS_1] NVARCHAR(200),
    [STREET_ADDRESS_2] NVARCHAR(200),
    [STREET_ADDRESS_3] NVARCHAR(200),
    [MUNICIPALITY_NAME] NVARCHAR(200),
    [PROVINCE] NVARCHAR(2),
    [COUNTRY] NVARCHAR(20),
    [ADDRESS_ID] BIGINT,
    [PROVINCE_STATE_ID] SMALLINT,
    [COUNTRY_ID] SMALLINT,
    [REGION_CODE] SMALLINT,
    [DISTRICT_CODE] SMALLINT,
    [ORGANIZATION_NAME] NVARCHAR(200),
    [ORGANIZATION_TYPE_CODE] NVARCHAR(20),
    [ORGANIZATION_IDENTIFIER_TYPE_CODE] NVARCHAR(20),
    [APP_CREATE_USERID] NVARCHAR(30),
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30),
    [APP_LAST_UPDATE_USERID] NVARCHAR(30),
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30)
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "etl.ETL_CONTACT_METHOD_LOG"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [etl].[ETL_CONTACT_METHOD_LOG] (
    [PERSON_ID] BIGINT,
    [SURNAME] NVARCHAR(50),
    [FIRST_NAME] NVARCHAR(50),
    [MIDDLE_NAME] NVARCHAR(200),
    [STREET_ADDRESS_1] NVARCHAR(200),
    [STREET_ADDRESS_2] NVARCHAR(200),
    [STREET_ADDRESS_3] NVARCHAR(200),
    [MUNICIPALITY_NAME] NVARCHAR(200),
    [CONTACT_METHOD_TYPE_CODE] NVARCHAR(20),
    [CONTACT_METHOD_VALUE] NVARCHAR(200),
    [ADDRESS_ID] BIGINT,
    [ORGANIZATION_ID] BIGINT,
    [ORGANIZATION_NAME] NVARCHAR(200),
    [LAST_UPDATE_DATETIME] DATETIME CONSTRAINT [CNTMTH_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate(),
    [LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [CNTMTH_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name()
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "pmbc.PMBC_PARCEL_POLYGON_FABRIC"                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [pmbc].[PMBC_PARCEL_POLYGON_FABRIC] (
    [PARCEL_FABRIC_POLY_ID] INTEGER NOT NULL,
    [GLOBAL_UID] NVARCHAR(254),
    [PARCEL_NAME] NVARCHAR(50),
    [PLAN_ID] INTEGER,
    [PLAN_NUMBER] NVARCHAR(128),
    [PIN] INTEGER,
    [PID] NVARCHAR(9),
    [PID_NUMBER] INTEGER,
    [SOURCE_PARCEL_ID] NVARCHAR(50),
    [PARCEL_STATUS] NVARCHAR(20),
    [PARCEL_CLASS] NVARCHAR(50),
    [OWNER_TYPE] NVARCHAR(50),
    [PARCEL_START_DATE] DATETIME,
    [SURVEY_DESIGNATION_1] NVARCHAR(30),
    [SURVEY_DESIGNATION_2] NVARCHAR(30),
    [SURVEY_DESIGNATION_3] NVARCHAR(30),
    [LEGAL_DESCRIPTION] NVARCHAR(2000),
    [MUNICIPALITY] NVARCHAR(254),
    [REGIONAL_DISTRICT] NVARCHAR(50),
    [IS_REMAINDER_IND] NVARCHAR(3),
    [GEOMETRY_SOURCE] NVARCHAR(50),
    [POSITIONAL_ERROR] BIGINT,
    [ERROR_REPORTED_BY] NVARCHAR(50),
    [CAPTURE_METHOD] NVARCHAR(50),
    [COMPILED_IND] NVARCHAR(5),
    [STATED_AREA] NVARCHAR(50),
    [WHEN_CREATED] DATETIME,
    [WHEN_UPDATED] DATETIME,
    [FEATURE_AREA_SQM] BIGINT,
    [FEATURE_LENGTH_M] BIGINT,
    [SHAPE] GEOMETRY,
    [OBJECTID] NUMERIC(38),
    [SE_ANNO_CAD_DATA] VARBINARY(max),
    CONSTRAINT [PRCPLY_PK] PRIMARY KEY CLUSTERED ([PARCEL_FABRIC_POLY_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRCPLY_PID_NUMBER_IDX] ON [pmbc].[PMBC_PARCEL_POLYGON_FABRIC] ([PID_NUMBER] ASC)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'The ParcelMap BC (PMBC) parcel fabric contains all active titled parcels and surveyed provincial Crown land parcels in BC. For building strata parcels, there is a record, with PID value, for each parcel within the strata parcel; the geometry for those records is the geometry for the overall strata. This dataset is polygonal and contains all parcel attributes.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_FABRIC_POLY_ID is a system generated unique identification number.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_FABRIC_POLY_ID'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'GLOBAL_UID is a unique global identifier (GUID) for the parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'GLOBAL_UID'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N' 	PARCEL_NAME is the same as the PID, if there is one. If there is a PIN but no PID, then PARCEL_NAME is the PIN. If there is no PID nor PIN, then PARCEL_NAME is the parcel class value, e.g., COMMON OWNERSHIP, BUILDING STRATA, AIR SPACE, ROAD, PARK.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_NAME'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PLAN_ID is the unique identifier of the land survey plan that corresponds to this parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PLAN_ID'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PLAN_NUMBER is the Land Act, Land Title Act, or Strata Property Act Plan Number for the land survey plan that corresponds to this parcel, e.g., VIP1632, NO_PLAN.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PLAN_NUMBER'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PIN is the Crown Land Registry Parcel Identifier, if applicable.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PIN'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PID is the Land Title Register parcel identifier, a left-zero-padded nine-digit number that uniquely identifies a parcel in the land title register of in British Columbia. The registrar assigns PID numbers to parcels for which a title is being entered as a registered title. The Land Title Act refers to the PID as the permanent parcel identifier.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PID'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PID_NUMBER is the PID, without leading zeroes. PID is the Land Title Register parcel identifier, a nine-digit number that uniquely identifies a parcel in the land title register of in British Columbia. The registrar assigns PID numbers to parcels for which a title is being entered as a registered title. The Land Title Act refers to the PID as the permanent parcel identifier.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PID_NUMBER'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SOURCE_PARCEL_ID is the unique parcel identifier supplied by the source data provider. The value is intended to assist local governments by providing traceability back to the source data provider''s parcel ID. It will not be populated during on-going operations, e.g., DATA_NEW, CPG000050, 999, 01762.146.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SOURCE_PARCEL_ID'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_STATUS is the status of the parcel, according to the Land Title Register or Crown Land Registry, as appropriate, i.e., ACTIVE, CANCELLED, INACTIVE, PENDING.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_STATUS'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_CLASS is the Parcel classification for maintenance, mapping, publishing and analysis, i.e., PRIMARY, SUBDIVISION, PART OF PRIMARY, BUILDING STRATA, BARE LAND STRATA, AIR SPACE, ROAD, HIGHWAY, PARK, INTEREST, COMMON OWNERSHIP, ABSOLUTE FEE BOOK, CROWN SUBDIVISION, RETURN TO CROWN.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_CLASS'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'OWNER_TYPE is the general ownership category, e.g., PRIVATE, CROWN PROVINCIAL, MUNICIPAL.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'OWNER_TYPE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_START_DATE is the date of the legal event that created the parcel, i.e., the date the plan was filed.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_START_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_1 is, typically, the smallest division of lands in a survey. If available, this is generally the Parcel from a Subdivided short legal description or the Quadrant or Block from an Unsubdivided short legal description, e.g., PARCEL A, SW4.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_1'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_2 is, typically, the second smallest division of lands in a survey. If available, this is generally the Lot from a Subdivided short legal description or the District Lot, Lot or Section from an Unsubdivided short legal description, e.g., LOT 2.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_2'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_3 is, typically, the third smallest division of lands in a survey. If available, this is generally the Block from a Subdivided short legal description or the Range from an Unsubdivided short legal description, e.g., BLOCK H.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_3'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'LEGAL_DESCRIPTION is the full legal description of the parcel and is primarily recorded from the Land Title Register. Where recorded only in the Crown Land Registry, this attribute is to be populated from Tantalis for the fabric compilation, but maintained by PMBC during on-going operations.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'LEGAL_DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'MUNICIPALITY is the municipal area within which the parcel is located. The value is either RURAL (for parcels in unincorporated regions) or the name of a BC municipality.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'MUNICIPALITY'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'REGIONAL_DISTRICT is the name of the regional district in which the parcel is located, e.g., CAPITAL REGIONAL DISTRICT.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'REGIONAL_DISTRICT'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'IS_REMAINDER_IND indicates if the parcel is a remainder of the original, i.e., YES, NO.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'IS_REMAINDER_IND'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'GEOMETRY_SOURCE is the source of the parcel geometry data, e.g., ICIS CADASTRE, ICF, PMBC OPERATIONS.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'GEOMETRY_SOURCE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'POSITIONAL_ERROR is the semi-major axis at the 95% confidence level of the least accurate point of the parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'POSITIONAL_ERROR'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'ERROR_REPORTED_BY is the organization or process reporting the error, i.e., LSA, DATA COMPILATION.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'ERROR_REPORTED_BY'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'CAPTURE_METHOD is an indicator of relative accuracy, i.e., UNKNOWN, COGO, SURVEY PLAN DATASET.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'CAPTURE_METHOD'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'COMPILED_IND indicates if the parcel polygon was generated from inverted dimensions, i.e., True, False. "True" means that the parcel geometry was from a previous source cadastre and not precision input based on plan dimensions.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'COMPILED_IND'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'STATED_AREA is the area of the parcel, in square metres. It is automatically calculated if misclose is small; it can be edited to reflect the recorded plan value.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'STATED_AREA'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'WHEN_CREATED is the date and time the source record was created (not the time when it was loaded into the BC Geographic Warehouse).', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'WHEN_CREATED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'WHEN_UPDATED is the date and time the source record was last modified (not the time when it was loaded into, or modified in, the BC Geographic Warehouse).', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'WHEN_UPDATED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'FEATURE_AREA_SQM is the system calculated area of a two-dimensional polygon in square meters.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'FEATURE_AREA_SQM'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'FEATURE_LENGTH_M is the system calculated length or perimeter of a geometry in meters.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'FEATURE_LENGTH_M'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SHAPE is the column used to reference the spatial coordinates defining the feature.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SHAPE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'OBJECTID is a column required by spatial layers that interact with ESRI ArcSDE. It is populated with unique values automatically by SDE.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'OBJECTID'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SE_ANNO_CAD_DATA is a binary column used by spatial tools to store annotation, curve features and CAD data when using the SDO_GEOMETRY storage data type.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SE_ANNO_CAD_DATA'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_INITIATOR_TYPE"                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_INITIATOR_TYPE] (
    [LEASE_INITIATOR_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LINITT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LINITT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LINITT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LINITT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LINITT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LINITT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LINITT_PK] PRIMARY KEY CLUSTERED ([LEASE_INITIATOR_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Describes the initiator of the lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_INITIATOR_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code value of the initiator of the lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_INITIATOR_TYPE', 'COLUMN', N'LEASE_INITIATOR_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of the initiator of the lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_INITIATOR_TYPE', 'COLUMN', N'DESCRIPTION'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_RESPONSIBILITY_TYPE"                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_RESPONSIBILITY_TYPE] (
    [LEASE_RESPONSIBILITY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LRESPT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LRESPT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LRESPT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LRESPT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LRESPT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LRESPT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LRESPT_PK] PRIMARY KEY CLUSTERED ([LEASE_RESPONSIBILITY_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Describes which organization is responsible for this lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_RESPONSIBILITY_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code value of the organization responsible for this lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_RESPONSIBILITY_TYPE', 'COLUMN', N'LEASE_RESPONSIBILITY_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of the organization responsible for this lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_RESPONSIBILITY_TYPE', 'COLUMN', N'DESCRIPTION'
GO


/* ---------------------------------------------------------------------- */
/* Add table "etl.ETL_PROPERTY_ERROR_LOG"                                 */
/* ---------------------------------------------------------------------- */



CREATE TABLE [etl].[ETL_PROPERTY_ERROR_LOG] (
    [CIVIC_ADDRESS] NVARCHAR(100),
    [MUNICIPALITY_NAME] NVARCHAR(40),
    [DESCRIPTION] NVARCHAR(2000),
    [PID] INTEGER,
    [PIN] INTEGER,
    [LAND_LEGAL_DESCRIPTION] NVARCHAR(2000),
    [ZONING] NVARCHAR(2),
    [ZONING_POTENTIAL] NVARCHAR(30),
    [PROPERTY_ID] INTEGER,
    [PROPERTY_TYPE_CODE] NVARCHAR(4),
    [PROPERTY_CLASSIFICATION_TYPE_CODE] NVARCHAR(8),
    [ErrorCode] INTEGER,
    [ErrorColumn] INTEGER
)
GO




/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_TERM_STATUS_TYPE"                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_TERM_STATUS_TYPE] (
    [LEASE_TERM_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LTRMST_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LTRMST_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LTRMST_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LTRMST_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LTRMST_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LTRMST_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LTRMST_PK] PRIMARY KEY CLUSTERED ([LEASE_TERM_STATUS_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Describes the status of the lease term', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_TERM_STATUS_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Code value of the status of the lease term', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_TERM_STATUS_TYPE', 'COLUMN', N'LEASE_TERM_STATUS_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of the status of the lease term', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_TERM_STATUS_TYPE', 'COLUMN', N'DESCRIPTION'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT_PERIOD"                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT_PERIOD] (
    [LEASE_PAYMENT_PERIOD_ID] BIGINT CONSTRAINT [LPYPER_LEASE_PAYMENT_PERIOD_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_LEASE_PAYMENT_PERIOD_ID_SEQ] NOT NULL,
    [PERIOD_START_DATE] DATE NOT NULL,
    [IS_PERIOD_CLOSED] BIT CONSTRAINT [LPYPER_IS_PERIOD_CLOSED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LPYPER_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LPYPER_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LPYPER_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LPYPER_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LPYPER_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LPYPER_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LPYPER_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LPYPER_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LPYPER_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LPYPER_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LPYPER_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LPYPER_PK] PRIMARY KEY CLUSTERED ([LEASE_PAYMENT_PERIOD_ID])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT_METHOD_TYPE"                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT_METHOD_TYPE] (
    [LEASE_PAYMENT_METHOD_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LSPMMT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSPMMT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSPMMT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSPMMT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSPMMT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSPMMT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSPMMT_PK] PRIMARY KEY CLUSTERED ([LEASE_PAYMENT_METHOD_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Payment method type code', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_METHOD_TYPE', 'COLUMN', N'LEASE_PAYMENT_METHOD_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Payment method type description', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_METHOD_TYPE', 'COLUMN', N'DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is this code disabled?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_METHOD_TYPE', 'COLUMN', N'IS_DISABLED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Display order of the descriptions', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_METHOD_TYPE', 'COLUMN', N'DISPLAY_ORDER'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT_STATUS_TYPE"                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT_STATUS_TYPE] (
    [LEASE_PAYMENT_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [LPSTST_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LPSTST_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LPSTST_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LPSTST_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LPSTST_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LPSTST_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LPSTST_PK] PRIMARY KEY CLUSTERED ([LEASE_PAYMENT_STATUS_TYPE_CODE])
)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Describes the status of forecast payments', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_STATUS_TYPE', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Payment status type code', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_STATUS_TYPE', 'COLUMN', N'LEASE_PAYMENT_STATUS_TYPE_CODE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Payment status type description', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_STATUS_TYPE', 'COLUMN', N'DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is this code disabled?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_STATUS_TYPE', 'COLUMN', N'IS_DISABLED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Display order of the descriptions', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_PAYMENT_STATUS_TYPE', 'COLUMN', N'DISPLAY_ORDER'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_STATIC_VARIABLE"                                   */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_STATIC_VARIABLE] (
    [STATIC_VARIABLE_NAME] NVARCHAR(100) NOT NULL,
    [STATIC_VARIABLE_VALUE] NVARCHAR(100) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [STAVBL_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [STAVBL_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [STAVBL_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [STAVBL_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [STAVBL_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [STAVBL_PK] PRIMARY KEY CLUSTERED ([STATIC_VARIABLE_NAME])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT_FORECAST_HIST"                       */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT_FORECAST_HIST] (
    [_LEASE_PAYMENT_FORECAST_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_LEAS___LEAS__2A962F78] DEFAULT NEXT VALUE FOR [PIMS_LEASE_PAYMENT_FORECAST_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_LEAS__EFFEC__2B8A53B1] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [LEASE_PAYMENT_FORECAST_ID] BIGINT NOT NULL,
    [LEASE_TERM_ID] VARCHAR(40) NOT NULL,
    [LEASE_PAYMENT_PERIOD_ID] BIGINT NOT NULL,
    [LEASE_PAYMENT_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PAYMENT_DUE_DATE] DATETIME NOT NULL,
    [FORECAST_PAYMENT_PRE_TAX] MONEY NOT NULL,
    [FORECAST_PAYMENT_PST] MONEY NOT NULL,
    [FORECAST_PAYMENT_GST] MONEY NOT NULL,
    [FORECAST_PAYMENT_TOTAL] MONEY NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_LPFCST_H_PK] PRIMARY KEY CLUSTERED ([_LEASE_PAYMENT_FORECAST_HIST_ID]),
    CONSTRAINT [PIMS_LPFCST_H_UK] UNIQUE ([_LEASE_PAYMENT_FORECAST_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT_HIST"                                */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT_HIST] (
    [_LEASE_PAYMENT_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_LEAS___LEAS__304F08CE] DEFAULT NEXT VALUE FOR [PIMS_LEASE_PAYMENT_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_LEAS__EFFEC__31432D07] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [LEASE_PAYMENT_ID] BIGINT NOT NULL,
    [LEASE_TERM_ID] VARCHAR(40) NOT NULL,
    [LEASE_PAYMENT_PERIOD_ID] BIGINT NOT NULL,
    [LEASE_PAYMENT_METHOD_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PAYMENT_RECEIVED_DATE] DATETIME NOT NULL,
    [PAYMENT_AMOUNT_PRE_TAX] MONEY NOT NULL,
    [PAYMENT_AMOUNT_PST] MONEY NOT NULL,
    [PAYMENT_AMOUNT_GST] MONEY NOT NULL,
    [PAYMENT_AMOUNT_TOTAL] MONEY NOT NULL,
    [NOTE] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_LSPYMT_H_PK] PRIMARY KEY CLUSTERED ([_LEASE_PAYMENT_HIST_ID]),
    CONSTRAINT [PIMS_LSPYMT_H_UK] UNIQUE ([_LEASE_PAYMENT_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT_PERIOD_HIST"                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT_PERIOD_HIST] (
    [_LEASE_PAYMENT_PERIOD_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_LEAS___LEAS__3607E224] DEFAULT NEXT VALUE FOR [PIMS_LEASE_PAYMENT_PERIOD_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_LEAS__EFFEC__36FC065D] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [LEASE_PAYMENT_PERIOD_ID] BIGINT NOT NULL,
    [PERIOD_START_DATE] DATE NOT NULL,
    [IS_PERIOD_CLOSED] BIT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_LPYPER_H_PK] PRIMARY KEY CLUSTERED ([_LEASE_PAYMENT_PERIOD_HIST_ID]),
    CONSTRAINT [PIMS_LPYPER_H_UK] UNIQUE ([_LEASE_PAYMENT_PERIOD_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_TERM_HIST"                                   */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_TERM_HIST] (
    [_LEASE_TERM_HIST_ID] BIGINT CONSTRAINT [DF__PIMS_LEAS___LEAS__417994D0] DEFAULT NEXT VALUE FOR [PIMS_LEASE_TERM_H_ID_SEQ] NOT NULL,
    [EFFECTIVE_DATE_HIST] DATETIME CONSTRAINT [DF__PIMS_LEAS__EFFEC__426DB909] DEFAULT getutcdate() NOT NULL,
    [END_DATE_HIST] DATETIME,
    [LEASE_TERM_ID] VARCHAR(40) NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [LEASE_TERM_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [TERM_START_DATE] DATETIME NOT NULL,
    [TERM_EXPIRY_DATE] DATETIME,
    [TERM_RENEWAL_DATE] DATETIME,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    CONSTRAINT [PIMS_LSTERM_H_PK] PRIMARY KEY CLUSTERED ([_LEASE_TERM_HIST_ID]),
    CONSTRAINT [PIMS_LSTERM_H_UK] UNIQUE ([_LEASE_TERM_HIST_ID], [END_DATE_HIST])
)
GO


/* ---------------------------------------------------------------------- */
/* Add table "etl.ETL_ERROR_LOG"                                          */
/* ---------------------------------------------------------------------- */



CREATE TABLE [etl].[ETL_ERROR_LOG] (
    [ERROR_TIME] DATETIME,
    [ERROR_OPERATION_NAME] NVARCHAR(100),
    [ERROR_TASK_NAME] NVARCHAR(100),
    [ERROR_ETL_NAME] NVARCHAR(100),
    [ERROR_ROW] NVARCHAR(max)
)
GO




/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT"                                           */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT] (
    [PROJECT_ID] BIGINT CONSTRAINT [PROJCT_PROJECT_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_ID_SEQ] NOT NULL,
    [PROJECT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROJECT_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROJECT_RISK_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROJECT_TIER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PROJCT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROJCT_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROJCT_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROJCT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PROJCT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROJCT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PROJCT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PROJCT_PK] PRIMARY KEY CLUSTERED ([PROJECT_ID])
)
GO


CREATE NONCLUSTERED INDEX [PROJCT_PROJECT_RISK_TYPE_CODE_IDX] ON [dbo].[PIMS_PROJECT] ([PROJECT_RISK_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PROJCT_PROJECT_STATUS_TYPE_CODE_IDX] ON [dbo].[PIMS_PROJECT] ([PROJECT_STATUS_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PROJCT_PROJECT_TIER_TYPE_CODE_IDX] ON [dbo].[PIMS_PROJECT] ([PROJECT_TIER_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PROJCT_PROJECT_TYPE_CODE_IDX] ON [dbo].[PIMS_PROJECT] ([PROJECT_TYPE_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_SERVICE_FILE"                             */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_SERVICE_FILE] (
    [PROPERTY_SERVICE_FILE_ID] BIGINT CONSTRAINT [PRPSVC_PROPERTY_SERVICE_FILE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_SERVICE_FILE_ID_SEQ] NOT NULL,
    [PROPERTY_SERVICE_FILE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPSVC_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPSVC_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPSVC_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPSVC_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPSVC_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPSVC_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPSVC_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPSVC_PK] PRIMARY KEY CLUSTERED ([PROPERTY_SERVICE_FILE_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRPSVC_PROPERTY_SERVICE_FILE_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY_SERVICE_FILE] ([PROPERTY_SERVICE_FILE_TYPE_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_TASK_TEMPLATE"                                     */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_TASK_TEMPLATE] (
    [TASK_TEMPLATE_ID] BIGINT CONSTRAINT [TSKTMP_TASK_TEMPLATE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_TASK_TEMPLATE_ID_SEQ] NOT NULL,
    [TASK_TEMPLATE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [TSKTMP_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [TSKTMP_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTMP_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTMP_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTMP_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TSKTMP_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTMP_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TSKTMP_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [TSKTMP_PK] PRIMARY KEY CLUSTERED ([TASK_TEMPLATE_ID])
)
GO


CREATE NONCLUSTERED INDEX [TSKTMP_TASK_TEMPLATE_TYPE_CODE_IDX] ON [dbo].[PIMS_TASK_TEMPLATE] ([TASK_TEMPLATE_TYPE_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_WORKFLOW_MODEL"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_WORKFLOW_MODEL] (
    [WORKFLOW_MODEL_ID] BIGINT CONSTRAINT [WFLMDL_WORKFLOW_MODEL_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_WORKFLOW_MODEL_ID_SEQ] NOT NULL,
    [WORKFLOW_MODEL_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [WFLMDL_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [WFLMDL_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [WFLMDL_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [WFLMDL_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [WFLMDL_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [WFLMDL_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [WFLMDL_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [WFLMDL_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [WFLMDL_PK] PRIMARY KEY CLUSTERED ([WORKFLOW_MODEL_ID])
)
GO


CREATE NONCLUSTERED INDEX [WFLMDL_WORKFLOW_MODEL_TYPE_CODE_IDX] ON [dbo].[PIMS_WORKFLOW_MODEL] ([WORKFLOW_MODEL_TYPE_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_DISTRICT"                                          */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_DISTRICT] (
    [DISTRICT_CODE] SMALLINT NOT NULL,
    [REGION_CODE] SMALLINT NOT NULL,
    [DISTRICT_NAME] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [DSTRCT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [DSTRCT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [DSTRCT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [DSTRCT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [DSTRCT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [DSTRCT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [DSTRCT_PK] PRIMARY KEY CLUSTERED ([DISTRICT_CODE])
)
GO


CREATE NONCLUSTERED INDEX [DSTRCT_REGION_CODE_IDX] ON [dbo].[PIMS_DISTRICT] ([REGION_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROVINCE_STATE"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROVINCE_STATE] (
    [PROVINCE_STATE_ID] SMALLINT NOT NULL,
    [COUNTRY_ID] SMALLINT NOT NULL,
    [PROVINCE_STATE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(200) NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PROVNC_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [DISPLAY_ORDER] INTEGER,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PROVNC_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROVNC_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PROVNC_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROVNC_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PROVNC_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PROVNC_PK] PRIMARY KEY CLUSTERED ([PROVINCE_STATE_ID])
)
GO


CREATE NONCLUSTERED INDEX [PROVNC_COUNTRY_ID_IDX] ON [dbo].[PIMS_PROVINCE_STATE] ([COUNTRY_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ROLE_CLAIM"                                        */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ROLE_CLAIM] (
    [ROLE_CLAIM_ID] BIGINT CONSTRAINT [ROLCLM_ROLE_CLAIM_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ROLE_CLAIM_ID_SEQ] NOT NULL,
    [ROLE_ID] BIGINT NOT NULL,
    [CLAIM_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ROLCLM_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ROLCLM_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ROLCLM_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ROLCLM_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ROLCLM_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ROLCLM_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ROLCLM_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ROLCLM_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ROLCLM_PK] PRIMARY KEY CLUSTERED ([ROLE_CLAIM_ID]),
    CONSTRAINT [ROLCLM_ROLE_CLAIM_TUC] UNIQUE ([ROLE_ID], [CLAIM_ID])
)
GO


CREATE NONCLUSTERED INDEX [ROLCLM_CLAIM_ID_IDX] ON [dbo].[PIMS_ROLE_CLAIM] ([CLAIM_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ROLCLM_ROLE_ID_IDX] ON [dbo].[PIMS_ROLE_CLAIM] ([ROLE_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_NOTE"                                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_NOTE] (
    [PROJECT_NOTE_ID] BIGINT CONSTRAINT [PROJNT_PROJECT_NOTE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_NOTE_ID_SEQ] NOT NULL,
    [PROJECT_ID] BIGINT NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROJNT_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROJNT_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PROJNT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROJNT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PROJNT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROJNT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PROJNT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PROJNT_PK] PRIMARY KEY CLUSTERED ([PROJECT_NOTE_ID])
)
GO


CREATE NONCLUSTERED INDEX [PROJNT_PROJECT_ID_IDX] ON [dbo].[PIMS_PROJECT_NOTE] ([PROJECT_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_TASK_TEMPLATE_ACTIVITY_MODEL"                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL] (
    [TASK_TEMPLATE_ACTIVITY_MODEL_ID] BIGINT CONSTRAINT [TSKTAM_TASK_TEMPLATE_ACTIVITY_MODEL_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_ID_SEQ] NOT NULL,
    [TASK_TEMPLATE_ID] BIGINT NOT NULL,
    [ACTIVITY_MODEL_ID] BIGINT NOT NULL,
    [IS_MANDATORY] BIT CONSTRAINT [TSKTAM_IS_MANDATORY_DEF] DEFAULT CONVERT([bit],(1)) NOT NULL,
    [IMPLEMENTATION_ORDER] SMALLINT CONSTRAINT [TSKTAM_IMPLEMENTATION_ORDER_DEF] DEFAULT 0 NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [TSKTAM_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [TSKTAM_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTAM_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTAM_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTAM_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TSKTAM_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TSKTAM_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TSKTAM_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [TSKTAM_PK] PRIMARY KEY CLUSTERED ([TASK_TEMPLATE_ACTIVITY_MODEL_ID]),
    CONSTRAINT [TSKTAM_TASK_TEMPLATE_ACTIVITY_MODEL_TUC] UNIQUE ([TASK_TEMPLATE_ID], [ACTIVITY_MODEL_ID])
)
GO


CREATE NONCLUSTERED INDEX [TSKTAM_TASK_TEMPLATE_ID_IDX] ON [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL] ([TASK_TEMPLATE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [TSKTAM_ACTIVITY_MODEL_ID_IDX] ON [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL] ([ACTIVITY_MODEL_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_WORKFLOW_MODEL"                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_WORKFLOW_MODEL] (
    [PROJECT_WORKFLOW_MODEL_ID] BIGINT CONSTRAINT [PRWKMD_PROJECT_WORKFLOW_MODEL_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_WORKFLOW_MODEL_ID_SEQ] NOT NULL,
    [PROJECT_ID] BIGINT NOT NULL,
    [WORKFLOW_MODEL_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRWKMD_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRWKMD_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRWKMD_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRWKMD_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRWKMD_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRWKMD_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRWKMD_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRWKMD_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRWKMD_PK] PRIMARY KEY CLUSTERED ([PROJECT_WORKFLOW_MODEL_ID]),
    CONSTRAINT [PRWKMD_PROJECT_WORKFLOW_MODEL_TUC] UNIQUE ([PROJECT_ID], [WORKFLOW_MODEL_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRWKMD_PROJECT_ID_IDX] ON [dbo].[PIMS_PROJECT_WORKFLOW_MODEL] ([PROJECT_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRWKMD_WORKFLOW_MODEL_ID_IDX] ON [dbo].[PIMS_PROJECT_WORKFLOW_MODEL] ([WORKFLOW_MODEL_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ADDRESS"                                           */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ADDRESS] (
    [ADDRESS_ID] BIGINT CONSTRAINT [ADDRSS_ADDRESS_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ADDRESS_ID_SEQ] NOT NULL,
    [ADDRESS_USAGE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [REGION_CODE] SMALLINT,
    [DISTRICT_CODE] SMALLINT,
    [PROVINCE_STATE_ID] SMALLINT NOT NULL,
    [COUNTRY_ID] SMALLINT,
    [STREET_ADDRESS_1] NVARCHAR(200),
    [STREET_ADDRESS_2] NVARCHAR(200),
    [STREET_ADDRESS_3] NVARCHAR(200),
    [MUNICIPALITY_NAME] NVARCHAR(200),
    [POSTAL_CODE] NVARCHAR(20),
    [LATITUDE] NUMERIC(8,6),
    [LONGITUDE] NUMERIC(9,6),
    [COMMENT] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ADDRSS_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ADDRSS_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ADDRSS_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ADDRSS_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ADDRSS_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ADDRSS_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ADDRSS_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ADDRSS_PK] PRIMARY KEY CLUSTERED ([ADDRESS_ID])
)
GO


CREATE NONCLUSTERED INDEX [ADDRSS_ADDRESS_USAGE_TYPE_CODE_IDX] ON [dbo].[PIMS_ADDRESS] ([ADDRESS_USAGE_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [ADDRSS_COUNTRY_ID_IDX] ON [dbo].[PIMS_ADDRESS] ([COUNTRY_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ADDRSS_DISTRICT_CODE_IDX] ON [dbo].[PIMS_ADDRESS] ([DISTRICT_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [ADDRSS_PROVINCE_STATE_ID_IDX] ON [dbo].[PIMS_ADDRESS] ([PROVINCE_STATE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ADDRSS_REGION_CODE_IDX] ON [dbo].[PIMS_ADDRESS] ([REGION_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ORGANIZATION"                                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ORGANIZATION] (
    [ORGANIZATION_ID] BIGINT CONSTRAINT [ORG_ORGANIZATION_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ORGANIZATION_ID_SEQ] NOT NULL,
    [PRNT_ORGANIZATION_ID] BIGINT,
    [ADDRESS_ID] BIGINT NOT NULL,
    [REGION_CODE] SMALLINT,
    [DISTRICT_CODE] SMALLINT,
    [ORGANIZATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [ORG_IDENTIFIER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [ORGANIZATION_IDENTIFIER] NVARCHAR(100),
    [ORGANIZATION_NAME] NVARCHAR(200) NOT NULL,
    [ORGANIZATION_ALIAS] NVARCHAR(200),
    [WEBSITE] NVARCHAR(200),
    [IS_DISABLED] BIT CONSTRAINT [ORG_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ORG_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ORG_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ORG_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ORG_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ORG_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ORG_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ORG_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ORG_PK] PRIMARY KEY CLUSTERED ([ORGANIZATION_ID])
)
GO


CREATE NONCLUSTERED INDEX [ORG_ADDRESS_ID_IDX] ON [dbo].[PIMS_ORGANIZATION] ([ADDRESS_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ORG_DISTRICT_CODE_IDX] ON [dbo].[PIMS_ORGANIZATION] ([DISTRICT_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [ORG_ORG_IDENTIFIER_TYPE_CODE_IDX] ON [dbo].[PIMS_ORGANIZATION] ([ORG_IDENTIFIER_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [ORG_ORGANIZATION_TYPE_CODE_IDX] ON [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [ORG_PRNT_ORGANIZATION_ID_IDX] ON [dbo].[PIMS_ORGANIZATION] ([PRNT_ORGANIZATION_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ORG_REGION_CODE_IDX] ON [dbo].[PIMS_ORGANIZATION] ([REGION_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PERSON"                                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PERSON] (
    [PERSON_ID] BIGINT CONSTRAINT [PERSON_PERSON_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PERSON_ID_SEQ] NOT NULL,
    [ADDRESS_ID] BIGINT,
    [SURNAME] NVARCHAR(50) NOT NULL,
    [FIRST_NAME] NVARCHAR(50) NOT NULL,
    [MIDDLE_NAMES] NVARCHAR(200),
    [NAME_SUFFIX] NVARCHAR(50),
    [PREFERRED_NAME] NVARCHAR(200),
    [BIRTH_DATE] DATE,
    [IS_DISABLED] BIT CONSTRAINT [PERSON_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PERSON_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PERSON_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PERSON_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PERSON_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PERSON_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PERSON_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PERSON_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PERSON_PK] PRIMARY KEY CLUSTERED ([PERSON_ID])
)
GO


CREATE NONCLUSTERED INDEX [PERSON_ADDRESS_ID_IDX] ON [dbo].[PIMS_PERSON] ([ADDRESS_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PERSON_ORGANIZATION"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PERSON_ORGANIZATION] (
    [PERSON_ORGANIZATION_ID] BIGINT CONSTRAINT [PERORG_PERSON_ORGANIZATION_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PERSON_ORGANIZATION_ID_SEQ] NOT NULL,
    [PERSON_ID] BIGINT,
    [ORGANIZATION_ID] BIGINT,
    [IS_DISABLED] BIT CONSTRAINT [PERORG_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PERORG_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PERORG_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PERORG_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PERORG_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PERORG_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PERORG_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PERORG_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PERORG_PK] PRIMARY KEY CLUSTERED ([PERSON_ORGANIZATION_ID]),
    CONSTRAINT [PERORG_PERSON_ORGANIZATION_TUC] UNIQUE ([ORGANIZATION_ID], [PERSON_ID])
)
GO


CREATE NONCLUSTERED INDEX [PERORG_ORGANIZATION_ID_IDX] ON [dbo].[PIMS_PERSON_ORGANIZATION] ([ORGANIZATION_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PERORG_PERSON_ID_IDX] ON [dbo].[PIMS_PERSON_ORGANIZATION] ([PERSON_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_CONTACT_METHOD"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_CONTACT_METHOD] (
    [CONTACT_METHOD_ID] BIGINT CONSTRAINT [CNTMTH_CONTACT_METHOD_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_CONTACT_METHOD_ID_SEQ] NOT NULL,
    [CONTACT_METHOD_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PERSON_ID] BIGINT,
    [ORGANIZATION_ID] BIGINT,
    [CONTACT_METHOD_VALUE] NVARCHAR(200) NOT NULL,
    [IS_PREFERRED_METHOD] BIT CONSTRAINT [CNTMTH_IS_PREFERRED_METHOD_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [CNTMTH_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [CNTMTH_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [CNTMTH_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [CNTMTH_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [CNTMTH_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [CNTMTH_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [CNTMTH_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [CNTMTH_PK] PRIMARY KEY CLUSTERED ([CONTACT_METHOD_ID])
)
GO


CREATE NONCLUSTERED INDEX [CNTMTH_CONTACT_METHOD_TYPE_CODE_IDX] ON [dbo].[PIMS_CONTACT_METHOD] ([CONTACT_METHOD_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [CNTMTH_ORGANIZATION_ID_IDX] ON [dbo].[PIMS_CONTACT_METHOD] ([ORGANIZATION_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [CNTMTH_PERSON_ID_IDX] ON [dbo].[PIMS_CONTACT_METHOD] ([PERSON_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE"                                             */
/* ---------------------------------------------------------------------- */



CREATE TABLE [dbo].[PIMS_LEASE] (
    [LEASE_ID] BIGINT CONSTRAINT [LEASE_LEASE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_LEASE_ID_SEQ] NOT NULL,
    [MOTI_NAME_ID] BIGINT NOT NULL,
    [LEASE_PAY_RVBL_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_LICENSE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_CATEGORY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PURPOSE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PROGRAM_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_INITIATOR_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_RESPONSIBILITY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PMT_FREQ_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [LEASE_PURPOSE_OTHER_DESC] NVARCHAR(200),
    [L_FILE_NO] NVARCHAR(50),
    [TFA_FILE_NO] INTEGER,
    [PS_FILE_NO] NVARCHAR(50),
    [LEASE_DESCRIPTION] NVARCHAR(4000),
    [LEASE_NOTES] NVARCHAR(4000),
    [ORIG_START_DATE] DATETIME NOT NULL,
    [ORIG_EXPIRY_DATE] DATETIME,
    [IS_ORIG_EXPIRY_REQUIRED] BIT CONSTRAINT [LEASE_IS_ORIG_EXPIRY_REQUIRED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [INCLUDED_RENEWALS] SMALLINT,
    [RENEWAL_COUNT] SMALLINT,
    [RENEWAL_TERM_MONTHS] SMALLINT CONSTRAINT [LEASE_RENEWAL_TERM_MONTHS_DEF] DEFAULT 0 NOT NULL,
    [LEASE_AMOUNT] MONEY,
    [RESPONSIBILITY_EFFECTIVE_DATE] DATETIME,
    [INSPECTION_DATE] DATETIME,
    [INSPECTION_NOTES] NVARCHAR(4000),
    [IS_SUBJECT_TO_RTA] BIT CONSTRAINT [LEASE_IS_SUBJECT_TO_RTA_DEF] DEFAULT CONVERT([bit],(0)),
    [IS_COMM_BLDG] BIT CONSTRAINT [LEASE_IS_COMM_BLDG_DEF] DEFAULT CONVERT([bit],(0)),
    [IS_OTHER_IMPROVEMENT] BIT CONSTRAINT [LEASE_IS_OTHER_IMPROVEMENT_DEF] DEFAULT CONVERT([bit],(0)),
    [IS_EXPIRED] BIT CONSTRAINT [LEASE_EXPIRED_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [HAS_PHYSICAL_FILE] BIT CONSTRAINT [LEASE_HAS_PHYSICAL_FILE_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [HAS_DIGITAL_FILE] BIT CONSTRAINT [LEASE_HAS_DIGITAL_FILE_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [HAS_PHYSICIAL_LICENSE] BIT CONSTRAINT [LEASE_HAS_PHYSICIAL_LICENSE_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [HAS_DIGITAL_LICENSE] BIT CONSTRAINT [LEASE_HAS_DIGITAL_LICENSE_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LEASE_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LEASE_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LEASE_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LEASE_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LEASE_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LEASE_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LEASE_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LEASE_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LEASE_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LEASE_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LEASE_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LEASE_PK] PRIMARY KEY CLUSTERED ([LEASE_ID])
)
GO




CREATE NONCLUSTERED INDEX [LEASE_L_FILE_NO_IDX] ON [dbo].[PIMS_LEASE] ([L_FILE_NO] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_CATEGORY_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_CATEGORY_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_INITIATOR_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_INITIATOR_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_LICENSE_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_LICENSE_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_PAY_RVBL_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_PAY_RVBL_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_PMT_FREQ_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_PMT_FREQ_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_PROGRAM_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_PROGRAM_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_PURPOSE_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_PURPOSE_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_LEASE_RESPONSIBILITY_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE] ([LEASE_RESPONSIBILITY_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_MOTI_NAME_ID_IDX] ON [dbo].[PIMS_LEASE] ([MOTI_NAME_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_PS_FILE_NO_IDX] ON [dbo].[PIMS_LEASE] ([PS_FILE_NO] ASC)
GO


CREATE NONCLUSTERED INDEX [LEASE_TFA_FILE_NO_IDX] ON [dbo].[PIMS_LEASE] ([TFA_FILE_NO] ASC)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'User-specified lease purpose description not included in standard set of lease purposes', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'LEASE_PURPOSE_OTHER_DESC'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Generated identifying lease/licence number', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'L_FILE_NO'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Sourced from t_fileMain.TFA_File_Number', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'TFA_FILE_NO'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Sourced from t_fileSubOverrideData.PSFile_No', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'PS_FILE_NO'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Manually etered lease description, not the legal description', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'LEASE_DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Notes accompanying lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'LEASE_NOTES'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Original start date of the lease/license', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'ORIG_START_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Original expiry date of the lease/license', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'ORIG_EXPIRY_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is there a a requirement to record the original tenancy expiry date?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'IS_ORIG_EXPIRY_REQUIRED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Maximum allowable number of lease renewals', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'INCLUDED_RENEWALS'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Number of exercised renewals', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'RENEWAL_COUNT'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Number of months included in lease renewal', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'RENEWAL_TERM_MONTHS'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Lease/licence amount', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'LEASE_AMOUNT'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Date current responsibility came into effect for this lease', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'RESPONSIBILITY_EFFECTIVE_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Inspection date', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'INSPECTION_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Notes accompanying inspection', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'INSPECTION_NOTES'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is subject the Residential Tenancy Act', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'IS_SUBJECT_TO_RTA'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is a commercial building', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'IS_COMM_BLDG'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is improvement of another description', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'IS_OTHER_IMPROVEMENT'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Incidcator that lease/license has expired', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'IS_EXPIRED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Indicator that phyical file exists', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'HAS_PHYSICAL_FILE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Indicator that digital file exists', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'HAS_DIGITAL_FILE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Indicator that physical license exists', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'HAS_PHYSICIAL_LICENSE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Indicator that digital license exists', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE', 'COLUMN', N'HAS_DIGITAL_LICENSE'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_TENANT"                                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_TENANT] (
    [LEASE_TENANT_ID] BIGINT CONSTRAINT [TENANT_LEASE_TENANT_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_LEASE_TENANT_ID_SEQ] NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [PERSON_ID] BIGINT,
    [ORGANIZATION_ID] BIGINT,
    [LESSOR_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [NOTE] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [TENANT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TENANT_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TENANT_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [TENANT_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TENANT_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TENANT_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [TENANT_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TENANT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TENANT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TENANT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TENANT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [TENANT_PK] PRIMARY KEY CLUSTERED ([LEASE_TENANT_ID])
)
GO


CREATE NONCLUSTERED INDEX [TENANT_LEASE_ID_IDX] ON [dbo].[PIMS_LEASE_TENANT] ([LEASE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [TENANT_LESSOR_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE_TENANT] ([LESSOR_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [TENANT_ORGANIZATION_ID_IDX] ON [dbo].[PIMS_LEASE_TENANT] ([ORGANIZATION_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [TENANT_PERSON_ID_IDX] ON [dbo].[PIMS_LEASE_TENANT] ([PERSON_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_INSURANCE"                                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_INSURANCE] (
    [INSURANCE_ID] BIGINT CONSTRAINT [INSRNC_INSURANCE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_INSURANCE_ID_SEQ] NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [INSURANCE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [INSURER_ORG_ID] BIGINT NOT NULL,
    [INSURER_CONTACT_ID] BIGINT NOT NULL,
    [MOTI_RISK_MGMT_CONTACT_ID] BIGINT NOT NULL,
    [BCTFA_RISK_MGMT_CONTACT_ID] BIGINT NOT NULL,
    [INSURANCE_PAYEE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [OTHER_INSURANCE_TYPE] NVARCHAR(200),
    [COVERAGE_DESCRIPTION] NVARCHAR(2000),
    [COVERAGE_LIMIT] MONEY CONSTRAINT [INSRNC_COVERAGE_LIMIT_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [INSURED_VALUE] MONEY NOT NULL,
    [START_DATE] DATE NOT NULL,
    [EXPIRY_DATE] DATE NOT NULL,
    [RISK ASSESSMENT_COMPLETED_DATE] DATETIME,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [INSRNC_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [INSRNC_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [INSRNC_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [INSRNC_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [INSRNC_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [INSRNC_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [INSRNC_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [INSRNC_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [INSRNC_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [INSRNC_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [INSRNC_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [INSRNC_PK] PRIMARY KEY CLUSTERED ([INSURANCE_ID])
)
GO


CREATE NONCLUSTERED INDEX [INSRNC_BCTFA_RISK_MGMT_CONTACT_ID_IDX] ON [dbo].[PIMS_INSURANCE] ([BCTFA_RISK_MGMT_CONTACT_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [INSRNC_INSURANCE_PAYEE_TYPE_CODE_IDX] ON [dbo].[PIMS_INSURANCE] ([INSURANCE_PAYEE_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [INSRNC_INSURANCE_TYPE_CODE_IDX] ON [dbo].[PIMS_INSURANCE] ([INSURANCE_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [INSRNC_INSURER_CONTACT_ID_IDX] ON [dbo].[PIMS_INSURANCE] ([INSURER_CONTACT_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [INSRNC_INSURER_ORG_ID_IDX] ON [dbo].[PIMS_INSURANCE] ([INSURER_ORG_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [INSRNC_LEASE_ID_IDX] ON [dbo].[PIMS_INSURANCE] ([LEASE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [INSRNC_MOTI_RISK_MGMT_CONTACT_ID_IDX] ON [dbo].[PIMS_INSURANCE] ([MOTI_RISK_MGMT_CONTACT_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_SECURITY_DEPOSIT"                                  */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_SECURITY_DEPOSIT] (
    [SECURITY_DEPOSIT_ID] BIGINT CONSTRAINT [SECDEP_SECURITY_DEPOSIT_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_SECURITY_DEPOSIT_ID_SEQ] NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [SEC_DEP_HOLDER_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [SECURITY_DEPOSIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [DESCRIPTION] NVARCHAR(2000) NOT NULL,
    [AMOUNT_PAID] MONEY NOT NULL,
    [TOTAL_AMOUNT] MONEY NOT NULL,
    [DEPOSIT_DATE] DATE NOT NULL,
    [ANNUAL_INTEREST_RATE] NUMERIC(5,2),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [SECDEP_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [SECDEP_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [SECDEP_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [SECDEP_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [SECDEP_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [SECDEP_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [SECDEP_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [SECDEP_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [SECDEP_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [SECDEP_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [SECDEP_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [SECDEP_PK] PRIMARY KEY CLUSTERED ([SECURITY_DEPOSIT_ID])
)
GO


CREATE NONCLUSTERED INDEX [SECDEP_LEASE_ID_IDX] ON [dbo].[PIMS_SECURITY_DEPOSIT] ([LEASE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [SECDEP_SEC_DEP_HOLDER_TYPE_CODE_IDX] ON [dbo].[PIMS_SECURITY_DEPOSIT] ([SEC_DEP_HOLDER_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [SECDEP_SECURITY_DEPOSIT_TYPE_CODE_IDX] ON [dbo].[PIMS_SECURITY_DEPOSIT] ([SECURITY_DEPOSIT_TYPE_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_SECURITY_DEPOSIT_RETURN"                           */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_SECURITY_DEPOSIT_RETURN] (
    [SECURITY_DEPOSIT_RETURN_ID] BIGINT CONSTRAINT [SDRTRN_SECURITY_DEPOSIT_RETURN_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_SECURITY_DEPOSIT_RETURN_ID_SEQ] NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [SECURITY_DEPOSIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [TERMINATION_DATE] DATETIME NOT NULL,
    [DEPOSIT_TOTAL] MONEY NOT NULL,
    [CLAIMS_AGAINST] MONEY,
    [RETURN_AMOUNT] MONEY NOT NULL,
    [RETURN_DATE] DATETIME NOT NULL,
    [CHEQUE_NUMBER] NVARCHAR(50) NOT NULL,
    [PAYEE_NAME] NVARCHAR(100) NOT NULL,
    [PAYEE_ADDRESS] NVARCHAR(500) NOT NULL,
    [TERMINATION_NOTE] NVARCHAR(4000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [SDRTRN_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [SDRTRN_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [SDRTRN_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [SDRTRN_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [SDRTRN_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [SDRTRN_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [SDRTRN_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [SDRTRN_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [SDRTRN_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [SDRTRN_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [SDRTRN_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [SDRTRN_PK] PRIMARY KEY CLUSTERED ([SECURITY_DEPOSIT_RETURN_ID])
)
GO


CREATE NONCLUSTERED INDEX [SDRTRN_LEASE_ID_IDX] ON [dbo].[PIMS_SECURITY_DEPOSIT_RETURN] ([LEASE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [SDRTRN_SECURITY_DEPOSIT_TYPE_CODE_IDX] ON [dbo].[PIMS_SECURITY_DEPOSIT_RETURN] ([SECURITY_DEPOSIT_TYPE_CODE] ASC)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Date the lease/license was terminated or surrendered', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'TERMINATION_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Total amount of the pet/security deposit (including interest)', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'DEPOSIT_TOTAL'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Amount of claims against the deposit', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'CLAIMS_AGAINST'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Amount returned minus claims', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'RETURN_AMOUNT'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Date of deposit return', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'RETURN_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Cheque number of the deposit return', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'CHEQUE_NUMBER'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Name of cheque recipient', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'PAYEE_NAME'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Address of cheque recipient', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'PAYEE_ADDRESS'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Notes regarding termination situation', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_SECURITY_DEPOSIT_RETURN', 'COLUMN', N'TERMINATION_NOTE'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_TERM"                                        */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_TERM] (
    [LEASE_TERM_ID] VARCHAR(40) CONSTRAINT [LSTERM_LEASE_TERM_ID_DEF] DEFAULT 'NEXT VALUE FOR [PIMS_LEASE_TERM_ID_SEQ]' NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [LEASE_TERM_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [TERM_START_DATE] DATETIME NOT NULL,
    [TERM_EXPIRY_DATE] DATETIME,
    [TERM_RENEWAL_DATE] DATETIME,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSTERM_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSTERM_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSTERM_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LSTERM_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSTERM_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSTERM_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LSTERM_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSTERM_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSTERM_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSTERM_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSTERM_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSTERM_PK] PRIMARY KEY CLUSTERED ([LEASE_TERM_ID])
)
GO


CREATE NONCLUSTERED INDEX [LSTERM_LEASE_ID_IDX] ON [dbo].[PIMS_LEASE_TERM] ([LEASE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [LSTERM_LEASE_TERM_STATUS_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE_TERM] ([LEASE_TERM_STATUS_TYPE_CODE] ASC)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Start date of the current term of the lease/licence', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_TERM', 'COLUMN', N'TERM_START_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Expiry date of the current term of the lease/licence', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_TERM', 'COLUMN', N'TERM_EXPIRY_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Renewal date of the current term of the lease/licence', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_LEASE_TERM', 'COLUMN', N'TERM_RENEWAL_DATE'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT_FORECAST"                            */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT_FORECAST] (
    [LEASE_PAYMENT_FORECAST_ID] BIGINT CONSTRAINT [LPFCST_LEASE_PAYMENT_FORECAST_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_LEASE_PAYMENT_FORECAST_ID_SEQ] NOT NULL,
    [LEASE_TERM_ID] VARCHAR(40) NOT NULL,
    [LEASE_PAYMENT_PERIOD_ID] BIGINT NOT NULL,
    [LEASE_PAYMENT_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PAYMENT_DUE_DATE] DATETIME NOT NULL,
    [FORECAST_PAYMENT_PRE_TAX] MONEY NOT NULL,
    [FORECAST_PAYMENT_PST] MONEY NOT NULL,
    [FORECAST_PAYMENT_GST] MONEY NOT NULL,
    [FORECAST_PAYMENT_TOTAL] MONEY NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LPFCST_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LPFCST_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LPFCST_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LPFCST_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LPFCST_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LPFCST_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LPFCST_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LPFCST_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LPFCST_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LPFCST_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LPFCST_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LPFCST_PK] PRIMARY KEY CLUSTERED ([LEASE_PAYMENT_FORECAST_ID])
)
GO


CREATE NONCLUSTERED INDEX [LPFCST_LEASE_PAYMENT_PERIOD_ID_IDX] ON [dbo].[PIMS_LEASE_PAYMENT_FORECAST] ([LEASE_PAYMENT_PERIOD_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [LPFCST_LEASE_PAYMENT_STATUS_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE_PAYMENT_FORECAST] ([LEASE_PAYMENT_STATUS_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LPFCST_LEASE_TERM_ID_IDX] ON [dbo].[PIMS_LEASE_PAYMENT_FORECAST] ([LEASE_TERM_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_LEASE_PAYMENT"                                     */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_LEASE_PAYMENT] (
    [LEASE_PAYMENT_ID] BIGINT CONSTRAINT [LSPYMT_LEASE_PAYMENT_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_LEASE_PAYMENT_ID_SEQ] NOT NULL,
    [LEASE_TERM_ID] VARCHAR(40) NOT NULL,
    [LEASE_PAYMENT_PERIOD_ID] BIGINT NOT NULL,
    [LEASE_PAYMENT_METHOD_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PAYMENT_RECEIVED_DATE] DATETIME NOT NULL,
    [PAYMENT_AMOUNT_PRE_TAX] MONEY NOT NULL,
    [PAYMENT_AMOUNT_PST] MONEY NOT NULL,
    [PAYMENT_AMOUNT_GST] MONEY NOT NULL,
    [PAYMENT_AMOUNT_TOTAL] MONEY NOT NULL,
    [NOTE] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [LSPYMT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSPYMT_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSPYMT_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LSPYMT_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSPYMT_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSPYMT_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [LSPYMT_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [LSPYMT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [LSPYMT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [LSPYMT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [LSPYMT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [LSPYMT_PK] PRIMARY KEY CLUSTERED ([LEASE_PAYMENT_ID])
)
GO


CREATE NONCLUSTERED INDEX [LSPYMT_LEASE_PAYMENT_METHOD_TYPE_CODE_IDX] ON [dbo].[PIMS_LEASE_PAYMENT] ([LEASE_PAYMENT_METHOD_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [LSPYMT_LEASE_PAYMENT_PERIOD_ID_IDX] ON [dbo].[PIMS_LEASE_PAYMENT] ([LEASE_PAYMENT_PERIOD_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [LSPYMT_LEASE_TERM_ID_IDX] ON [dbo].[PIMS_LEASE_PAYMENT] ([LEASE_TERM_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY"                                          */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY] (
    [PROPERTY_ID] BIGINT CONSTRAINT [PRPRTY_PROPERTY_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_ID_SEQ] NOT NULL,
    [PROPERTY_MANAGER_ID] BIGINT,
    [PROP_MGMT_ORG_ID] BIGINT,
    [PROPERTY_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_CLASSIFICATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [ADDRESS_ID] BIGINT NOT NULL,
    [REGION_CODE] SMALLINT NOT NULL,
    [DISTRICT_CODE] SMALLINT NOT NULL,
    [PROPERTY_TENURE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_AREA_UNIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [SURPLUS_DECLARATION_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_DATA_SOURCE_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [PROPERTY_DATA_SOURCE_EFFECTIVE_DATE] DATE NOT NULL,
    [NAME] NVARCHAR(250),
    [DESCRIPTION] NVARCHAR(2000),
    [PID] INTEGER NOT NULL,
    [PIN] INTEGER,
    [LAND_AREA] REAL NOT NULL,
    [LAND_LEGAL_DESCRIPTION] NVARCHAR(max),
    [BOUNDARY] GEOMETRY,
    [LOCATION] GEOMETRY,
    [ENCUMBRANCE_REASON] NVARCHAR(500),
    [SURPLUS_DECLARATION_COMMENT] NVARCHAR(2000),
    [SURPLUS_DECLARATION_DATE] DATETIME,
    [IS_OWNED] BIT CONSTRAINT [PRPRTY_IS_OWNED_DEF] DEFAULT CONVERT([bit],(1)) NOT NULL,
    [IS_PROPERTY_OF_INTEREST] BIT CONSTRAINT [PRPRTY_IS_PROPERTY_OF_INTEREST_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [IS_VISIBLE_TO_OTHER_AGENCIES] BIT CONSTRAINT [PRPRTY_IS_VISIBLE_TO_OTHER_AGENCIES_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [IS_SENSITIVE] BIT CONSTRAINT [PRPRTY_IS_SENSITIVE_DEF] DEFAULT CONVERT([bit],(0)) NOT NULL,
    [ZONING] NVARCHAR(50),
    [ZONING_POTENTIAL] NVARCHAR(50),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPRTY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRTY_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRTY_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRTY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPRTY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRTY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPRTY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPRTY_PK] PRIMARY KEY CLUSTERED ([PROPERTY_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_ADDRESS_ID_IDX] ON [dbo].[PIMS_PROPERTY] ([ADDRESS_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_DISTRICT_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([DISTRICT_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROP_MGMT_ORG_ID_IDX] ON [dbo].[PIMS_PROPERTY] ([PROP_MGMT_ORG_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROPERTY_AREA_UNIT_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([PROPERTY_AREA_UNIT_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROPERTY_CLASSIFICATION_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([PROPERTY_CLASSIFICATION_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROPERTY_DATA_SOURCE_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([PROPERTY_DATA_SOURCE_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROPERTY_MANAGER_ID_IDX] ON [dbo].[PIMS_PROPERTY] ([PROPERTY_MANAGER_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROPERTY_STATUS_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([PROPERTY_STATUS_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROPERTY_TENURE_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([PROPERTY_TENURE_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_PROPERTY_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([PROPERTY_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_REGION_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([REGION_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRTY_SURPLUS_DECLARATION_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY] ([SURPLUS_DECLARATION_TYPE_CODE] ASC)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Date the property was officially registered', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'PROPERTY_DATA_SOURCE_EFFECTIVE_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Property name', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'NAME'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Property description', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Property ID', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'PID'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Property number', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'PIN'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Area occupied by property', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'LAND_AREA'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Legal description of property', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'LAND_LEGAL_DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Spatial bundary of land', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'BOUNDARY'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Geospatial location (pin) of property', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'LOCATION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'reason for property encumbreance', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'ENCUMBRANCE_REASON'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Comment regarding the surplus declaration', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'SURPLUS_DECLARATION_COMMENT'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Date the property was declared surplus', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'SURPLUS_DECLARATION_DATE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is the property currently owned?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'IS_OWNED'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is this a property of interest to the Ministry?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'IS_PROPERTY_OF_INTEREST'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is the property visible to other agencies?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'IS_VISIBLE_TO_OTHER_AGENCIES'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Is this a sensitive property?', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'IS_SENSITIVE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Current property zoning', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'ZONING'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Potential property zoning', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY', 'COLUMN', N'ZONING_POTENTIAL'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACTIVITY"                                          */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACTIVITY] (
    [ACTIVITY_ID] BIGINT CONSTRAINT [ACTVTY_ACTIVITY_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ACTIVITY_ID_SEQ] NOT NULL,
    [PROJECT_ID] BIGINT,
    [WORKFLOW_ID] BIGINT,
    [ACTIVITY_MODEL_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ACTVTY_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACTVTY_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACTVTY_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACTVTY_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ACTVTY_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACTVTY_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ACTVTY_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ACTVTY_PK] PRIMARY KEY CLUSTERED ([ACTIVITY_ID])
)
GO


CREATE NONCLUSTERED INDEX [ACTVTY_ACTIVITY_MODEL_ID_IDX] ON [dbo].[PIMS_ACTIVITY] ([ACTIVITY_MODEL_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ACTVTY_PROJECT_ID_IDX] ON [dbo].[PIMS_ACTIVITY] ([PROJECT_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ACTVTY_WORKFLOW_ID_IDX] ON [dbo].[PIMS_ACTIVITY] ([WORKFLOW_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_USER"                                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_USER] (
    [USER_ID] BIGINT CONSTRAINT [USER_USER_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_USER_ID_SEQ] NOT NULL,
    [PERSON_ID] BIGINT NOT NULL,
    [BUSINESS_IDENTIFIER_VALUE] NVARCHAR(30) NOT NULL,
    [GUID_IDENTIFIER_VALUE] UNIQUEIDENTIFIER,
    [POSITION] NVARCHAR(100),
    [NOTE] NVARCHAR(1000),
    [LAST_LOGIN] DATETIME,
    [APPROVED_BY_ID] NVARCHAR(30),
    [ISSUE_DATE] DATETIME NOT NULL,
    [EXPIRY_DATE] DATETIME,
    [IS_DISABLED] BIT CONSTRAINT [USER_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [USER_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [USER_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [USER_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [USER_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [USER_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [USER_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [USER_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [USER_PK] PRIMARY KEY CLUSTERED ([USER_ID])
)
GO


CREATE NONCLUSTERED INDEX [USER_PERSON_ID_IDX] ON [dbo].[PIMS_USER] ([PERSON_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [USER_BUSINESS_IDENTIFIER_VALUE_IDX] ON [dbo].[PIMS_USER] ([BUSINESS_IDENTIFIER_VALUE] ASC)
GO


CREATE NONCLUSTERED INDEX [USER_GUID_IDENTIFIER_VALUE_IDX] ON [dbo].[PIMS_USER] ([GUID_IDENTIFIER_VALUE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROJECT_PROPERTY"                                  */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROJECT_PROPERTY] (
    [PROJECT_PROPERTY_ID] BIGINT CONSTRAINT [PRJPRP_PROJECT_PROPERTY_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROJECT_PROPERTY_ID_SEQ] NOT NULL,
    [PROJECT_ID] BIGINT NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRJPRP_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRJPRP_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRJPRP_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRJPRP_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRJPRP_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRJPRP_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRJPRP_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRJPRP_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRJPRP_PK] PRIMARY KEY CLUSTERED ([PROJECT_PROPERTY_ID]),
    CONSTRAINT [PRJPRP_PROJECT_PROPERTY_TUC] UNIQUE ([PROPERTY_ID], [PROJECT_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRJPRP_PROJECT_ID_IDX] ON [dbo].[PIMS_PROJECT_PROPERTY] ([PROJECT_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRJPRP_PROPERTY_ID_IDX] ON [dbo].[PIMS_PROJECT_PROPERTY] ([PROPERTY_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_ACTIVITY"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_ACTIVITY] (
    [PROPERTY_ACTIVITY_ID] BIGINT CONSTRAINT [PRPACT_PROPERTY_ACTIVITY_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_ACTIVITY_ID_SEQ] NOT NULL,
    [ACTIVITY_ID] BIGINT,
    [PROPERTY_ID] BIGINT,
    [IS_DISABLED] BIT CONSTRAINT [PRPACT_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPACT_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPACT_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPACT_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPACT_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPACT_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPACT_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPACT_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPACT_PK] PRIMARY KEY CLUSTERED ([PROPERTY_ACTIVITY_ID]),
    CONSTRAINT [PRPACT_PROPERTY_ACTIVITY_TUC] UNIQUE ([PROPERTY_ID], [ACTIVITY_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRPACT_ACTIVITY_ID_IDX] ON [dbo].[PIMS_PROPERTY_ACTIVITY] ([ACTIVITY_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPACT_PROPERTY_ID_IDX] ON [dbo].[PIMS_PROPERTY_ACTIVITY] ([PROPERTY_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_USER_ORGANIZATION"                                 */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_USER_ORGANIZATION] (
    [USER_ORGANIZATION_ID] BIGINT CONSTRAINT [USRORG_USER_ORGANIZATION_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_USER_ORGANIZATION_ID_SEQ] NOT NULL,
    [ORGANIZATION_ID] BIGINT NOT NULL,
    [USER_ID] BIGINT NOT NULL,
    [ROLE_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [USRORG_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [USRORG_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [USRORG_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [USRORG_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [USRORG_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [USRORG_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [USRORG_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [USRORG_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [USRORG_PK] PRIMARY KEY CLUSTERED ([USER_ORGANIZATION_ID]),
    CONSTRAINT [USRORG_USER_ROLE_ORGANIZATION_TUC] UNIQUE ([ORGANIZATION_ID], [USER_ID], [ROLE_ID])
)
GO


CREATE NONCLUSTERED INDEX [USRORG_ORGANIZATION_ID_IDX] ON [dbo].[PIMS_USER_ORGANIZATION] ([ORGANIZATION_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [USRORG_ROLE_ID_IDX] ON [dbo].[PIMS_USER_ORGANIZATION] ([ROLE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [USRORG_USER_ID_IDX] ON [dbo].[PIMS_USER_ORGANIZATION] ([USER_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACCESS_REQUEST"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACCESS_REQUEST] (
    [ACCESS_REQUEST_ID] BIGINT CONSTRAINT [ACRQST_ACCESS_REQUEST_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ACCESS_REQUEST_ID_SEQ] NOT NULL,
    [USER_ID] BIGINT NOT NULL,
    [ROLE_ID] BIGINT,
    [ACCESS_REQUEST_STATUS_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [NOTE] NVARCHAR(max),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ACRQST_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQST_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQST_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQST_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ACRQST_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQST_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ACRQST_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ACRQST_PK] PRIMARY KEY CLUSTERED ([ACCESS_REQUEST_ID])
)
GO


CREATE NONCLUSTERED INDEX [ACRQST_USER_ID_IDX] ON [dbo].[PIMS_ACCESS_REQUEST] ([USER_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ACRQST_ROLE_ID_IDX] ON [dbo].[PIMS_ACCESS_REQUEST] ([ROLE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ACRQST_ACCESS_REQUEST_STATUS_TYPE_CODE_IDX] ON [dbo].[PIMS_ACCESS_REQUEST] ([ACCESS_REQUEST_STATUS_TYPE_CODE] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_ACCESS_REQUEST_ORGANIZATION"                       */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION] (
    [ACCESS_REQUEST_ORGANIZATION_ID] BIGINT CONSTRAINT [ACRQOR_ACCESS_REQUEST_ORGANIZATION_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_ACCESS_REQUEST_ORGANIZATION_ID_SEQ] NOT NULL,
    [ORGANIZATION_ID] BIGINT,
    [ACCESS_REQUEST_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [ACRQOR_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [ACRQOR_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQOR_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQOR_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQOR_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [ACRQOR_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [ACRQOR_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [ACRQOR_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [ACRQOR_PK] PRIMARY KEY CLUSTERED ([ACCESS_REQUEST_ORGANIZATION_ID]),
    CONSTRAINT [ACRQOR_ORGANIZATION_ACCESS_REQUEST_TUC] UNIQUE ([ORGANIZATION_ID], [ACCESS_REQUEST_ID])
)
GO


CREATE NONCLUSTERED INDEX [ACRQOR_ORGANIZATION_ID_IDX] ON [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION] ([ORGANIZATION_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [ACRQOR_ACCESS_REQUEST_ID_IDX] ON [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION] ([ACCESS_REQUEST_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_USER_ROLE"                                         */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_USER_ROLE] (
    [USER_ROLE_ID] BIGINT CONSTRAINT [USERRL_USER_ROLE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_USER_ROLE_ID_SEQ] NOT NULL,
    [USER_ID] BIGINT NOT NULL,
    [ROLE_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [USERRL_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [USERRL_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [USERRL_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [USERRL_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [USERRL_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [USERRL_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [USERRL_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [USERRL_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [USERRL_PK] PRIMARY KEY CLUSTERED ([USER_ROLE_ID]),
    CONSTRAINT [USERRL_USER_ROLE_TUC] UNIQUE ([USER_ID], [ROLE_ID])
)
GO


CREATE NONCLUSTERED INDEX [USERRL_ROLE_ID_IDX] ON [dbo].[PIMS_USER_ROLE] ([ROLE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [USERRL_USER_ID_IDX] ON [dbo].[PIMS_USER_ROLE] ([USER_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_PROPERTY_SERVICE_FILE"                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE] (
    [PROPERTY_PROPERTY_SERVICE_FILE_ID] BIGINT CONSTRAINT [PRPRSF_PROPERTY_PROPERTY_SERVICE_FILE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_PROPERTY_SERVICE_FILE_ID_SEQ] NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [PROPERTY_SERVICE_FILE_ID] BIGINT NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRPRSF_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPRSF_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRSF_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRSF_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRSF_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPRSF_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPRSF_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPRSF_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPRSF_PK] PRIMARY KEY CLUSTERED ([PROPERTY_PROPERTY_SERVICE_FILE_ID]),
    CONSTRAINT [PRPRSF_PROPERTY_SERVICE_FILE_TUC] UNIQUE ([PROPERTY_ID], [PROPERTY_SERVICE_FILE_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRPRSF_PROPERTY_ID_IDX] ON [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE] ([PROPERTY_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPRSF_PROPERTY_SERVICE_FILE_ID_IDX] ON [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE] ([PROPERTY_SERVICE_FILE_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_ORGANIZATION"                             */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_ORGANIZATION] (
    [PROPERTY_ORGANIZATION_ID] BIGINT CONSTRAINT [PRPORG_PROPERTY_ORGANIZATION_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_ORGANIZATION_ID_SEQ] NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [ORGANIZATION_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPORG_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPORG_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPORG_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPORG_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPORG_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPORG_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPORG_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [IS_DISABLED] BIT CONSTRAINT [PRPORG_IS_DISABLED_DEF] DEFAULT CONVERT([bit],(0)),
    CONSTRAINT [PRPORG_PK] PRIMARY KEY CLUSTERED ([PROPERTY_ORGANIZATION_ID]),
    CONSTRAINT [PRPORG_PROPERTY_ORGANIZATION_TUC] UNIQUE ([PROPERTY_ID], [ORGANIZATION_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRPORG_ORGANIZATION_ID_IDX] ON [dbo].[PIMS_PROPERTY_ORGANIZATION] ([ORGANIZATION_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPORG_PROPERTY_ID_IDX] ON [dbo].[PIMS_PROPERTY_ORGANIZATION] ([PROPERTY_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_EVALUATION"                               */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_EVALUATION] (
    [PROPERTY_EVALUATION_ID] BIGINT CONSTRAINT [PRPEVL_PROPERTY_EVALUATION_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_EVALUATION_ID_SEQ] NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [EVALUATION_DATE] DATE NOT NULL,
    [KEY] INTEGER NOT NULL,
    [VALUE] MONEY NOT NULL,
    [NOTE] NVARCHAR(1000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPEVL_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPEVL_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPEVL_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPEVL_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPEVL_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPEVL_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPEVL_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPEVL_PK] PRIMARY KEY CLUSTERED ([PROPERTY_EVALUATION_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRPEVL_PROPERTY_ID_IDX] ON [dbo].[PIMS_PROPERTY_EVALUATION] ([PROPERTY_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_LEASE"                                    */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_LEASE] (
    [PROPERTY_LEASE_ID] BIGINT CONSTRAINT [PROPLS_PROPERTY_LEASE_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_LEASE_ID_SEQ] NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [LEASE_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PROPLS_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROPLS_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PROPLS_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [PROPLS_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROPLS_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PROPLS_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [PROPLS_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PROPLS_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PROPLS_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PROPLS_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PROPLS_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PROPLS_PK] PRIMARY KEY CLUSTERED ([PROPERTY_LEASE_ID])
)
GO


CREATE NONCLUSTERED INDEX [PROPLS_LEASE_ID_IDX] ON [dbo].[PIMS_PROPERTY_LEASE] ([LEASE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PROPLS_PROPERTY_ID_IDX] ON [dbo].[PIMS_PROPERTY_LEASE] ([PROPERTY_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_TAX"                                      */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_TAX] (
    [PROPERTY_TAX_ID] BIGINT CONSTRAINT [PRPTAX_PROPERTY_TAX_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_TAX_ID_SEQ] NOT NULL,
    [PROPERTY_ID] BIGINT NOT NULL,
    [PROPERTY_TAX_REMIT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [TAX_FOLIO_NO] NVARCHAR(50) NOT NULL,
    [PAYMENT_AMOUNT] MONEY NOT NULL,
    [LAST_PAYMENT_DATE] DATETIME,
    [PAYMENT_NOTES] MONEY,
    [BCTFA_NOTIFICATION_DATE] DATETIME,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PRPTAX_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTAX_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTAX_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [PRPTAX_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTAX_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTAX_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [PRPTAX_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTAX_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTAX_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PRPTAX_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PRPTAX_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PRPTAX_PK] PRIMARY KEY CLUSTERED ([PROPERTY_TAX_ID])
)
GO


CREATE NONCLUSTERED INDEX [PRPTAX_PROPERTY_ID_IDX] ON [dbo].[PIMS_PROPERTY_TAX] ([PROPERTY_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [PRPTAX_PROPERTY_TAX_REMIT_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY_TAX] ([PROPERTY_TAX_REMIT_TYPE_CODE] ASC)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Property tax folio number', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_TAX', 'COLUMN', N'TAX_FOLIO_NO'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_PROPERTY_IMPROVEMENT"                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_PROPERTY_IMPROVEMENT] (
    [PROPERTY_IMPROVEMENT_ID] BIGINT CONSTRAINT [PIMPRV_PROPERTY_IMPROVEMENT_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_PROPERTY_IMPROVEMENT_ID_SEQ] NOT NULL,
    [PROPERTY_LEASE_ID] BIGINT NOT NULL,
    [PROPERTY_IMPROVEMENT_TYPE_CODE] NVARCHAR(20) NOT NULL,
    [IMPROVEMENT_DESCRIPTION] NVARCHAR(2000) NOT NULL,
    [STRUCTURE_SIZE] NVARCHAR(2000),
    [UNIT] NVARCHAR(2000),
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [PIMPRV_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PIMPRV_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PIMPRV_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [PIMPRV_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PIMPRV_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PIMPRV_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [PIMPRV_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [PIMPRV_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [PIMPRV_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [PIMPRV_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [PIMPRV_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [PIMPRV_PK] PRIMARY KEY CLUSTERED ([PROPERTY_IMPROVEMENT_ID])
)
GO


CREATE NONCLUSTERED INDEX [PIMPRV_PROPERTY_IMPROVEMENT_TYPE_CODE_IDX] ON [dbo].[PIMS_PROPERTY_IMPROVEMENT] ([PROPERTY_IMPROVEMENT_TYPE_CODE] ASC)
GO


CREATE NONCLUSTERED INDEX [PIMPRV_PROPERTY_LEASE_ID_IDX] ON [dbo].[PIMS_PROPERTY_IMPROVEMENT] ([PROPERTY_LEASE_ID] ASC)
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of property improvements associated with the lease.', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT', NULL, NULL
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Description of the improvements', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT', 'COLUMN', N'IMPROVEMENT_DESCRIPTION'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Size of the structure (house, building, bridge, etc,) ', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT', 'COLUMN', N'STRUCTURE_SIZE'
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'Unit(s) affected', 'SCHEMA', N'dbo', 'TABLE', N'PIMS_PROPERTY_IMPROVEMENT', 'COLUMN', N'UNIT'
GO


/* ---------------------------------------------------------------------- */
/* Add table "dbo.PIMS_TASK"                                              */
/* ---------------------------------------------------------------------- */

CREATE TABLE [dbo].[PIMS_TASK] (
    [TASK_ID] BIGINT CONSTRAINT [TASK_TASK_ID_DEF] DEFAULT NEXT VALUE FOR [PIMS_TASK_ID_SEQ] NOT NULL,
    [TASK_TEMPLATE_ID] BIGINT NOT NULL,
    [ACTIVITY_ID] BIGINT,
    [USER_ID] BIGINT NOT NULL,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [TASK_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TASK_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TASK_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TASK_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TASK_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TASK_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TASK_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [TASK_PK] PRIMARY KEY CLUSTERED ([TASK_ID]),
    CONSTRAINT [TASK_TEMPLATE_ACTIVITY_USER_TUC] UNIQUE ([USER_ID], [ACTIVITY_ID], [TASK_TEMPLATE_ID])
)
GO


CREATE NONCLUSTERED INDEX [TASK_ACTIVITY_ID_IDX] ON [dbo].[PIMS_TASK] ([ACTIVITY_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [TASK_TASK_TEMPLATE_ID_IDX] ON [dbo].[PIMS_TASK] ([TASK_TEMPLATE_ID] ASC)
GO


CREATE NONCLUSTERED INDEX [TASK_USER_ID_IDX] ON [dbo].[PIMS_TASK] ([USER_ID] ASC)
GO


/* ---------------------------------------------------------------------- */
/* Add foreign key constraints                                            */
/* ---------------------------------------------------------------------- */

ALTER TABLE [dbo].[PIMS_PROJECT] ADD CONSTRAINT [PIM_PRJTYP_PIM_PROJCT_FK] 
    FOREIGN KEY ([PROJECT_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROJECT_TYPE] ([PROJECT_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROJECT] ADD CONSTRAINT [PIM_PRJSTY_PIM_PROJCT_FK] 
    FOREIGN KEY ([PROJECT_STATUS_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROJECT_STATUS_TYPE] ([PROJECT_STATUS_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROJECT] ADD CONSTRAINT [PIM_PRJRSK_PIM_PROJCT_FK] 
    FOREIGN KEY ([PROJECT_RISK_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROJECT_RISK_TYPE] ([PROJECT_RISK_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROJECT] ADD CONSTRAINT [PIM_PROJTR_PIM_PROJCT_FK] 
    FOREIGN KEY ([PROJECT_TIER_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROJECT_TIER_TYPE] ([PROJECT_TIER_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_PRPTYP_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROPERTY_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_TYPE] ([PROPERTY_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_ADDRSS_PIM_PRPRTY_FK] 
    FOREIGN KEY ([ADDRESS_ID]) REFERENCES [dbo].[PIMS_ADDRESS] ([ADDRESS_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_REGION_PIM_PRPRTY_FK] 
    FOREIGN KEY ([REGION_CODE]) REFERENCES [dbo].[PIMS_REGION] ([REGION_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_DSTRCT_PIM_PRPRTY_FK] 
    FOREIGN KEY ([DISTRICT_CODE]) REFERENCES [dbo].[PIMS_DISTRICT] ([DISTRICT_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_PRPCLT_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROPERTY_CLASSIFICATION_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_CLASSIFICATION_TYPE] ([PROPERTY_CLASSIFICATION_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_PRPTNR_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROPERTY_TENURE_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_TENURE_TYPE] ([PROPERTY_TENURE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_ARUNIT_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROPERTY_AREA_UNIT_TYPE_CODE]) REFERENCES [dbo].[PIMS_AREA_UNIT_TYPE] ([AREA_UNIT_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_PRPSTS_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROPERTY_STATUS_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_STATUS_TYPE] ([PROPERTY_STATUS_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_PIDSRT_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROPERTY_DATA_SOURCE_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_DATA_SOURCE_TYPE] ([PROPERTY_DATA_SOURCE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_SPDCLT_PIM_PRPRTY_FK] 
    FOREIGN KEY ([SURPLUS_DECLARATION_TYPE_CODE]) REFERENCES [dbo].[PIMS_SURPLUS_DECLARATION_TYPE] ([SURPLUS_DECLARATION_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_PERSON_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROPERTY_MANAGER_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY] ADD CONSTRAINT [PIM_ORG_PIM_PRPRTY_FK] 
    FOREIGN KEY ([PROP_MGMT_ORG_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_ACTIVITY] ADD CONSTRAINT [PIM_PROJCT_PIM_ACTVTY_FK] 
    FOREIGN KEY ([PROJECT_ID]) REFERENCES [dbo].[PIMS_PROJECT] ([PROJECT_ID])
GO


ALTER TABLE [dbo].[PIMS_ACTIVITY] ADD CONSTRAINT [PIM_PRWKMD_PIM_ACTVTY_FK] 
    FOREIGN KEY ([WORKFLOW_ID]) REFERENCES [dbo].[PIMS_PROJECT_WORKFLOW_MODEL] ([PROJECT_WORKFLOW_MODEL_ID])
GO


ALTER TABLE [dbo].[PIMS_ACTIVITY] ADD CONSTRAINT [PIM_ACTMDL_PIM_ACTVTY_FK] 
    FOREIGN KEY ([ACTIVITY_MODEL_ID]) REFERENCES [dbo].[PIMS_ACTIVITY_MODEL] ([ACTIVITY_MODEL_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_SERVICE_FILE] ADD CONSTRAINT [PIM_PRSVFT_PIM_PRPSVC_FK] 
    FOREIGN KEY ([PROPERTY_SERVICE_FILE_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_SERVICE_FILE_TYPE] ([PROPERTY_SERVICE_FILE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_TASK] ADD CONSTRAINT [PIM_TSKTMP_PIM_TASK_FK] 
    FOREIGN KEY ([TASK_TEMPLATE_ID]) REFERENCES [dbo].[PIMS_TASK_TEMPLATE] ([TASK_TEMPLATE_ID])
GO


ALTER TABLE [dbo].[PIMS_TASK] ADD CONSTRAINT [PIM_ACTVTY_PIM_TASK_FK] 
    FOREIGN KEY ([ACTIVITY_ID]) REFERENCES [dbo].[PIMS_ACTIVITY] ([ACTIVITY_ID])
GO


ALTER TABLE [dbo].[PIMS_TASK] ADD CONSTRAINT [PIM_USER_PIM_TASK_FK] 
    FOREIGN KEY ([USER_ID]) REFERENCES [dbo].[PIMS_USER] ([USER_ID])
GO


ALTER TABLE [dbo].[PIMS_TASK_TEMPLATE] ADD CONSTRAINT [PIM_TSKTMT_PIM_TSKTMP_FK] 
    FOREIGN KEY ([TASK_TEMPLATE_TYPE_CODE]) REFERENCES [dbo].[PIMS_TASK_TEMPLATE_TYPE] ([TASK_TEMPLATE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_USER] ADD CONSTRAINT [PIM_PERSON_PIM_USER_FK] 
    FOREIGN KEY ([PERSON_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_PROJECT_WORKFLOW_MODEL] ADD CONSTRAINT [PIM_WFLMDL_PIM_PRWKMD_FK] 
    FOREIGN KEY ([WORKFLOW_MODEL_ID]) REFERENCES [dbo].[PIMS_WORKFLOW_MODEL] ([WORKFLOW_MODEL_ID])
GO


ALTER TABLE [dbo].[PIMS_PROJECT_WORKFLOW_MODEL] ADD CONSTRAINT [PIM_PROJCT_PIM_PRWKMD_FK] 
    FOREIGN KEY ([PROJECT_ID]) REFERENCES [dbo].[PIMS_PROJECT] ([PROJECT_ID])
GO


ALTER TABLE [dbo].[PIMS_PROJECT_PROPERTY] ADD CONSTRAINT [PIM_PRPRTY_PIM_PRJPRP_FK] 
    FOREIGN KEY ([PROPERTY_ID]) REFERENCES [dbo].[PIMS_PROPERTY] ([PROPERTY_ID])
GO


ALTER TABLE [dbo].[PIMS_PROJECT_PROPERTY] ADD CONSTRAINT [PIM_PROJCT_PIM_PRJPRP_FK] 
    FOREIGN KEY ([PROJECT_ID]) REFERENCES [dbo].[PIMS_PROJECT] ([PROJECT_ID])
GO


ALTER TABLE [dbo].[PIMS_WORKFLOW_MODEL] ADD CONSTRAINT [PIM_WFLMDT_PIM_WFLMDL_FK] 
    FOREIGN KEY ([WORKFLOW_MODEL_TYPE_CODE]) REFERENCES [dbo].[PIMS_WORKFLOW_MODEL_TYPE] ([WORKFLOW_MODEL_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_ACTIVITY] ADD CONSTRAINT [PIM_ACTVTY_PIM_PRPACT_FK] 
    FOREIGN KEY ([ACTIVITY_ID]) REFERENCES [dbo].[PIMS_ACTIVITY] ([ACTIVITY_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_ACTIVITY] ADD CONSTRAINT [PIM_PRPRTY_PIM_PRPACT_FK] 
    FOREIGN KEY ([PROPERTY_ID]) REFERENCES [dbo].[PIMS_PROPERTY] ([PROPERTY_ID])
GO


ALTER TABLE [dbo].[PIMS_ADDRESS] ADD CONSTRAINT [PIM_DSTRCT_PIM_ADDRSS_FK] 
    FOREIGN KEY ([DISTRICT_CODE]) REFERENCES [dbo].[PIMS_DISTRICT] ([DISTRICT_CODE])
GO


ALTER TABLE [dbo].[PIMS_ADDRESS] ADD CONSTRAINT [PIM_REGION_PIM_ADDRSS_FK] 
    FOREIGN KEY ([REGION_CODE]) REFERENCES [dbo].[PIMS_REGION] ([REGION_CODE])
GO


ALTER TABLE [dbo].[PIMS_ADDRESS] ADD CONSTRAINT [PIM_ADUSGT_PIM_ADDRSS_FK] 
    FOREIGN KEY ([ADDRESS_USAGE_TYPE_CODE]) REFERENCES [dbo].[PIMS_ADDRESS_USAGE_TYPE] ([ADDRESS_USAGE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_ADDRESS] ADD CONSTRAINT [PIM_PROVNC_PIM_ADDRSS_FK] 
    FOREIGN KEY ([PROVINCE_STATE_ID]) REFERENCES [dbo].[PIMS_PROVINCE_STATE] ([PROVINCE_STATE_ID])
GO


ALTER TABLE [dbo].[PIMS_ADDRESS] ADD CONSTRAINT [PIM_CNTRY_PIM_ADDRSS_FK] 
    FOREIGN KEY ([COUNTRY_ID]) REFERENCES [dbo].[PIMS_COUNTRY] ([COUNTRY_ID])
GO


ALTER TABLE [dbo].[PIMS_DISTRICT] ADD CONSTRAINT [PIM_REGION_PIM_DSTRCT_FK] 
    FOREIGN KEY ([REGION_CODE]) REFERENCES [dbo].[PIMS_REGION] ([REGION_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROVINCE_STATE] ADD CONSTRAINT [PIM_CNTRY_PIM_PROVNC_FK] 
    FOREIGN KEY ([COUNTRY_ID]) REFERENCES [dbo].[PIMS_COUNTRY] ([COUNTRY_ID])
GO


ALTER TABLE [dbo].[PIMS_ORGANIZATION] ADD CONSTRAINT [PIM_ADDRSS_PIM_ORG_FK] 
    FOREIGN KEY ([ADDRESS_ID]) REFERENCES [dbo].[PIMS_ADDRESS] ([ADDRESS_ID])
GO


ALTER TABLE [dbo].[PIMS_ORGANIZATION] ADD CONSTRAINT [PIM_ORGTYP_PIM_ORG_FK] 
    FOREIGN KEY ([ORGANIZATION_TYPE_CODE]) REFERENCES [dbo].[PIMS_ORGANIZATION_TYPE] ([ORGANIZATION_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_ORGANIZATION] ADD CONSTRAINT [PIM_ORG_PIM_PRNT_ORG_FK] 
    FOREIGN KEY ([PRNT_ORGANIZATION_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_ORGANIZATION] ADD CONSTRAINT [PIM_DSTRCT_PIM_ORG_FK] 
    FOREIGN KEY ([DISTRICT_CODE]) REFERENCES [dbo].[PIMS_DISTRICT] ([DISTRICT_CODE])
GO


ALTER TABLE [dbo].[PIMS_ORGANIZATION] ADD CONSTRAINT [PIM_REGION_PIM_ORG_FK] 
    FOREIGN KEY ([REGION_CODE]) REFERENCES [dbo].[PIMS_REGION] ([REGION_CODE])
GO


ALTER TABLE [dbo].[PIMS_ORGANIZATION] ADD CONSTRAINT [PIM_ORGIDT_PIM_ORG_FK] 
    FOREIGN KEY ([ORG_IDENTIFIER_TYPE_CODE]) REFERENCES [dbo].[PIMS_ORG_IDENTIFIER_TYPE] ([ORG_IDENTIFIER_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_USER_ORGANIZATION] ADD CONSTRAINT [PIM_USER_PIM_USRORG_FK] 
    FOREIGN KEY ([USER_ID]) REFERENCES [dbo].[PIMS_USER] ([USER_ID])
GO


ALTER TABLE [dbo].[PIMS_USER_ORGANIZATION] ADD CONSTRAINT [PIM_ORG_PIM_USRORG_FK] 
    FOREIGN KEY ([ORGANIZATION_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_USER_ORGANIZATION] ADD CONSTRAINT [PIM_ROLE_PIM_USRORG_FK] 
    FOREIGN KEY ([ROLE_ID]) REFERENCES [dbo].[PIMS_ROLE] ([ROLE_ID])
GO


ALTER TABLE [dbo].[PIMS_ROLE_CLAIM] ADD CONSTRAINT [PIM_CLMTYP_PIM_ROLCLM_FK] 
    FOREIGN KEY ([CLAIM_ID]) REFERENCES [dbo].[PIMS_CLAIM] ([CLAIM_ID])
GO


ALTER TABLE [dbo].[PIMS_ROLE_CLAIM] ADD CONSTRAINT [PIM_ROLE_PIM_ROLCLM_FK] 
    FOREIGN KEY ([ROLE_ID]) REFERENCES [dbo].[PIMS_ROLE] ([ROLE_ID])
GO


ALTER TABLE [dbo].[PIMS_PERSON] ADD CONSTRAINT [PIM_ADDRSS_PIM_PERSON_FK] 
    FOREIGN KEY ([ADDRESS_ID]) REFERENCES [dbo].[PIMS_ADDRESS] ([ADDRESS_ID])
GO


ALTER TABLE [dbo].[PIMS_PERSON_ORGANIZATION] ADD CONSTRAINT [PIM_PERSON_PIM_PERORG_FK] 
    FOREIGN KEY ([PERSON_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_PERSON_ORGANIZATION] ADD CONSTRAINT [PIM_ORG_PIM_PERORG_FK] 
    FOREIGN KEY ([ORGANIZATION_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_ACCESS_REQUEST] ADD CONSTRAINT [PIM_USER_PIM_ACRQST_FK] 
    FOREIGN KEY ([USER_ID]) REFERENCES [dbo].[PIMS_USER] ([USER_ID])
GO


ALTER TABLE [dbo].[PIMS_ACCESS_REQUEST] ADD CONSTRAINT [PIM_ARQSTT_PIM_ACRQST_FK] 
    FOREIGN KEY ([ACCESS_REQUEST_STATUS_TYPE_CODE]) REFERENCES [dbo].[PIMS_ACCESS_REQUEST_STATUS_TYPE] ([ACCESS_REQUEST_STATUS_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_ACCESS_REQUEST] ADD CONSTRAINT [PIM_ROLE_PIM_ACRQST_FK] 
    FOREIGN KEY ([ROLE_ID]) REFERENCES [dbo].[PIMS_ROLE] ([ROLE_ID])
GO


ALTER TABLE [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION] ADD CONSTRAINT [PIM_ORG_PIM_ACRQOR_FK] 
    FOREIGN KEY ([ORGANIZATION_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION] ADD CONSTRAINT [PIM_ACRQST_PIM_ACRQOR_FK] 
    FOREIGN KEY ([ACCESS_REQUEST_ID]) REFERENCES [dbo].[PIMS_ACCESS_REQUEST] ([ACCESS_REQUEST_ID])
GO


ALTER TABLE [dbo].[PIMS_PROJECT_NOTE] ADD CONSTRAINT [PIM_PROJCT_PIM_PROJNT_FK] 
    FOREIGN KEY ([PROJECT_ID]) REFERENCES [dbo].[PIMS_PROJECT] ([PROJECT_ID])
GO


ALTER TABLE [dbo].[PIMS_USER_ROLE] ADD CONSTRAINT [PIM_USER_PIM_USERRL_FK] 
    FOREIGN KEY ([USER_ID]) REFERENCES [dbo].[PIMS_USER] ([USER_ID])
GO


ALTER TABLE [dbo].[PIMS_USER_ROLE] ADD CONSTRAINT [PIM_ROLE_PIM_USERRL_FK] 
    FOREIGN KEY ([ROLE_ID]) REFERENCES [dbo].[PIMS_ROLE] ([ROLE_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE] ADD CONSTRAINT [PIM_PRPRTY_PIM_PRPRSF_FK] 
    FOREIGN KEY ([PROPERTY_ID]) REFERENCES [dbo].[PIMS_PROPERTY] ([PROPERTY_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE] ADD CONSTRAINT [PIM_PRPSVC_PIM_PRPRSF_FK] 
    FOREIGN KEY ([PROPERTY_SERVICE_FILE_ID]) REFERENCES [dbo].[PIMS_PROPERTY_SERVICE_FILE] ([PROPERTY_SERVICE_FILE_ID])
GO


ALTER TABLE [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL] ADD CONSTRAINT [PIM_TSKTMP_PIM_TSKTAM_FK] 
    FOREIGN KEY ([TASK_TEMPLATE_ID]) REFERENCES [dbo].[PIMS_TASK_TEMPLATE] ([TASK_TEMPLATE_ID])
GO


ALTER TABLE [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL] ADD CONSTRAINT [PIM_ACTMDL_PIM_TSKTAM_FK] 
    FOREIGN KEY ([ACTIVITY_MODEL_ID]) REFERENCES [dbo].[PIMS_ACTIVITY_MODEL] ([ACTIVITY_MODEL_ID])
GO


ALTER TABLE [dbo].[PIMS_CONTACT_METHOD] ADD CONSTRAINT [PIM_CNTMTT_PIM_CNTMTH_FK] 
    FOREIGN KEY ([CONTACT_METHOD_TYPE_CODE]) REFERENCES [dbo].[PIMS_CONTACT_METHOD_TYPE] ([CONTACT_METHOD_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_CONTACT_METHOD] ADD CONSTRAINT [PIM_PERSON_PIM_CNTMTH_FK] 
    FOREIGN KEY ([PERSON_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_CONTACT_METHOD] ADD CONSTRAINT [PIM_ORG_PIM_CNTMTH_FK] 
    FOREIGN KEY ([ORGANIZATION_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_ORGANIZATION] ADD CONSTRAINT [PIM_PRPRTY_PIM_PRPORG_FK] 
    FOREIGN KEY ([PROPERTY_ID]) REFERENCES [dbo].[PIMS_PROPERTY] ([PROPERTY_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_ORGANIZATION] ADD CONSTRAINT [PIM_ORG_PIM_PRPORG_FK] 
    FOREIGN KEY ([ORGANIZATION_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_EVALUATION] ADD CONSTRAINT [PIM_PRPRTY_PIM_PRPEVL_FK] 
    FOREIGN KEY ([PROPERTY_ID]) REFERENCES [dbo].[PIMS_PROPERTY] ([PROPERTY_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LSPRGT_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_PROGRAM_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_PROGRAM_TYPE] ([LEASE_PROGRAM_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LELIST_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_LICENSE_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_LICENSE_TYPE] ([LEASE_LICENSE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LSPRTY_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_PAY_RVBL_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_PAY_RVBL_TYPE] ([LEASE_PAY_RVBL_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LSCATT_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_CATEGORY_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_CATEGORY_TYPE] ([LEASE_CATEGORY_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LPRPTY_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_PURPOSE_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_PURPOSE_TYPE] ([LEASE_PURPOSE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_PERSON_PIM_LEASE_FK] 
    FOREIGN KEY ([MOTI_NAME_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LINITT_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_INITIATOR_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_INITIATOR_TYPE] ([LEASE_INITIATOR_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LRESPT_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_RESPONSIBILITY_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_RESPONSIBILITY_TYPE] ([LEASE_RESPONSIBILITY_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE] ADD CONSTRAINT [PIM_LSPMTF_PIM_LEASE_FK] 
    FOREIGN KEY ([LEASE_PMT_FREQ_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_PMT_FREQ_TYPE] ([LEASE_PMT_FREQ_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_LEASE] ADD CONSTRAINT [PIM_PRPRTY_PIM_PROPLS_FK] 
    FOREIGN KEY ([PROPERTY_ID]) REFERENCES [dbo].[PIMS_PROPERTY] ([PROPERTY_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_LEASE] ADD CONSTRAINT [PIM_LEASE_PIM_PROPLS_FK] 
    FOREIGN KEY ([LEASE_ID]) REFERENCES [dbo].[PIMS_LEASE] ([LEASE_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_TENANT] ADD CONSTRAINT [PIM_LSSRTY_PIM_TENANT_FK] 
    FOREIGN KEY ([LESSOR_TYPE_CODE]) REFERENCES [dbo].[PIMS_LESSOR_TYPE] ([LESSOR_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE_TENANT] ADD CONSTRAINT [PIM_LEASE_PIM_TENANT_FK] 
    FOREIGN KEY ([LEASE_ID]) REFERENCES [dbo].[PIMS_LEASE] ([LEASE_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_TENANT] ADD CONSTRAINT [PIM_ORG_PIM_TENANT_FK] 
    FOREIGN KEY ([ORGANIZATION_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_TENANT] ADD CONSTRAINT [PIM_PERSON_PIM_TENANT_FK] 
    FOREIGN KEY ([PERSON_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_INSURANCE] ADD CONSTRAINT [PIM_LEASE_PIM_INSRNC_FK] 
    FOREIGN KEY ([LEASE_ID]) REFERENCES [dbo].[PIMS_LEASE] ([LEASE_ID])
GO


ALTER TABLE [dbo].[PIMS_INSURANCE] ADD CONSTRAINT [PIM_ORG_PIM_INSRNC_FK] 
    FOREIGN KEY ([INSURER_ORG_ID]) REFERENCES [dbo].[PIMS_ORGANIZATION] ([ORGANIZATION_ID])
GO


ALTER TABLE [dbo].[PIMS_INSURANCE] ADD CONSTRAINT [PIM_PERSON_PIM_INSRNC_INSURER_CONTACT_FK] 
    FOREIGN KEY ([INSURER_CONTACT_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_INSURANCE] ADD CONSTRAINT [PIM_INSPAY_PIM_INSRNC_FK] 
    FOREIGN KEY ([INSURANCE_PAYEE_TYPE_CODE]) REFERENCES [dbo].[PIMS_INSURANCE_PAYEE_TYPE] ([INSURANCE_PAYEE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_INSURANCE] ADD CONSTRAINT [PIM_PERSON_PIM_INSRNCMOTI_CONTACT_FK] 
    FOREIGN KEY ([MOTI_RISK_MGMT_CONTACT_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_INSURANCE] ADD CONSTRAINT [PIM_PERSON_PIM_INSRNC_BCTFA_CONTACT_FK] 
    FOREIGN KEY ([BCTFA_RISK_MGMT_CONTACT_ID]) REFERENCES [dbo].[PIMS_PERSON] ([PERSON_ID])
GO


ALTER TABLE [dbo].[PIMS_INSURANCE] ADD CONSTRAINT [PIM_INSPYT_PIM_INSRNC_FK] 
    FOREIGN KEY ([INSURANCE_TYPE_CODE]) REFERENCES [dbo].[PIMS_INSURANCE_TYPE] ([INSURANCE_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_SECURITY_DEPOSIT] ADD CONSTRAINT [PIM_LEASE_PIM_SECDEP_FK] 
    FOREIGN KEY ([LEASE_ID]) REFERENCES [dbo].[PIMS_LEASE] ([LEASE_ID])
GO


ALTER TABLE [dbo].[PIMS_SECURITY_DEPOSIT] ADD CONSTRAINT [PIM_SCHLDT_PIM_SECDEP_FK] 
    FOREIGN KEY ([SEC_DEP_HOLDER_TYPE_CODE]) REFERENCES [dbo].[PIMS_SEC_DEP_HOLDER_TYPE] ([SEC_DEP_HOLDER_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_SECURITY_DEPOSIT] ADD CONSTRAINT [PIM_SECDPT_PIM_SECDEP_FK] 
    FOREIGN KEY ([SECURITY_DEPOSIT_TYPE_CODE]) REFERENCES [dbo].[PIMS_SECURITY_DEPOSIT_TYPE] ([SECURITY_DEPOSIT_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_TAX] ADD CONSTRAINT [PIM_PTRMTT_PIM_PRPTAX_FK] 
    FOREIGN KEY ([PROPERTY_TAX_REMIT_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_TAX_REMIT_TYPE] ([PROPERTY_TAX_REMIT_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_TAX] ADD CONSTRAINT [PIM_PRPRTY_PIM_PRPTAX_FK] 
    FOREIGN KEY ([PROPERTY_ID]) REFERENCES [dbo].[PIMS_PROPERTY] ([PROPERTY_ID])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_IMPROVEMENT] ADD CONSTRAINT [PIM_PIMPRT_PIM_PIMPRV_FK] 
    FOREIGN KEY ([PROPERTY_IMPROVEMENT_TYPE_CODE]) REFERENCES [dbo].[PIMS_PROPERTY_IMPROVEMENT_TYPE] ([PROPERTY_IMPROVEMENT_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_PROPERTY_IMPROVEMENT] ADD CONSTRAINT [PIM_PROPLS_PIM_PIMPRV_FK] 
    FOREIGN KEY ([PROPERTY_LEASE_ID]) REFERENCES [dbo].[PIMS_PROPERTY_LEASE] ([PROPERTY_LEASE_ID])
GO


ALTER TABLE [dbo].[PIMS_SECURITY_DEPOSIT_RETURN] ADD CONSTRAINT [PIM_SECDPT_PIM_SDRTRN_FK] 
    FOREIGN KEY ([SECURITY_DEPOSIT_TYPE_CODE]) REFERENCES [dbo].[PIMS_SECURITY_DEPOSIT_TYPE] ([SECURITY_DEPOSIT_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_SECURITY_DEPOSIT_RETURN] ADD CONSTRAINT [PIM_LEASE_PIM_SDRTRN_FK] 
    FOREIGN KEY ([LEASE_ID]) REFERENCES [dbo].[PIMS_LEASE] ([LEASE_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_TERM] ADD CONSTRAINT [PIM_LEASE_PIM_LSTERM_FK] 
    FOREIGN KEY ([LEASE_ID]) REFERENCES [dbo].[PIMS_LEASE] ([LEASE_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_TERM] ADD CONSTRAINT [PIM_LTRMST_PIM_LSTERM_FK] 
    FOREIGN KEY ([LEASE_TERM_STATUS_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_TERM_STATUS_TYPE] ([LEASE_TERM_STATUS_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE_PAYMENT_FORECAST] ADD CONSTRAINT [PIM_LPYPER_PIM_LPFCST_FK] 
    FOREIGN KEY ([LEASE_PAYMENT_PERIOD_ID]) REFERENCES [dbo].[PIMS_LEASE_PAYMENT_PERIOD] ([LEASE_PAYMENT_PERIOD_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_PAYMENT_FORECAST] ADD CONSTRAINT [PIM_LSTERM_PIM_LPFCST_FK] 
    FOREIGN KEY ([LEASE_TERM_ID]) REFERENCES [dbo].[PIMS_LEASE_TERM] ([LEASE_TERM_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_PAYMENT_FORECAST] ADD CONSTRAINT [PIM_LPSTST_PIM_LPFCST_FK] 
    FOREIGN KEY ([LEASE_PAYMENT_STATUS_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_PAYMENT_STATUS_TYPE] ([LEASE_PAYMENT_STATUS_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE_PAYMENT] ADD CONSTRAINT [PIM_LSPMMT_PIM_LSPYMT_FK] 
    FOREIGN KEY ([LEASE_PAYMENT_METHOD_TYPE_CODE]) REFERENCES [dbo].[PIMS_LEASE_PAYMENT_METHOD_TYPE] ([LEASE_PAYMENT_METHOD_TYPE_CODE])
GO


ALTER TABLE [dbo].[PIMS_LEASE_PAYMENT] ADD CONSTRAINT [PIM_LPYPER_PIM_LSPYMT_FK] 
    FOREIGN KEY ([LEASE_PAYMENT_PERIOD_ID]) REFERENCES [dbo].[PIMS_LEASE_PAYMENT_PERIOD] ([LEASE_PAYMENT_PERIOD_ID])
GO


ALTER TABLE [dbo].[PIMS_LEASE_PAYMENT] ADD CONSTRAINT [PIM_LSTERM_PIM_LSPYMT_FK] 
    FOREIGN KEY ([LEASE_TERM_ID]) REFERENCES [dbo].[PIMS_LEASE_TERM] ([LEASE_TERM_ID])
GO


/* ---------------------------------------------------------------------- */
/* Add views                                                              */
/* ---------------------------------------------------------------------- */

/* ---------------------------------------------------------------------- */
/* Add views                                                              */
/* ---------------------------------------------------------------------- */

CREATE VIEW [dbo].[PIMS_PROPERTY_BOUNDARY_VW] AS
SELECT PROP.PROPERTY_ID
     , PROP.PID
     , RIGHT('000000000' + CAST(PROP.PID AS VARCHAR(9)), 9) AS PID_PADDED
     , PROP.PIN
     , PROP.PROPERTY_TYPE_CODE
     , PROP.PROPERTY_STATUS_TYPE_CODE
     , PROP.PROPERTY_DATA_SOURCE_TYPE_CODE
     , PROP.PROPERTY_DATA_SOURCE_EFFECTIVE_DATE
     , PROP.PROPERTY_CLASSIFICATION_TYPE_CODE
     , PROP.PROPERTY_TENURE_TYPE_CODE
     , ADDR.STREET_ADDRESS_1
     , ADDR.STREET_ADDRESS_2
     , ADDR.STREET_ADDRESS_3
     , ADDR.MUNICIPALITY_NAME
     , ADDR.POSTAL_CODE
     , PROV.PROVINCE_STATE_CODE
     , PROV.DESCRIPTION AS PROVINCE_NAME
     , CNTY.COUNTRY_CODE
     , CNTY.DESCRIPTION AS COUNTRY_NAME
     , PROP.NAME
     , PROP.DESCRIPTION
     , PROP.ADDRESS_ID
     , PROP.REGION_CODE
     , PROP.DISTRICT_CODE
     , PROP.BOUNDARY AS GEOMETRY
     , PROP.PROPERTY_AREA_UNIT_TYPE_CODE
     , PROP.LAND_AREA
     , PROP.LAND_LEGAL_DESCRIPTION
     , PROP.ENCUMBRANCE_REASON
     , PROP.IS_SENSITIVE
     , PROP.IS_OWNED
     , PROP.IS_PROPERTY_OF_INTEREST
     , PROP.IS_VISIBLE_TO_OTHER_AGENCIES
     , PROP.ZONING,ZONING_POTENTIAL
FROM   PIMS_PROPERTY       PROP                                                    INNER JOIN
       PIMS_ADDRESS        ADDR ON ADDR.ADDRESS_ID        = PROP.ADDRESS_ID        INNER JOIN
       PIMS_PROVINCE_STATE PROV ON PROV.PROVINCE_STATE_ID = ADDR.PROVINCE_STATE_ID INNER JOIN
       PIMS_COUNTRY        CNTY ON CNTY.COUNTRY_ID        = ADDR.COUNTRY_ID
GO


CREATE VIEW [dbo].[PIMS_PROPERTY_LOCATION_VW] AS
SELECT PROP.PROPERTY_ID              
     , PROP.PID
     , RIGHT('000000000' + CAST(PROP.PID AS VARCHAR(9)), 9) AS PID_PADDED
     , PROP.PIN                   
     , PROP.PROPERTY_TYPE_CODE
     , PROP.PROPERTY_STATUS_TYPE_CODE
     , PROP.PROPERTY_DATA_SOURCE_TYPE_CODE
     , PROP.PROPERTY_DATA_SOURCE_EFFECTIVE_DATE
     , PROP.PROPERTY_CLASSIFICATION_TYPE_CODE
     , PROP.PROPERTY_TENURE_TYPE_CODE
     , ADDR.STREET_ADDRESS_1
     , ADDR.STREET_ADDRESS_2
     , ADDR.STREET_ADDRESS_3
     , ADDR.MUNICIPALITY_NAME
     , ADDR.POSTAL_CODE      
     , PROV.PROVINCE_STATE_CODE
     , PROV.DESCRIPTION AS PROVINCE_NAME
     , CNTY.COUNTRY_CODE
     , CNTY.DESCRIPTION AS COUNTRY_NAME
     , PROP.NAME
     , PROP.DESCRIPTION
     , PROP.ADDRESS_ID                 
     , PROP.REGION_CODE
     , PROP.DISTRICT_CODE
     , PROP.LOCATION AS GEOMETRY
     , PROP.PROPERTY_AREA_UNIT_TYPE_CODE
     , PROP.LAND_AREA
     , PROP.LAND_LEGAL_DESCRIPTION
     , PROP.ENCUMBRANCE_REASON                                      
     , PROP.IS_SENSITIVE
     , PROP.IS_OWNED
     , PROP.IS_PROPERTY_OF_INTEREST
     , PROP.IS_VISIBLE_TO_OTHER_AGENCIES
     , PROP.ZONING,ZONING_POTENTIAL
FROM   PIMS_PROPERTY       PROP                                                    INNER JOIN
       PIMS_ADDRESS        ADDR ON ADDR.ADDRESS_ID        = PROP.ADDRESS_ID        INNER JOIN
       PIMS_PROVINCE_STATE PROV ON PROV.PROVINCE_STATE_ID = ADDR.PROVINCE_STATE_ID INNER JOIN
       PIMS_COUNTRY        CNTY ON CNTY.COUNTRY_ID        = ADDR.COUNTRY_ID
GO


/* ---------------------------------------------------------------------- */
/* Add procedures                                                         */
/* ---------------------------------------------------------------------- */

-- ............................................................................................


-- --------------------------------------------------------------------------------------------
-- Create procedure [dbo].[pims_error_handling]
-- --------------------------------------------------------------------------------------------
CREATE PROCEDURE [dbo].[pims_error_handling] AS
  begin
    DECLARE @errmsg   nvarchar(2048),
      @severity tinyint,
      @state    tinyint,
      @errno    int,
      @proc     sysname,
      @lineno   int

    SELECT @errmsg = error_message(), @severity = error_severity(),
      @state  = error_state(), @errno = error_number(),
      @proc   = error_procedure(), @lineno = error_line()

    IF @errmsg NOT LIKE '***%'
      BEGIN
        SELECT @errmsg = '*** ' + coalesce(quotename(@proc), '<dynamic SQL>') +
          ', Line ' + ltrim(str(@lineno)) + '. Errno ' +
          ltrim(str(@errno)) + ': ' + @errmsg
      END

    RAISERROR('%s', @severity, @state, @errmsg)
  end
GO


/* ---------------------------------------------------------------------- */
/* Add triggers                                                           */
/* ---------------------------------------------------------------------- */

CREATE TRIGGER [dbo].[PIMS_PROJCT_A_S_IUD_TR] ON PIMS_PROJECT FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROJECT_HIST set END_DATE_HIST = @curr_date where PROJECT_ID in (select PROJECT_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROJECT_HIST ([PROJECT_ID], [PROJECT_TYPE_CODE], [PROJECT_STATUS_TYPE_CODE], [PROJECT_RISK_TYPE_CODE], [PROJECT_TIER_TYPE_CODE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROJECT_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROJECT_ID], [PROJECT_TYPE_CODE], [PROJECT_STATUS_TYPE_CODE], [PROJECT_RISK_TYPE_CODE], [PROJECT_TIER_TYPE_CODE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROJECT_H_ID_SEQ]) as [_PROJECT_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROJCT_I_S_I_TR] ON PIMS_PROJECT INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT ("PROJECT_ID",
      "PROJECT_TYPE_CODE",
      "PROJECT_STATUS_TYPE_CODE",
      "PROJECT_RISK_TYPE_CODE",
      "PROJECT_TIER_TYPE_CODE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROJECT_ID",
      "PROJECT_TYPE_CODE",
      "PROJECT_STATUS_TYPE_CODE",
      "PROJECT_RISK_TYPE_CODE",
      "PROJECT_TIER_TYPE_CODE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROJCT_I_S_U_TR] ON PIMS_PROJECT INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_ID = deleted.PROJECT_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT
    set "PROJECT_ID" = inserted."PROJECT_ID",
      "PROJECT_TYPE_CODE" = inserted."PROJECT_TYPE_CODE",
      "PROJECT_STATUS_TYPE_CODE" = inserted."PROJECT_STATUS_TYPE_CODE",
      "PROJECT_RISK_TYPE_CODE" = inserted."PROJECT_RISK_TYPE_CODE",
      "PROJECT_TIER_TYPE_CODE" = inserted."PROJECT_TIER_TYPE_CODE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT
    inner join inserted
    on (PIMS_PROJECT.PROJECT_ID = inserted.PROJECT_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPRTY_A_S_IUD_TR] ON PIMS_PROPERTY FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_HIST set END_DATE_HIST = @curr_date where PROPERTY_ID in (select PROPERTY_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_HIST ([PROPERTY_ID], [PROPERTY_MANAGER_ID], [PROP_MGMT_ORG_ID], [PROPERTY_TYPE_CODE], [PROPERTY_CLASSIFICATION_TYPE_CODE], [ADDRESS_ID], [REGION_CODE], [DISTRICT_CODE], [PROPERTY_TENURE_TYPE_CODE], [PROPERTY_AREA_UNIT_TYPE_CODE], [PROPERTY_STATUS_TYPE_CODE], [SURPLUS_DECLARATION_TYPE_CODE], [PROPERTY_DATA_SOURCE_TYPE_CODE], [PROPERTY_DATA_SOURCE_EFFECTIVE_DATE], [NAME], [DESCRIPTION], [PID], [PIN], [LAND_AREA], [ENCUMBRANCE_REASON], [SURPLUS_DECLARATION_COMMENT], [SURPLUS_DECLARATION_DATE], [IS_OWNED], [IS_PROPERTY_OF_INTEREST], [IS_VISIBLE_TO_OTHER_AGENCIES], [IS_SENSITIVE], [ZONING], [ZONING_POTENTIAL], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_ID], [PROPERTY_MANAGER_ID], [PROP_MGMT_ORG_ID], [PROPERTY_TYPE_CODE], [PROPERTY_CLASSIFICATION_TYPE_CODE], [ADDRESS_ID], [REGION_CODE], [DISTRICT_CODE], [PROPERTY_TENURE_TYPE_CODE], [PROPERTY_AREA_UNIT_TYPE_CODE], [PROPERTY_STATUS_TYPE_CODE], [SURPLUS_DECLARATION_TYPE_CODE], [PROPERTY_DATA_SOURCE_TYPE_CODE], [PROPERTY_DATA_SOURCE_EFFECTIVE_DATE], [NAME], [DESCRIPTION], [PID], [PIN], [LAND_AREA], [ENCUMBRANCE_REASON], [SURPLUS_DECLARATION_COMMENT], [SURPLUS_DECLARATION_DATE], [IS_OWNED], [IS_PROPERTY_OF_INTEREST], [IS_VISIBLE_TO_OTHER_AGENCIES], [IS_SENSITIVE], [ZONING], [ZONING_POTENTIAL], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_H_ID_SEQ]) as [_PROPERTY_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPRTY_I_S_I_TR] ON PIMS_PROPERTY INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY ("PROPERTY_ID",
      "PROPERTY_MANAGER_ID",
      "PROP_MGMT_ORG_ID",
      "PROPERTY_TYPE_CODE",
      "PROPERTY_CLASSIFICATION_TYPE_CODE",
      "ADDRESS_ID",
      "REGION_CODE",
      "DISTRICT_CODE",
      "PROPERTY_TENURE_TYPE_CODE",
      "PROPERTY_AREA_UNIT_TYPE_CODE",
      "PROPERTY_STATUS_TYPE_CODE",
      "SURPLUS_DECLARATION_TYPE_CODE",
      "PROPERTY_DATA_SOURCE_TYPE_CODE",
      "PROPERTY_DATA_SOURCE_EFFECTIVE_DATE",
      "NAME",
      "DESCRIPTION",
      "PID",
      "PIN",
      "LAND_AREA",
      "LAND_LEGAL_DESCRIPTION",
      "BOUNDARY",
      "LOCATION",
      "ENCUMBRANCE_REASON",
      "SURPLUS_DECLARATION_COMMENT",
      "SURPLUS_DECLARATION_DATE",
      "IS_OWNED",
      "IS_PROPERTY_OF_INTEREST",
      "IS_VISIBLE_TO_OTHER_AGENCIES",
      "IS_SENSITIVE",
      "ZONING",
      "ZONING_POTENTIAL",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_ID",
      "PROPERTY_MANAGER_ID",
      "PROP_MGMT_ORG_ID",
      "PROPERTY_TYPE_CODE",
      "PROPERTY_CLASSIFICATION_TYPE_CODE",
      "ADDRESS_ID",
      "REGION_CODE",
      "DISTRICT_CODE",
      "PROPERTY_TENURE_TYPE_CODE",
      "PROPERTY_AREA_UNIT_TYPE_CODE",
      "PROPERTY_STATUS_TYPE_CODE",
      "SURPLUS_DECLARATION_TYPE_CODE",
      "PROPERTY_DATA_SOURCE_TYPE_CODE",
      "PROPERTY_DATA_SOURCE_EFFECTIVE_DATE",
      "NAME",
      "DESCRIPTION",
      "PID",
      "PIN",
      "LAND_AREA",
      "LAND_LEGAL_DESCRIPTION",
      "BOUNDARY",
      "LOCATION",
      "ENCUMBRANCE_REASON",
      "SURPLUS_DECLARATION_COMMENT",
      "SURPLUS_DECLARATION_DATE",
      "IS_OWNED",
      "IS_PROPERTY_OF_INTEREST",
      "IS_VISIBLE_TO_OTHER_AGENCIES",
      "IS_SENSITIVE",
      "ZONING",
      "ZONING_POTENTIAL",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPRTY_I_S_U_TR] ON PIMS_PROPERTY INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_ID = deleted.PROPERTY_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY
    set "PROPERTY_ID" = inserted."PROPERTY_ID",
      "PROPERTY_MANAGER_ID" = inserted."PROPERTY_MANAGER_ID",
      "PROP_MGMT_ORG_ID" = inserted."PROP_MGMT_ORG_ID",
      "PROPERTY_TYPE_CODE" = inserted."PROPERTY_TYPE_CODE",
      "PROPERTY_CLASSIFICATION_TYPE_CODE" = inserted."PROPERTY_CLASSIFICATION_TYPE_CODE",
      "ADDRESS_ID" = inserted."ADDRESS_ID",
      "REGION_CODE" = inserted."REGION_CODE",
      "DISTRICT_CODE" = inserted."DISTRICT_CODE",
      "PROPERTY_TENURE_TYPE_CODE" = inserted."PROPERTY_TENURE_TYPE_CODE",
      "PROPERTY_AREA_UNIT_TYPE_CODE" = inserted."PROPERTY_AREA_UNIT_TYPE_CODE",
      "PROPERTY_STATUS_TYPE_CODE" = inserted."PROPERTY_STATUS_TYPE_CODE",
      "SURPLUS_DECLARATION_TYPE_CODE" = inserted."SURPLUS_DECLARATION_TYPE_CODE",
      "PROPERTY_DATA_SOURCE_TYPE_CODE" = inserted."PROPERTY_DATA_SOURCE_TYPE_CODE",
      "PROPERTY_DATA_SOURCE_EFFECTIVE_DATE" = inserted."PROPERTY_DATA_SOURCE_EFFECTIVE_DATE",
      "NAME" = inserted."NAME",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "PID" = inserted."PID",
      "PIN" = inserted."PIN",
      "LAND_AREA" = inserted."LAND_AREA",
      "LAND_LEGAL_DESCRIPTION" = inserted."LAND_LEGAL_DESCRIPTION",
      "BOUNDARY" = inserted."BOUNDARY",
      "LOCATION" = inserted."LOCATION",
      "ENCUMBRANCE_REASON" = inserted."ENCUMBRANCE_REASON",
      "SURPLUS_DECLARATION_COMMENT" = inserted."SURPLUS_DECLARATION_COMMENT",
      "SURPLUS_DECLARATION_DATE" = inserted."SURPLUS_DECLARATION_DATE",
      "IS_OWNED" = inserted."IS_OWNED",
      "IS_PROPERTY_OF_INTEREST" = inserted."IS_PROPERTY_OF_INTEREST",
      "IS_VISIBLE_TO_OTHER_AGENCIES" = inserted."IS_VISIBLE_TO_OTHER_AGENCIES",
      "IS_SENSITIVE" = inserted."IS_SENSITIVE",
      "ZONING" = inserted."ZONING",
      "ZONING_POTENTIAL" = inserted."ZONING_POTENTIAL",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY
    inner join inserted
    on (PIMS_PROPERTY.PROPERTY_ID = inserted.PROPERTY_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACTVTY_A_S_IUD_TR] ON PIMS_ACTIVITY FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ACTIVITY_HIST set END_DATE_HIST = @curr_date where ACTIVITY_ID in (select ACTIVITY_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ACTIVITY_HIST ([ACTIVITY_ID], [PROJECT_ID], [WORKFLOW_ID], [ACTIVITY_MODEL_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ACTIVITY_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ACTIVITY_ID], [PROJECT_ID], [WORKFLOW_ID], [ACTIVITY_MODEL_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ACTIVITY_H_ID_SEQ]) as [_ACTIVITY_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACTVTY_I_S_I_TR] ON PIMS_ACTIVITY INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ACTIVITY ("ACTIVITY_ID",
      "PROJECT_ID",
      "WORKFLOW_ID",
      "ACTIVITY_MODEL_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ACTIVITY_ID",
      "PROJECT_ID",
      "WORKFLOW_ID",
      "ACTIVITY_MODEL_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACTVTY_I_S_U_TR] ON PIMS_ACTIVITY INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ACTIVITY_ID = deleted.ACTIVITY_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ACTIVITY
    set "ACTIVITY_ID" = inserted."ACTIVITY_ID",
      "PROJECT_ID" = inserted."PROJECT_ID",
      "WORKFLOW_ID" = inserted."WORKFLOW_ID",
      "ACTIVITY_MODEL_ID" = inserted."ACTIVITY_MODEL_ID",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ACTIVITY
    inner join inserted
    on (PIMS_ACTIVITY.ACTIVITY_ID = inserted.ACTIVITY_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPSVC_A_S_IUD_TR] ON PIMS_PROPERTY_SERVICE_FILE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_SERVICE_FILE_HIST set END_DATE_HIST = @curr_date where PROPERTY_SERVICE_FILE_ID in (select PROPERTY_SERVICE_FILE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_SERVICE_FILE_HIST ([PROPERTY_SERVICE_FILE_ID], [PROPERTY_SERVICE_FILE_TYPE_CODE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_SERVICE_FILE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_SERVICE_FILE_ID], [PROPERTY_SERVICE_FILE_TYPE_CODE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_SERVICE_FILE_H_ID_SEQ]) as [_PROPERTY_SERVICE_FILE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPSVC_I_S_I_TR] ON PIMS_PROPERTY_SERVICE_FILE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_SERVICE_FILE ("PROPERTY_SERVICE_FILE_ID",
      "PROPERTY_SERVICE_FILE_TYPE_CODE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_SERVICE_FILE_ID",
      "PROPERTY_SERVICE_FILE_TYPE_CODE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPSVC_I_S_U_TR] ON PIMS_PROPERTY_SERVICE_FILE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_SERVICE_FILE_ID = deleted.PROPERTY_SERVICE_FILE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_SERVICE_FILE
    set "PROPERTY_SERVICE_FILE_ID" = inserted."PROPERTY_SERVICE_FILE_ID",
      "PROPERTY_SERVICE_FILE_TYPE_CODE" = inserted."PROPERTY_SERVICE_FILE_TYPE_CODE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_SERVICE_FILE
    inner join inserted
    on (PIMS_PROPERTY_SERVICE_FILE.PROPERTY_SERVICE_FILE_ID = inserted.PROPERTY_SERVICE_FILE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TASK_A_S_IUD_TR] ON PIMS_TASK FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_TASK_HIST set END_DATE_HIST = @curr_date where TASK_ID in (select TASK_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_TASK_HIST ([TASK_ID], [TASK_TEMPLATE_ID], [ACTIVITY_ID], [USER_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _TASK_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [TASK_ID], [TASK_TEMPLATE_ID], [ACTIVITY_ID], [USER_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_TASK_H_ID_SEQ]) as [_TASK_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TASK_I_S_I_TR] ON PIMS_TASK INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_TASK ("TASK_ID",
      "TASK_TEMPLATE_ID",
      "ACTIVITY_ID",
      "USER_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "TASK_ID",
      "TASK_TEMPLATE_ID",
      "ACTIVITY_ID",
      "USER_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TASK_I_S_U_TR] ON PIMS_TASK INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.TASK_ID = deleted.TASK_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_TASK
    set "TASK_ID" = inserted."TASK_ID",
      "TASK_TEMPLATE_ID" = inserted."TASK_TEMPLATE_ID",
      "ACTIVITY_ID" = inserted."ACTIVITY_ID",
      "USER_ID" = inserted."USER_ID",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_TASK
    inner join inserted
    on (PIMS_TASK.TASK_ID = inserted.TASK_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACTMDL_A_S_IUD_TR] ON PIMS_ACTIVITY_MODEL FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ACTIVITY_MODEL_HIST set END_DATE_HIST = @curr_date where ACTIVITY_MODEL_ID in (select ACTIVITY_MODEL_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ACTIVITY_MODEL_HIST ([ACTIVITY_MODEL_ID], [DESCRIPTION], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ACTIVITY_MODEL_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ACTIVITY_MODEL_ID], [DESCRIPTION], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ACTIVITY_MODEL_H_ID_SEQ]) as [_ACTIVITY_MODEL_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACTMDL_I_S_I_TR] ON PIMS_ACTIVITY_MODEL INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ACTIVITY_MODEL ("ACTIVITY_MODEL_ID",
      "DESCRIPTION",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ACTIVITY_MODEL_ID",
      "DESCRIPTION",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACTMDL_I_S_U_TR] ON PIMS_ACTIVITY_MODEL INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ACTIVITY_MODEL_ID = deleted.ACTIVITY_MODEL_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ACTIVITY_MODEL
    set "ACTIVITY_MODEL_ID" = inserted."ACTIVITY_MODEL_ID",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ACTIVITY_MODEL
    inner join inserted
    on (PIMS_ACTIVITY_MODEL.ACTIVITY_MODEL_ID = inserted.ACTIVITY_MODEL_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTMP_A_S_IUD_TR] ON PIMS_TASK_TEMPLATE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_TASK_TEMPLATE_HIST set END_DATE_HIST = @curr_date where TASK_TEMPLATE_ID in (select TASK_TEMPLATE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_TASK_TEMPLATE_HIST ([TASK_TEMPLATE_ID], [TASK_TEMPLATE_TYPE_CODE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _TASK_TEMPLATE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [TASK_TEMPLATE_ID], [TASK_TEMPLATE_TYPE_CODE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_TASK_TEMPLATE_H_ID_SEQ]) as [_TASK_TEMPLATE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTMP_I_S_I_TR] ON PIMS_TASK_TEMPLATE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_TASK_TEMPLATE ("TASK_TEMPLATE_ID",
      "TASK_TEMPLATE_TYPE_CODE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "TASK_TEMPLATE_ID",
      "TASK_TEMPLATE_TYPE_CODE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTMP_I_S_U_TR] ON PIMS_TASK_TEMPLATE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.TASK_TEMPLATE_ID = deleted.TASK_TEMPLATE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_TASK_TEMPLATE
    set "TASK_TEMPLATE_ID" = inserted."TASK_TEMPLATE_ID",
      "TASK_TEMPLATE_TYPE_CODE" = inserted."TASK_TEMPLATE_TYPE_CODE",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_TASK_TEMPLATE
    inner join inserted
    on (PIMS_TASK_TEMPLATE.TASK_TEMPLATE_ID = inserted.TASK_TEMPLATE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USER_A_S_IUD_TR] ON PIMS_USER FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_USER_HIST set END_DATE_HIST = @curr_date where USER_ID in (select USER_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_USER_HIST ([USER_ID], [PERSON_ID], [BUSINESS_IDENTIFIER_VALUE], [GUID_IDENTIFIER_VALUE], [POSITION], [NOTE], [LAST_LOGIN], [APPROVED_BY_ID], [ISSUE_DATE], [EXPIRY_DATE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _USER_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [USER_ID], [PERSON_ID], [BUSINESS_IDENTIFIER_VALUE], [GUID_IDENTIFIER_VALUE], [POSITION], [NOTE], [LAST_LOGIN], [APPROVED_BY_ID], [ISSUE_DATE], [EXPIRY_DATE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_USER_H_ID_SEQ]) as [_USER_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USER_I_S_I_TR] ON PIMS_USER INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_USER ("USER_ID",
      "PERSON_ID",
      "BUSINESS_IDENTIFIER_VALUE",
      "GUID_IDENTIFIER_VALUE",
      "POSITION",
      "NOTE",
      "LAST_LOGIN",
      "APPROVED_BY_ID",
      "ISSUE_DATE",
      "EXPIRY_DATE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "USER_ID",
      "PERSON_ID",
      "BUSINESS_IDENTIFIER_VALUE",
      "GUID_IDENTIFIER_VALUE",
      "POSITION",
      "NOTE",
      "LAST_LOGIN",
      "APPROVED_BY_ID",
      "ISSUE_DATE",
      "EXPIRY_DATE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USER_I_S_U_TR] ON PIMS_USER INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.USER_ID = deleted.USER_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_USER
    set "USER_ID" = inserted."USER_ID",
      "PERSON_ID" = inserted."PERSON_ID",
      "BUSINESS_IDENTIFIER_VALUE" = inserted."BUSINESS_IDENTIFIER_VALUE",
      "GUID_IDENTIFIER_VALUE" = inserted."GUID_IDENTIFIER_VALUE",
      "POSITION" = inserted."POSITION",
      "NOTE" = inserted."NOTE",
      "LAST_LOGIN" = inserted."LAST_LOGIN",
      "APPROVED_BY_ID" = inserted."APPROVED_BY_ID",
      "ISSUE_DATE" = inserted."ISSUE_DATE",
      "EXPIRY_DATE" = inserted."EXPIRY_DATE",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_USER
    inner join inserted
    on (PIMS_USER.USER_ID = inserted.USER_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRWKMD_A_S_IUD_TR] ON PIMS_PROJECT_WORKFLOW_MODEL FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROJECT_WORKFLOW_MODEL_HIST set END_DATE_HIST = @curr_date where PROJECT_WORKFLOW_MODEL_ID in (select PROJECT_WORKFLOW_MODEL_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROJECT_WORKFLOW_MODEL_HIST ([PROJECT_WORKFLOW_MODEL_ID], [PROJECT_ID], [WORKFLOW_MODEL_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROJECT_WORKFLOW_MODEL_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROJECT_WORKFLOW_MODEL_ID], [PROJECT_ID], [WORKFLOW_MODEL_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROJECT_WORKFLOW_MODEL_H_ID_SEQ]) as [_PROJECT_WORKFLOW_MODEL_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRWKMD_I_S_I_TR] ON PIMS_PROJECT_WORKFLOW_MODEL INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT_WORKFLOW_MODEL ("PROJECT_WORKFLOW_MODEL_ID",
      "PROJECT_ID",
      "WORKFLOW_MODEL_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROJECT_WORKFLOW_MODEL_ID",
      "PROJECT_ID",
      "WORKFLOW_MODEL_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRWKMD_I_S_U_TR] ON PIMS_PROJECT_WORKFLOW_MODEL INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_WORKFLOW_MODEL_ID = deleted.PROJECT_WORKFLOW_MODEL_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT_WORKFLOW_MODEL
    set "PROJECT_WORKFLOW_MODEL_ID" = inserted."PROJECT_WORKFLOW_MODEL_ID",
      "PROJECT_ID" = inserted."PROJECT_ID",
      "WORKFLOW_MODEL_ID" = inserted."WORKFLOW_MODEL_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT_WORKFLOW_MODEL
    inner join inserted
    on (PIMS_PROJECT_WORKFLOW_MODEL.PROJECT_WORKFLOW_MODEL_ID = inserted.PROJECT_WORKFLOW_MODEL_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJPRP_A_S_IUD_TR] ON PIMS_PROJECT_PROPERTY FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROJECT_PROPERTY_HIST set END_DATE_HIST = @curr_date where PROJECT_PROPERTY_ID in (select PROJECT_PROPERTY_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROJECT_PROPERTY_HIST ([PROJECT_PROPERTY_ID], [PROJECT_ID], [PROPERTY_ID], [IS_DISABLED], [APP_CREATE_TIMESTAMP], [APP_CREATE_USER_DIRECTORY], [APP_CREATE_USER_GUID], [APP_CREATE_USERID], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USER_DIRECTORY], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USERID], [CONCURRENCY_CONTROL_NUMBER], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROJECT_PROPERTY_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROJECT_PROPERTY_ID], [PROJECT_ID], [PROPERTY_ID], [IS_DISABLED], [APP_CREATE_TIMESTAMP], [APP_CREATE_USER_DIRECTORY], [APP_CREATE_USER_GUID], [APP_CREATE_USERID], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USER_DIRECTORY], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USERID], [CONCURRENCY_CONTROL_NUMBER], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROJECT_PROPERTY_H_ID_SEQ]) as [_PROJECT_PROPERTY_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJPRP_I_S_I_TR] ON PIMS_PROJECT_PROPERTY INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT_PROPERTY ("PROJECT_PROPERTY_ID",
      "PROJECT_ID",
      "PROPERTY_ID",
      "IS_DISABLED",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USER_DIRECTORY",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USERID",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USERID",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROJECT_PROPERTY_ID",
      "PROJECT_ID",
      "PROPERTY_ID",
      "IS_DISABLED",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USER_DIRECTORY",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USERID",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USERID",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJPRP_I_S_U_TR] ON PIMS_PROJECT_PROPERTY INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_PROPERTY_ID = deleted.PROJECT_PROPERTY_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT_PROPERTY
    set "PROJECT_PROPERTY_ID" = inserted."PROJECT_PROPERTY_ID",
      "PROJECT_ID" = inserted."PROJECT_ID",
      "PROPERTY_ID" = inserted."PROPERTY_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT_PROPERTY
    inner join inserted
    on (PIMS_PROJECT_PROPERTY.PROJECT_PROPERTY_ID = inserted.PROJECT_PROPERTY_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_WFLMDL_A_S_IUD_TR] ON PIMS_WORKFLOW_MODEL FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_WORKFLOW_MODEL_HIST set END_DATE_HIST = @curr_date where WORKFLOW_MODEL_ID in (select WORKFLOW_MODEL_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_WORKFLOW_MODEL_HIST ([WORKFLOW_MODEL_ID], [WORKFLOW_MODEL_TYPE_CODE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _WORKFLOW_MODEL_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [WORKFLOW_MODEL_ID], [WORKFLOW_MODEL_TYPE_CODE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_WORKFLOW_MODEL_H_ID_SEQ]) as [_WORKFLOW_MODEL_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_WFLMDL_I_S_I_TR] ON PIMS_WORKFLOW_MODEL INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_WORKFLOW_MODEL ("WORKFLOW_MODEL_ID",
      "WORKFLOW_MODEL_TYPE_CODE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "WORKFLOW_MODEL_ID",
      "WORKFLOW_MODEL_TYPE_CODE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_WFLMDL_I_S_U_TR] ON PIMS_WORKFLOW_MODEL INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.WORKFLOW_MODEL_ID = deleted.WORKFLOW_MODEL_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_WORKFLOW_MODEL
    set "WORKFLOW_MODEL_ID" = inserted."WORKFLOW_MODEL_ID",
      "WORKFLOW_MODEL_TYPE_CODE" = inserted."WORKFLOW_MODEL_TYPE_CODE",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_WORKFLOW_MODEL
    inner join inserted
    on (PIMS_WORKFLOW_MODEL.WORKFLOW_MODEL_ID = inserted.WORKFLOW_MODEL_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPACT_A_S_IUD_TR] ON PIMS_PROPERTY_ACTIVITY FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_ACTIVITY_HIST set END_DATE_HIST = @curr_date where PROPERTY_ACTIVITY_ID in (select PROPERTY_ACTIVITY_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_ACTIVITY_HIST ([PROPERTY_ACTIVITY_ID], [ACTIVITY_ID], [PROPERTY_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_ACTIVITY_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_ACTIVITY_ID], [ACTIVITY_ID], [PROPERTY_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_ACTIVITY_H_ID_SEQ]) as [_PROPERTY_ACTIVITY_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPACT_I_S_I_TR] ON PIMS_PROPERTY_ACTIVITY INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_ACTIVITY ("PROPERTY_ACTIVITY_ID",
      "ACTIVITY_ID",
      "PROPERTY_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_ACTIVITY_ID",
      "ACTIVITY_ID",
      "PROPERTY_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPACT_I_S_U_TR] ON PIMS_PROPERTY_ACTIVITY INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_ACTIVITY_ID = deleted.PROPERTY_ACTIVITY_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_ACTIVITY
    set "PROPERTY_ACTIVITY_ID" = inserted."PROPERTY_ACTIVITY_ID",
      "ACTIVITY_ID" = inserted."ACTIVITY_ID",
      "PROPERTY_ID" = inserted."PROPERTY_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_ACTIVITY
    inner join inserted
    on (PIMS_PROPERTY_ACTIVITY.PROPERTY_ACTIVITY_ID = inserted.PROPERTY_ACTIVITY_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_WFLMDT_I_S_I_TR] ON PIMS_WORKFLOW_MODEL_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_WORKFLOW_MODEL_TYPE ("WORKFLOW_MODEL_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "WORKFLOW_MODEL_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_WFLMDT_I_S_U_TR] ON PIMS_WORKFLOW_MODEL_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.WORKFLOW_MODEL_TYPE_CODE = deleted.WORKFLOW_MODEL_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_WORKFLOW_MODEL_TYPE
    set "WORKFLOW_MODEL_TYPE_CODE" = inserted."WORKFLOW_MODEL_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_WORKFLOW_MODEL_TYPE
    inner join inserted
    on (PIMS_WORKFLOW_MODEL_TYPE.WORKFLOW_MODEL_TYPE_CODE = inserted.WORKFLOW_MODEL_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPTYP_I_S_I_TR] ON PIMS_PROPERTY_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_TYPE ("PROPERTY_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPTYP_I_S_U_TR] ON PIMS_PROPERTY_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_TYPE_CODE = deleted.PROPERTY_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_TYPE
    set "PROPERTY_TYPE_CODE" = inserted."PROPERTY_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_TYPE
    inner join inserted
    on (PIMS_PROPERTY_TYPE.PROPERTY_TYPE_CODE = inserted.PROPERTY_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ADDRSS_I_S_I_TR] ON PIMS_ADDRESS INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ADDRESS ("ADDRESS_ID",
      "ADDRESS_USAGE_TYPE_CODE",
      "REGION_CODE",
      "DISTRICT_CODE",
      "PROVINCE_STATE_ID",
      "COUNTRY_ID",
      "STREET_ADDRESS_1",
      "STREET_ADDRESS_2",
      "STREET_ADDRESS_3",
      "MUNICIPALITY_NAME",
      "POSTAL_CODE",
      "LATITUDE",
      "LONGITUDE",
      "COMMENT",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ADDRESS_ID",
      "ADDRESS_USAGE_TYPE_CODE",
      "REGION_CODE",
      "DISTRICT_CODE",
      "PROVINCE_STATE_ID",
      "COUNTRY_ID",
      "STREET_ADDRESS_1",
      "STREET_ADDRESS_2",
      "STREET_ADDRESS_3",
      "MUNICIPALITY_NAME",
      "POSTAL_CODE",
      "LATITUDE",
      "LONGITUDE",
      "COMMENT",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ADDRSS_I_S_U_TR] ON PIMS_ADDRESS INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ADDRESS_ID = deleted.ADDRESS_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ADDRESS
    set "ADDRESS_ID" = inserted."ADDRESS_ID",
      "ADDRESS_USAGE_TYPE_CODE" = inserted."ADDRESS_USAGE_TYPE_CODE",
      "REGION_CODE" = inserted."REGION_CODE",
      "DISTRICT_CODE" = inserted."DISTRICT_CODE",
      "PROVINCE_STATE_ID" = inserted."PROVINCE_STATE_ID",
      "COUNTRY_ID" = inserted."COUNTRY_ID",
      "STREET_ADDRESS_1" = inserted."STREET_ADDRESS_1",
      "STREET_ADDRESS_2" = inserted."STREET_ADDRESS_2",
      "STREET_ADDRESS_3" = inserted."STREET_ADDRESS_3",
      "MUNICIPALITY_NAME" = inserted."MUNICIPALITY_NAME",
      "POSTAL_CODE" = inserted."POSTAL_CODE",
      "LATITUDE" = inserted."LATITUDE",
      "LONGITUDE" = inserted."LONGITUDE",
      "COMMENT" = inserted."COMMENT",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ADDRESS
    inner join inserted
    on (PIMS_ADDRESS.ADDRESS_ID = inserted.ADDRESS_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ADDRSS_A_S_IUD_TR] ON PIMS_ADDRESS FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ADDRESS_HIST set END_DATE_HIST = @curr_date where ADDRESS_ID in (select ADDRESS_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ADDRESS_HIST ([ADDRESS_ID], [ADDRESS_USAGE_TYPE_CODE], [REGION_CODE], [DISTRICT_CODE], [PROVINCE_STATE_ID], [COUNTRY_ID], [STREET_ADDRESS_1], [STREET_ADDRESS_2], [STREET_ADDRESS_3], [MUNICIPALITY_NAME], [POSTAL_CODE], [LATITUDE], [LONGITUDE], [COMMENT], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ADDRESS_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ADDRESS_ID], [ADDRESS_USAGE_TYPE_CODE], [REGION_CODE], [DISTRICT_CODE], [PROVINCE_STATE_ID], [COUNTRY_ID], [STREET_ADDRESS_1], [STREET_ADDRESS_2], [STREET_ADDRESS_3], [MUNICIPALITY_NAME], [POSTAL_CODE], [LATITUDE], [LONGITUDE], [COMMENT], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ADDRESS_H_ID_SEQ]) as [_ADDRESS_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_DSTRCT_I_S_I_TR] ON PIMS_DISTRICT INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_DISTRICT ("DISTRICT_CODE",
      "REGION_CODE",
      "DISTRICT_NAME",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "DISTRICT_CODE",
      "REGION_CODE",
      "DISTRICT_NAME",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_DSTRCT_I_S_U_TR] ON PIMS_DISTRICT INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.DISTRICT_CODE = deleted.DISTRICT_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_DISTRICT
    set "DISTRICT_CODE" = inserted."DISTRICT_CODE",
      "REGION_CODE" = inserted."REGION_CODE",
      "DISTRICT_NAME" = inserted."DISTRICT_NAME",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_DISTRICT
    inner join inserted
    on (PIMS_DISTRICT.DISTRICT_CODE = inserted.DISTRICT_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_REGION_I_S_I_TR] ON PIMS_REGION INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_REGION ("REGION_CODE",
      "REGION_NAME",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "REGION_CODE",
      "REGION_NAME",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_REGION_I_S_U_TR] ON PIMS_REGION INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.REGION_CODE = deleted.REGION_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_REGION
    set "REGION_CODE" = inserted."REGION_CODE",
      "REGION_NAME" = inserted."REGION_NAME",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_REGION
    inner join inserted
    on (PIMS_REGION.REGION_CODE = inserted.REGION_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROVNC_I_S_I_TR] ON PIMS_PROVINCE_STATE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROVINCE_STATE ("PROVINCE_STATE_ID",
      "COUNTRY_ID",
      "PROVINCE_STATE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROVINCE_STATE_ID",
      "COUNTRY_ID",
      "PROVINCE_STATE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROVNC_I_S_U_TR] ON PIMS_PROVINCE_STATE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROVINCE_STATE_ID = deleted.PROVINCE_STATE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROVINCE_STATE
    set "PROVINCE_STATE_ID" = inserted."PROVINCE_STATE_ID",
      "COUNTRY_ID" = inserted."COUNTRY_ID",
      "PROVINCE_STATE_CODE" = inserted."PROVINCE_STATE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROVINCE_STATE
    inner join inserted
    on (PIMS_PROVINCE_STATE.PROVINCE_STATE_ID = inserted.PROVINCE_STATE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CNTRY_I_S_I_TR] ON PIMS_COUNTRY INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_COUNTRY ("COUNTRY_ID",
      "COUNTRY_CODE",
      "DESCRIPTION",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "COUNTRY_ID",
      "COUNTRY_CODE",
      "DESCRIPTION",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CNTRY_I_S_U_TR] ON PIMS_COUNTRY INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.COUNTRY_ID = deleted.COUNTRY_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_COUNTRY
    set "COUNTRY_ID" = inserted."COUNTRY_ID",
      "COUNTRY_CODE" = inserted."COUNTRY_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_COUNTRY
    inner join inserted
    on (PIMS_COUNTRY.COUNTRY_ID = inserted.COUNTRY_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ADUSGT_I_S_I_TR] ON PIMS_ADDRESS_USAGE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ADDRESS_USAGE_TYPE ("ADDRESS_USAGE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "ADDRESS_USAGE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ADUSGT_I_S_U_TR] ON PIMS_ADDRESS_USAGE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ADDRESS_USAGE_TYPE_CODE = deleted.ADDRESS_USAGE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ADDRESS_USAGE_TYPE
    set "ADDRESS_USAGE_TYPE_CODE" = inserted."ADDRESS_USAGE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ADDRESS_USAGE_TYPE
    inner join inserted
    on (PIMS_ADDRESS_USAGE_TYPE.ADDRESS_USAGE_TYPE_CODE = inserted.ADDRESS_USAGE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ORG_I_S_I_TR] ON PIMS_ORGANIZATION INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ORGANIZATION ("ORGANIZATION_ID",
      "PRNT_ORGANIZATION_ID",
      "ADDRESS_ID",
      "REGION_CODE",
      "DISTRICT_CODE",
      "ORGANIZATION_TYPE_CODE",
      "ORG_IDENTIFIER_TYPE_CODE",
      "ORGANIZATION_IDENTIFIER",
      "ORGANIZATION_NAME",
      "ORGANIZATION_ALIAS",
      "WEBSITE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ORGANIZATION_ID",
      "PRNT_ORGANIZATION_ID",
      "ADDRESS_ID",
      "REGION_CODE",
      "DISTRICT_CODE",
      "ORGANIZATION_TYPE_CODE",
      "ORG_IDENTIFIER_TYPE_CODE",
      "ORGANIZATION_IDENTIFIER",
      "ORGANIZATION_NAME",
      "ORGANIZATION_ALIAS",
      "WEBSITE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ORG_I_S_U_TR] ON PIMS_ORGANIZATION INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ORGANIZATION_ID = deleted.ORGANIZATION_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ORGANIZATION
    set "ORGANIZATION_ID" = inserted."ORGANIZATION_ID",
      "PRNT_ORGANIZATION_ID" = inserted."PRNT_ORGANIZATION_ID",
      "ADDRESS_ID" = inserted."ADDRESS_ID",
      "REGION_CODE" = inserted."REGION_CODE",
      "DISTRICT_CODE" = inserted."DISTRICT_CODE",
      "ORGANIZATION_TYPE_CODE" = inserted."ORGANIZATION_TYPE_CODE",
      "ORG_IDENTIFIER_TYPE_CODE" = inserted."ORG_IDENTIFIER_TYPE_CODE",
      "ORGANIZATION_IDENTIFIER" = inserted."ORGANIZATION_IDENTIFIER",
      "ORGANIZATION_NAME" = inserted."ORGANIZATION_NAME",
      "ORGANIZATION_ALIAS" = inserted."ORGANIZATION_ALIAS",
      "WEBSITE" = inserted."WEBSITE",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ORGANIZATION
    inner join inserted
    on (PIMS_ORGANIZATION.ORGANIZATION_ID = inserted.ORGANIZATION_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ORG_A_S_IUD_TR] ON PIMS_ORGANIZATION FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ORGANIZATION_HIST set END_DATE_HIST = @curr_date where ORGANIZATION_ID in (select ORGANIZATION_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ORGANIZATION_HIST ([ORGANIZATION_ID], [PRNT_ORGANIZATION_ID], [ADDRESS_ID], [REGION_CODE], [DISTRICT_CODE], [ORGANIZATION_TYPE_CODE], [ORG_IDENTIFIER_TYPE_CODE], [ORGANIZATION_IDENTIFIER], [ORGANIZATION_NAME], [ORGANIZATION_ALIAS], [WEBSITE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ORGANIZATION_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ORGANIZATION_ID], [PRNT_ORGANIZATION_ID], [ADDRESS_ID], [REGION_CODE], [DISTRICT_CODE], [ORGANIZATION_TYPE_CODE], [ORG_IDENTIFIER_TYPE_CODE], [ORGANIZATION_IDENTIFIER], [ORGANIZATION_NAME], [ORGANIZATION_ALIAS], [WEBSITE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ORGANIZATION_H_ID_SEQ]) as [_ORGANIZATION_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USRORG_A_S_IUD_TR] ON PIMS_USER_ORGANIZATION FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_USER_ORGANIZATION_HIST set END_DATE_HIST = @curr_date where USER_ORGANIZATION_ID in (select USER_ORGANIZATION_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_USER_ORGANIZATION_HIST ([USER_ORGANIZATION_ID], [ORGANIZATION_ID], [USER_ID], [ROLE_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _USER_ORGANIZATION_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [USER_ORGANIZATION_ID], [ORGANIZATION_ID], [USER_ID], [ROLE_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_USER_ORGANIZATION_H_ID_SEQ]) as [_USER_ORGANIZATION_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USRORG_I_S_I_TR] ON PIMS_USER_ORGANIZATION INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_USER_ORGANIZATION ("USER_ORGANIZATION_ID",
      "ORGANIZATION_ID",
      "USER_ID",
      "ROLE_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "USER_ORGANIZATION_ID",
      "ORGANIZATION_ID",
      "USER_ID",
      "ROLE_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USRORG_I_S_U_TR] ON PIMS_USER_ORGANIZATION INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.USER_ORGANIZATION_ID = deleted.USER_ORGANIZATION_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_USER_ORGANIZATION
    set "USER_ORGANIZATION_ID" = inserted."USER_ORGANIZATION_ID",
      "ORGANIZATION_ID" = inserted."ORGANIZATION_ID",
      "USER_ID" = inserted."USER_ID",
      "ROLE_ID" = inserted."ROLE_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_USER_ORGANIZATION
    inner join inserted
    on (PIMS_USER_ORGANIZATION.USER_ORGANIZATION_ID = inserted.USER_ORGANIZATION_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CLMTYP_A_S_IUD_TR] ON PIMS_CLAIM FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_CLAIM_HIST set END_DATE_HIST = @curr_date where CLAIM_ID in (select CLAIM_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_CLAIM_HIST ([CLAIM_ID], [CLAIM_UID], [KEYCLOAK_ROLE_ID], [NAME], [DESCRIPTION], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _CLAIM_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [CLAIM_ID], [CLAIM_UID], [KEYCLOAK_ROLE_ID], [NAME], [DESCRIPTION], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_CLAIM_H_ID_SEQ]) as [_CLAIM_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CLMTYP_I_S_I_TR] ON PIMS_CLAIM INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_CLAIM ("CLAIM_ID",
      "CLAIM_UID",
      "KEYCLOAK_ROLE_ID",
      "NAME",
      "DESCRIPTION",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "CLAIM_ID",
      "CLAIM_UID",
      "KEYCLOAK_ROLE_ID",
      "NAME",
      "DESCRIPTION",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CLMTYP_I_S_U_TR] ON PIMS_CLAIM INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.CLAIM_ID = deleted.CLAIM_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_CLAIM
    set "CLAIM_ID" = inserted."CLAIM_ID",
      "CLAIM_UID" = inserted."CLAIM_UID",
      "KEYCLOAK_ROLE_ID" = inserted."KEYCLOAK_ROLE_ID",
      "NAME" = inserted."NAME",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_CLAIM
    inner join inserted
    on (PIMS_CLAIM.CLAIM_ID = inserted.CLAIM_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJTYP_I_S_I_TR] ON PIMS_PROJECT_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT_TYPE ("PROJECT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROJECT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJTYP_I_S_U_TR] ON PIMS_PROJECT_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_TYPE_CODE = deleted.PROJECT_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT_TYPE
    set "PROJECT_TYPE_CODE" = inserted."PROJECT_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT_TYPE
    inner join inserted
    on (PIMS_PROJECT_TYPE.PROJECT_TYPE_CODE = inserted.PROJECT_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ROLCLM_A_S_IUD_TR] ON PIMS_ROLE_CLAIM FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ROLE_CLAIM_HIST set END_DATE_HIST = @curr_date where ROLE_CLAIM_ID in (select ROLE_CLAIM_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ROLE_CLAIM_HIST ([ROLE_CLAIM_ID], [ROLE_ID], [CLAIM_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ROLE_CLAIM_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ROLE_CLAIM_ID], [ROLE_ID], [CLAIM_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ROLE_CLAIM_H_ID_SEQ]) as [_ROLE_CLAIM_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ROLCLM_I_S_I_TR] ON PIMS_ROLE_CLAIM INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ROLE_CLAIM ("ROLE_CLAIM_ID",
      "ROLE_ID",
      "CLAIM_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ROLE_CLAIM_ID",
      "ROLE_ID",
      "CLAIM_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ROLCLM_I_S_U_TR] ON PIMS_ROLE_CLAIM INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ROLE_CLAIM_ID = deleted.ROLE_CLAIM_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ROLE_CLAIM
    set "ROLE_CLAIM_ID" = inserted."ROLE_CLAIM_ID",
      "ROLE_ID" = inserted."ROLE_ID",
      "CLAIM_ID" = inserted."CLAIM_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ROLE_CLAIM
    inner join inserted
    on (PIMS_ROLE_CLAIM.ROLE_CLAIM_ID = inserted.ROLE_CLAIM_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PERSON_I_S_I_TR] ON PIMS_PERSON INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PERSON ("PERSON_ID",
      "ADDRESS_ID",
      "SURNAME",
      "FIRST_NAME",
      "MIDDLE_NAMES",
      "NAME_SUFFIX",
      "PREFERRED_NAME",
      "BIRTH_DATE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PERSON_ID",
      "ADDRESS_ID",
      "SURNAME",
      "FIRST_NAME",
      "MIDDLE_NAMES",
      "NAME_SUFFIX",
      "PREFERRED_NAME",
      "BIRTH_DATE",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PERSON_I_S_U_TR] ON PIMS_PERSON INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PERSON_ID = deleted.PERSON_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PERSON
    set "PERSON_ID" = inserted."PERSON_ID",
      "ADDRESS_ID" = inserted."ADDRESS_ID",
      "SURNAME" = inserted."SURNAME",
      "FIRST_NAME" = inserted."FIRST_NAME",
      "MIDDLE_NAMES" = inserted."MIDDLE_NAMES",
      "NAME_SUFFIX" = inserted."NAME_SUFFIX",
      "PREFERRED_NAME" = inserted."PREFERRED_NAME",
      "BIRTH_DATE" = inserted."BIRTH_DATE",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PERSON
    inner join inserted
    on (PIMS_PERSON.PERSON_ID = inserted.PERSON_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PERSON_A_S_IUD_TR] ON PIMS_PERSON FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PERSON_HIST set END_DATE_HIST = @curr_date where PERSON_ID in (select PERSON_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PERSON_HIST ([PERSON_ID], [ADDRESS_ID], [SURNAME], [FIRST_NAME], [MIDDLE_NAMES], [NAME_SUFFIX], [PREFERRED_NAME], [BIRTH_DATE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PERSON_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PERSON_ID], [ADDRESS_ID], [SURNAME], [FIRST_NAME], [MIDDLE_NAMES], [NAME_SUFFIX], [PREFERRED_NAME], [BIRTH_DATE], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PERSON_H_ID_SEQ]) as [_PERSON_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTMT_I_S_I_TR] ON PIMS_TASK_TEMPLATE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_TASK_TEMPLATE_TYPE ("TASK_TEMPLATE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "TASK_TEMPLATE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTMT_I_S_U_TR] ON PIMS_TASK_TEMPLATE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.TASK_TEMPLATE_TYPE_CODE = deleted.TASK_TEMPLATE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_TASK_TEMPLATE_TYPE
    set "TASK_TEMPLATE_TYPE_CODE" = inserted."TASK_TEMPLATE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_TASK_TEMPLATE_TYPE
    inner join inserted
    on (PIMS_TASK_TEMPLATE_TYPE.TASK_TEMPLATE_TYPE_CODE = inserted.TASK_TEMPLATE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PERORG_A_S_IUD_TR] ON PIMS_PERSON_ORGANIZATION FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PERSON_ORGANIZATION_HIST set END_DATE_HIST = @curr_date where PERSON_ORGANIZATION_ID in (select PERSON_ORGANIZATION_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PERSON_ORGANIZATION_HIST ([PERSON_ORGANIZATION_ID], [PERSON_ID], [ORGANIZATION_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PERSON_ORGANIZATION_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PERSON_ORGANIZATION_ID], [PERSON_ID], [ORGANIZATION_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PERSON_ORGANIZATION_H_ID_SEQ]) as [_PERSON_ORGANIZATION_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PERORG_I_S_I_TR] ON PIMS_PERSON_ORGANIZATION INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PERSON_ORGANIZATION ("PERSON_ORGANIZATION_ID",
      "PERSON_ID",
      "ORGANIZATION_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PERSON_ORGANIZATION_ID",
      "PERSON_ID",
      "ORGANIZATION_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PERORG_I_S_U_TR] ON PIMS_PERSON_ORGANIZATION INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PERSON_ORGANIZATION_ID = deleted.PERSON_ORGANIZATION_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PERSON_ORGANIZATION
    set "PERSON_ORGANIZATION_ID" = inserted."PERSON_ORGANIZATION_ID",
      "PERSON_ID" = inserted."PERSON_ID",
      "ORGANIZATION_ID" = inserted."ORGANIZATION_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PERSON_ORGANIZATION
    inner join inserted
    on (PIMS_PERSON_ORGANIZATION.PERSON_ORGANIZATION_ID = inserted.PERSON_ORGANIZATION_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ORGTYP_I_S_I_TR] ON PIMS_ORGANIZATION_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ORGANIZATION_TYPE ("ORGANIZATION_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "ORGANIZATION_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ORGTYP_I_S_U_TR] ON PIMS_ORGANIZATION_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ORGANIZATION_TYPE_CODE = deleted.ORGANIZATION_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ORGANIZATION_TYPE
    set "ORGANIZATION_TYPE_CODE" = inserted."ORGANIZATION_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ORGANIZATION_TYPE
    inner join inserted
    on (PIMS_ORGANIZATION_TYPE.ORGANIZATION_TYPE_CODE = inserted.ORGANIZATION_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACRQST_A_S_IUD_TR] ON PIMS_ACCESS_REQUEST FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ACCESS_REQUEST_HIST set END_DATE_HIST = @curr_date where ACCESS_REQUEST_ID in (select ACCESS_REQUEST_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ACCESS_REQUEST_HIST ([ACCESS_REQUEST_ID], [USER_ID], [ROLE_ID], [ACCESS_REQUEST_STATUS_TYPE_CODE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ACCESS_REQUEST_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ACCESS_REQUEST_ID], [USER_ID], [ROLE_ID], [ACCESS_REQUEST_STATUS_TYPE_CODE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ACCESS_REQUEST_H_ID_SEQ]) as [_ACCESS_REQUEST_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACRQST_I_S_I_TR] ON PIMS_ACCESS_REQUEST INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ACCESS_REQUEST ("ACCESS_REQUEST_ID",
      "USER_ID",
      "ROLE_ID",
      "ACCESS_REQUEST_STATUS_TYPE_CODE",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ACCESS_REQUEST_ID",
      "USER_ID",
      "ROLE_ID",
      "ACCESS_REQUEST_STATUS_TYPE_CODE",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACRQST_I_S_U_TR] ON PIMS_ACCESS_REQUEST INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ACCESS_REQUEST_ID = deleted.ACCESS_REQUEST_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ACCESS_REQUEST
    set "ACCESS_REQUEST_ID" = inserted."ACCESS_REQUEST_ID",
      "USER_ID" = inserted."USER_ID",
      "ROLE_ID" = inserted."ROLE_ID",
      "ACCESS_REQUEST_STATUS_TYPE_CODE" = inserted."ACCESS_REQUEST_STATUS_TYPE_CODE",
      "NOTE" = inserted."NOTE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ACCESS_REQUEST
    inner join inserted
    on (PIMS_ACCESS_REQUEST.ACCESS_REQUEST_ID = inserted.ACCESS_REQUEST_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACRQOR_A_S_IUD_TR] ON PIMS_ACCESS_REQUEST_ORGANIZATION FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ACCESS_REQUEST_ORGANIZATION_HIST set END_DATE_HIST = @curr_date where ACCESS_REQUEST_ORGANIZATION_ID in (select ACCESS_REQUEST_ORGANIZATION_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ACCESS_REQUEST_ORGANIZATION_HIST ([ACCESS_REQUEST_ORGANIZATION_ID], [ORGANIZATION_ID], [ACCESS_REQUEST_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ACCESS_REQUEST_ORGANIZATION_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ACCESS_REQUEST_ORGANIZATION_ID], [ORGANIZATION_ID], [ACCESS_REQUEST_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ACCESS_REQUEST_ORGANIZATION_H_ID_SEQ]) as [_ACCESS_REQUEST_ORGANIZATION_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACRQOR_I_S_I_TR] ON PIMS_ACCESS_REQUEST_ORGANIZATION INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ACCESS_REQUEST_ORGANIZATION ("ACCESS_REQUEST_ORGANIZATION_ID",
      "ORGANIZATION_ID",
      "ACCESS_REQUEST_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ACCESS_REQUEST_ORGANIZATION_ID",
      "ORGANIZATION_ID",
      "ACCESS_REQUEST_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ACRQOR_I_S_U_TR] ON PIMS_ACCESS_REQUEST_ORGANIZATION INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ACCESS_REQUEST_ORGANIZATION_ID = deleted.ACCESS_REQUEST_ORGANIZATION_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ACCESS_REQUEST_ORGANIZATION
    set "ACCESS_REQUEST_ORGANIZATION_ID" = inserted."ACCESS_REQUEST_ORGANIZATION_ID",
      "ORGANIZATION_ID" = inserted."ORGANIZATION_ID",
      "ACCESS_REQUEST_ID" = inserted."ACCESS_REQUEST_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ACCESS_REQUEST_ORGANIZATION
    inner join inserted
    on (PIMS_ACCESS_REQUEST_ORGANIZATION.ACCESS_REQUEST_ORGANIZATION_ID = inserted.ACCESS_REQUEST_ORGANIZATION_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ARQSTT_I_S_I_TR] ON PIMS_ACCESS_REQUEST_STATUS_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ACCESS_REQUEST_STATUS_TYPE ("ACCESS_REQUEST_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "ACCESS_REQUEST_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ARQSTT_I_S_U_TR] ON PIMS_ACCESS_REQUEST_STATUS_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ACCESS_REQUEST_STATUS_TYPE_CODE = deleted.ACCESS_REQUEST_STATUS_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ACCESS_REQUEST_STATUS_TYPE
    set "ACCESS_REQUEST_STATUS_TYPE_CODE" = inserted."ACCESS_REQUEST_STATUS_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ACCESS_REQUEST_STATUS_TYPE
    inner join inserted
    on (PIMS_ACCESS_REQUEST_STATUS_TYPE.ACCESS_REQUEST_STATUS_TYPE_CODE = inserted.ACCESS_REQUEST_STATUS_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJSTY_I_S_I_TR] ON PIMS_PROJECT_STATUS_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT_STATUS_TYPE ("PROJECT_STATUS_TYPE_CODE",
      "CODE_GROUP",
      "DESCRIPTION",
      "TEXT",
      "IS_MILESTONE",
      "IS_TERMINAL",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROJECT_STATUS_TYPE_CODE",
      "CODE_GROUP",
      "DESCRIPTION",
      "TEXT",
      "IS_MILESTONE",
      "IS_TERMINAL",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJSTY_I_S_U_TR] ON PIMS_PROJECT_STATUS_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_STATUS_TYPE_CODE = deleted.PROJECT_STATUS_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT_STATUS_TYPE
    set "PROJECT_STATUS_TYPE_CODE" = inserted."PROJECT_STATUS_TYPE_CODE",
      "CODE_GROUP" = inserted."CODE_GROUP",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "TEXT" = inserted."TEXT",
      "IS_MILESTONE" = inserted."IS_MILESTONE",
      "IS_TERMINAL" = inserted."IS_TERMINAL",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT_STATUS_TYPE
    inner join inserted
    on (PIMS_PROJECT_STATUS_TYPE.PROJECT_STATUS_TYPE_CODE = inserted.PROJECT_STATUS_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRSVFT_I_S_I_TR] ON PIMS_PROPERTY_SERVICE_FILE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_SERVICE_FILE_TYPE ("PROPERTY_SERVICE_FILE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_SERVICE_FILE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRSVFT_I_S_U_TR] ON PIMS_PROPERTY_SERVICE_FILE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_SERVICE_FILE_TYPE_CODE = deleted.PROPERTY_SERVICE_FILE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_SERVICE_FILE_TYPE
    set "PROPERTY_SERVICE_FILE_TYPE_CODE" = inserted."PROPERTY_SERVICE_FILE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_SERVICE_FILE_TYPE
    inner join inserted
    on (PIMS_PROPERTY_SERVICE_FILE_TYPE.PROPERTY_SERVICE_FILE_TYPE_CODE = inserted.PROPERTY_SERVICE_FILE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROJNT_A_S_IUD_TR] ON PIMS_PROJECT_NOTE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROJECT_NOTE_HIST set END_DATE_HIST = @curr_date where PROJECT_NOTE_ID in (select PROJECT_NOTE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROJECT_NOTE_HIST ([PROJECT_NOTE_ID], [PROJECT_ID], [APP_CREATE_TIMESTAMP], [APP_CREATE_USER_DIRECTORY], [APP_CREATE_USER_GUID], [APP_CREATE_USERID], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USER_DIRECTORY], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USERID], [CONCURRENCY_CONTROL_NUMBER], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROJECT_NOTE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROJECT_NOTE_ID], [PROJECT_ID], [APP_CREATE_TIMESTAMP], [APP_CREATE_USER_DIRECTORY], [APP_CREATE_USER_GUID], [APP_CREATE_USERID], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USER_DIRECTORY], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USERID], [CONCURRENCY_CONTROL_NUMBER], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROJECT_NOTE_H_ID_SEQ]) as [_PROJECT_NOTE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROJNT_I_S_I_TR] ON PIMS_PROJECT_NOTE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT_NOTE ("PROJECT_NOTE_ID",
      "PROJECT_ID",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USER_DIRECTORY",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USERID",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USERID",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROJECT_NOTE_ID",
      "PROJECT_ID",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USER_DIRECTORY",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USERID",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USERID",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROJNT_I_S_U_TR] ON PIMS_PROJECT_NOTE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_NOTE_ID = deleted.PROJECT_NOTE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT_NOTE
    set "PROJECT_NOTE_ID" = inserted."PROJECT_NOTE_ID",
      "PROJECT_ID" = inserted."PROJECT_ID",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT_NOTE
    inner join inserted
    on (PIMS_PROJECT_NOTE.PROJECT_NOTE_ID = inserted.PROJECT_NOTE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJRSK_I_S_I_TR] ON PIMS_PROJECT_RISK_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT_RISK_TYPE ("PROJECT_RISK_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROJECT_RISK_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRJRSK_I_S_U_TR] ON PIMS_PROJECT_RISK_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_RISK_TYPE_CODE = deleted.PROJECT_RISK_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT_RISK_TYPE
    set "PROJECT_RISK_TYPE_CODE" = inserted."PROJECT_RISK_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT_RISK_TYPE
    inner join inserted
    on (PIMS_PROJECT_RISK_TYPE.PROJECT_RISK_TYPE_CODE = inserted.PROJECT_RISK_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROJTR_I_S_I_TR] ON PIMS_PROJECT_TIER_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROJECT_TIER_TYPE ("PROJECT_TIER_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROJECT_TIER_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROJTR_I_S_U_TR] ON PIMS_PROJECT_TIER_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROJECT_TIER_TYPE_CODE = deleted.PROJECT_TIER_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROJECT_TIER_TYPE
    set "PROJECT_TIER_TYPE_CODE" = inserted."PROJECT_TIER_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROJECT_TIER_TYPE
    inner join inserted
    on (PIMS_PROJECT_TIER_TYPE.PROJECT_TIER_TYPE_CODE = inserted.PROJECT_TIER_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ROLE_A_S_IUD_TR] ON PIMS_ROLE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_ROLE_HIST set END_DATE_HIST = @curr_date where ROLE_ID in (select ROLE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_ROLE_HIST ([ROLE_ID], [ROLE_UID], [KEYCLOAK_GROUP_ID], [NAME], [DESCRIPTION], [IS_PUBLIC], [IS_DISABLED], [SORT_ORDER], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _ROLE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [ROLE_ID], [ROLE_UID], [KEYCLOAK_GROUP_ID], [NAME], [DESCRIPTION], [IS_PUBLIC], [IS_DISABLED], [SORT_ORDER], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_ROLE_H_ID_SEQ]) as [_ROLE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ROLE_I_S_I_TR] ON PIMS_ROLE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ROLE ("ROLE_ID",
      "ROLE_UID",
      "KEYCLOAK_GROUP_ID",
      "NAME",
      "DESCRIPTION",
      "IS_PUBLIC",
      "IS_DISABLED",
      "SORT_ORDER",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "ROLE_ID",
      "ROLE_UID",
      "KEYCLOAK_GROUP_ID",
      "NAME",
      "DESCRIPTION",
      "IS_PUBLIC",
      "IS_DISABLED",
      "SORT_ORDER",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ROLE_I_S_U_TR] ON PIMS_ROLE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ROLE_ID = deleted.ROLE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ROLE
    set "ROLE_ID" = inserted."ROLE_ID",
      "ROLE_UID" = inserted."ROLE_UID",
      "KEYCLOAK_GROUP_ID" = inserted."KEYCLOAK_GROUP_ID",
      "NAME" = inserted."NAME",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_PUBLIC" = inserted."IS_PUBLIC",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "SORT_ORDER" = inserted."SORT_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ROLE
    inner join inserted
    on (PIMS_ROLE.ROLE_ID = inserted.ROLE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USERRL_A_S_IUD_TR] ON PIMS_USER_ROLE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_USER_ROLE_HIST set END_DATE_HIST = @curr_date where USER_ROLE_ID in (select USER_ROLE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_USER_ROLE_HIST ([USER_ROLE_ID], [USER_ID], [ROLE_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _USER_ROLE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [USER_ROLE_ID], [USER_ID], [ROLE_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_USER_ROLE_H_ID_SEQ]) as [_USER_ROLE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USERRL_I_S_I_TR] ON PIMS_USER_ROLE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_USER_ROLE ("USER_ROLE_ID",
      "USER_ID",
      "ROLE_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "USER_ROLE_ID",
      "USER_ID",
      "ROLE_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_USERRL_I_S_U_TR] ON PIMS_USER_ROLE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.USER_ROLE_ID = deleted.USER_ROLE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_USER_ROLE
    set "USER_ROLE_ID" = inserted."USER_ROLE_ID",
      "USER_ID" = inserted."USER_ID",
      "ROLE_ID" = inserted."ROLE_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_USER_ROLE
    inner join inserted
    on (PIMS_USER_ROLE.USER_ROLE_ID = inserted.USER_ROLE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPRSF_A_S_IUD_TR] ON PIMS_PROPERTY_PROPERTY_SERVICE_FILE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_PROPERTY_SERVICE_FILE_HIST set END_DATE_HIST = @curr_date where PROPERTY_PROPERTY_SERVICE_FILE_ID in (select PROPERTY_PROPERTY_SERVICE_FILE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_PROPERTY_SERVICE_FILE_HIST ([PROPERTY_PROPERTY_SERVICE_FILE_ID], [PROPERTY_ID], [PROPERTY_SERVICE_FILE_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_PROPERTY_SERVICE_FILE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_PROPERTY_SERVICE_FILE_ID], [PROPERTY_ID], [PROPERTY_SERVICE_FILE_ID], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_PROPERTY_SERVICE_FILE_H_ID_SEQ]) as [_PROPERTY_PROPERTY_SERVICE_FILE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPRSF_I_S_I_TR] ON PIMS_PROPERTY_PROPERTY_SERVICE_FILE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_PROPERTY_SERVICE_FILE ("PROPERTY_PROPERTY_SERVICE_FILE_ID",
      "PROPERTY_ID",
      "PROPERTY_SERVICE_FILE_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_PROPERTY_SERVICE_FILE_ID",
      "PROPERTY_ID",
      "PROPERTY_SERVICE_FILE_ID",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPRSF_I_S_U_TR] ON PIMS_PROPERTY_PROPERTY_SERVICE_FILE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_PROPERTY_SERVICE_FILE_ID = deleted.PROPERTY_PROPERTY_SERVICE_FILE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_PROPERTY_SERVICE_FILE
    set "PROPERTY_PROPERTY_SERVICE_FILE_ID" = inserted."PROPERTY_PROPERTY_SERVICE_FILE_ID",
      "PROPERTY_ID" = inserted."PROPERTY_ID",
      "PROPERTY_SERVICE_FILE_ID" = inserted."PROPERTY_SERVICE_FILE_ID",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_PROPERTY_SERVICE_FILE
    inner join inserted
    on (PIMS_PROPERTY_PROPERTY_SERVICE_FILE.PROPERTY_PROPERTY_SERVICE_FILE_ID = inserted.PROPERTY_PROPERTY_SERVICE_FILE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPCLT_I_S_I_TR] ON PIMS_PROPERTY_CLASSIFICATION_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_CLASSIFICATION_TYPE ("PROPERTY_CLASSIFICATION_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_CLASSIFICATION_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPCLT_I_S_U_TR] ON PIMS_PROPERTY_CLASSIFICATION_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_CLASSIFICATION_TYPE_CODE = deleted.PROPERTY_CLASSIFICATION_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_CLASSIFICATION_TYPE
    set "PROPERTY_CLASSIFICATION_TYPE_CODE" = inserted."PROPERTY_CLASSIFICATION_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_CLASSIFICATION_TYPE
    inner join inserted
    on (PIMS_PROPERTY_CLASSIFICATION_TYPE.PROPERTY_CLASSIFICATION_TYPE_CODE = inserted.PROPERTY_CLASSIFICATION_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTAM_A_S_IUD_TR] ON PIMS_TASK_TEMPLATE_ACTIVITY_MODEL FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_HIST set END_DATE_HIST = @curr_date where TASK_TEMPLATE_ACTIVITY_MODEL_ID in (select TASK_TEMPLATE_ACTIVITY_MODEL_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_HIST ([TASK_TEMPLATE_ACTIVITY_MODEL_ID], [TASK_TEMPLATE_ID], [ACTIVITY_MODEL_ID], [IS_MANDATORY], [IMPLEMENTATION_ORDER], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _TASK_TEMPLATE_ACTIVITY_MODEL_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [TASK_TEMPLATE_ACTIVITY_MODEL_ID], [TASK_TEMPLATE_ID], [ACTIVITY_MODEL_ID], [IS_MANDATORY], [IMPLEMENTATION_ORDER], [IS_DISABLED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_TASK_TEMPLATE_ACTIVITY_MODEL_H_ID_SEQ]) as [_TASK_TEMPLATE_ACTIVITY_MODEL_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTAM_I_S_I_TR] ON PIMS_TASK_TEMPLATE_ACTIVITY_MODEL INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_TASK_TEMPLATE_ACTIVITY_MODEL ("TASK_TEMPLATE_ACTIVITY_MODEL_ID",
      "TASK_TEMPLATE_ID",
      "ACTIVITY_MODEL_ID",
      "IS_MANDATORY",
      "IMPLEMENTATION_ORDER",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "TASK_TEMPLATE_ACTIVITY_MODEL_ID",
      "TASK_TEMPLATE_ID",
      "ACTIVITY_MODEL_ID",
      "IS_MANDATORY",
      "IMPLEMENTATION_ORDER",
      "IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TSKTAM_I_S_U_TR] ON PIMS_TASK_TEMPLATE_ACTIVITY_MODEL INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.TASK_TEMPLATE_ACTIVITY_MODEL_ID = deleted.TASK_TEMPLATE_ACTIVITY_MODEL_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_TASK_TEMPLATE_ACTIVITY_MODEL
    set "TASK_TEMPLATE_ACTIVITY_MODEL_ID" = inserted."TASK_TEMPLATE_ACTIVITY_MODEL_ID",
      "TASK_TEMPLATE_ID" = inserted."TASK_TEMPLATE_ID",
      "ACTIVITY_MODEL_ID" = inserted."ACTIVITY_MODEL_ID",
      "IS_MANDATORY" = inserted."IS_MANDATORY",
      "IMPLEMENTATION_ORDER" = inserted."IMPLEMENTATION_ORDER",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_TASK_TEMPLATE_ACTIVITY_MODEL
    inner join inserted
    on (PIMS_TASK_TEMPLATE_ACTIVITY_MODEL.TASK_TEMPLATE_ACTIVITY_MODEL_ID = inserted.TASK_TEMPLATE_ACTIVITY_MODEL_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CNTMTH_A_S_IUD_TR] ON PIMS_CONTACT_METHOD FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_CONTACT_METHOD_HIST set END_DATE_HIST = @curr_date where CONTACT_METHOD_ID in (select CONTACT_METHOD_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_CONTACT_METHOD_HIST ([CONTACT_METHOD_ID], [CONTACT_METHOD_TYPE_CODE], [PERSON_ID], [ORGANIZATION_ID], [CONTACT_METHOD_VALUE], [IS_PREFERRED_METHOD], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _CONTACT_METHOD_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [CONTACT_METHOD_ID], [CONTACT_METHOD_TYPE_CODE], [PERSON_ID], [ORGANIZATION_ID], [CONTACT_METHOD_VALUE], [IS_PREFERRED_METHOD], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_CONTACT_METHOD_H_ID_SEQ]) as [_CONTACT_METHOD_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CNTMTH_I_S_I_TR] ON PIMS_CONTACT_METHOD INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_CONTACT_METHOD ("CONTACT_METHOD_ID",
      "CONTACT_METHOD_TYPE_CODE",
      "PERSON_ID",
      "ORGANIZATION_ID",
      "CONTACT_METHOD_VALUE",
      "IS_PREFERRED_METHOD",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "CONTACT_METHOD_ID",
      "CONTACT_METHOD_TYPE_CODE",
      "PERSON_ID",
      "ORGANIZATION_ID",
      "CONTACT_METHOD_VALUE",
      "IS_PREFERRED_METHOD",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CNTMTH_I_S_U_TR] ON PIMS_CONTACT_METHOD INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.CONTACT_METHOD_ID = deleted.CONTACT_METHOD_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_CONTACT_METHOD
    set "CONTACT_METHOD_ID" = inserted."CONTACT_METHOD_ID",
      "CONTACT_METHOD_TYPE_CODE" = inserted."CONTACT_METHOD_TYPE_CODE",
      "PERSON_ID" = inserted."PERSON_ID",
      "ORGANIZATION_ID" = inserted."ORGANIZATION_ID",
      "CONTACT_METHOD_VALUE" = inserted."CONTACT_METHOD_VALUE",
      "IS_PREFERRED_METHOD" = inserted."IS_PREFERRED_METHOD",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_CONTACT_METHOD
    inner join inserted
    on (PIMS_CONTACT_METHOD.CONTACT_METHOD_ID = inserted.CONTACT_METHOD_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CNTMTT_I_S_I_TR] ON PIMS_CONTACT_METHOD_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_CONTACT_METHOD_TYPE ("CONTACT_METHOD_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "CONTACT_METHOD_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_CNTMTT_I_S_U_TR] ON PIMS_CONTACT_METHOD_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.CONTACT_METHOD_TYPE_CODE = deleted.CONTACT_METHOD_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_CONTACT_METHOD_TYPE
    set "CONTACT_METHOD_TYPE_CODE" = inserted."CONTACT_METHOD_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_CONTACT_METHOD_TYPE
    inner join inserted
    on (PIMS_CONTACT_METHOD_TYPE.CONTACT_METHOD_TYPE_CODE = inserted.CONTACT_METHOD_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPORG_A_S_IUD_TR] ON PIMS_PROPERTY_ORGANIZATION FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_ORGANIZATION_HIST set END_DATE_HIST = @curr_date where PROPERTY_ORGANIZATION_ID in (select PROPERTY_ORGANIZATION_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_ORGANIZATION_HIST ([PROPERTY_ORGANIZATION_ID], [PROPERTY_ID], [ORGANIZATION_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], [IS_DISABLED], _PROPERTY_ORGANIZATION_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_ORGANIZATION_ID], [PROPERTY_ID], [ORGANIZATION_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], [IS_DISABLED], (next value for [dbo].[PIMS_PROPERTY_ORGANIZATION_H_ID_SEQ]) as [_PROPERTY_ORGANIZATION_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPORG_I_S_I_TR] ON PIMS_PROPERTY_ORGANIZATION INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_ORGANIZATION ("PROPERTY_ORGANIZATION_ID",
      "PROPERTY_ID",
      "ORGANIZATION_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY",
      "IS_DISABLED")
    select "PROPERTY_ORGANIZATION_ID",
      "PROPERTY_ID",
      "ORGANIZATION_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY",
      "IS_DISABLED"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPORG_I_S_U_TR] ON PIMS_PROPERTY_ORGANIZATION INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_ORGANIZATION_ID = deleted.PROPERTY_ORGANIZATION_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_ORGANIZATION
    set "PROPERTY_ORGANIZATION_ID" = inserted."PROPERTY_ORGANIZATION_ID",
      "PROPERTY_ID" = inserted."PROPERTY_ID",
      "ORGANIZATION_ID" = inserted."ORGANIZATION_ID",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY",
      "IS_DISABLED" = inserted."IS_DISABLED"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_ORGANIZATION
    inner join inserted
    on (PIMS_PROPERTY_ORGANIZATION.PROPERTY_ORGANIZATION_ID = inserted.PROPERTY_ORGANIZATION_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPTNR_I_S_I_TR] ON PIMS_PROPERTY_TENURE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_TENURE_TYPE ("PROPERTY_TENURE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_TENURE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPTNR_I_S_U_TR] ON PIMS_PROPERTY_TENURE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_TENURE_TYPE_CODE = deleted.PROPERTY_TENURE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_TENURE_TYPE
    set "PROPERTY_TENURE_TYPE_CODE" = inserted."PROPERTY_TENURE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_TENURE_TYPE
    inner join inserted
    on (PIMS_PROPERTY_TENURE_TYPE.PROPERTY_TENURE_TYPE_CODE = inserted.PROPERTY_TENURE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ARUNIT_I_S_I_TR] ON PIMS_AREA_UNIT_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_AREA_UNIT_TYPE ("AREA_UNIT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "AREA_UNIT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ARUNIT_I_S_U_TR] ON PIMS_AREA_UNIT_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.AREA_UNIT_TYPE_CODE = deleted.AREA_UNIT_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_AREA_UNIT_TYPE
    set "AREA_UNIT_TYPE_CODE" = inserted."AREA_UNIT_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_AREA_UNIT_TYPE
    inner join inserted
    on (PIMS_AREA_UNIT_TYPE.AREA_UNIT_TYPE_CODE = inserted.AREA_UNIT_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPEVL_A_S_IUD_TR] ON PIMS_PROPERTY_EVALUATION FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_EVALUATION_HIST set END_DATE_HIST = @curr_date where PROPERTY_EVALUATION_ID in (select PROPERTY_EVALUATION_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_EVALUATION_HIST ([PROPERTY_EVALUATION_ID], [PROPERTY_ID], [EVALUATION_DATE], [KEY], [VALUE], [NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_EVALUATION_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_EVALUATION_ID], [PROPERTY_ID], [EVALUATION_DATE], [KEY], [VALUE], [NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_EVALUATION_H_ID_SEQ]) as [_PROPERTY_EVALUATION_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPEVL_I_S_I_TR] ON PIMS_PROPERTY_EVALUATION INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_EVALUATION ("PROPERTY_EVALUATION_ID",
      "PROPERTY_ID",
      "EVALUATION_DATE",
      "KEY",
      "VALUE",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_EVALUATION_ID",
      "PROPERTY_ID",
      "EVALUATION_DATE",
      "KEY",
      "VALUE",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPEVL_I_S_U_TR] ON PIMS_PROPERTY_EVALUATION INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_EVALUATION_ID = deleted.PROPERTY_EVALUATION_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_EVALUATION
    set "PROPERTY_EVALUATION_ID" = inserted."PROPERTY_EVALUATION_ID",
      "PROPERTY_ID" = inserted."PROPERTY_ID",
      "EVALUATION_DATE" = inserted."EVALUATION_DATE",
      "KEY" = inserted."KEY",
      "VALUE" = inserted."VALUE",
      "NOTE" = inserted."NOTE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_EVALUATION
    inner join inserted
    on (PIMS_PROPERTY_EVALUATION.PROPERTY_EVALUATION_ID = inserted.PROPERTY_EVALUATION_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PIDSRT_I_S_I_TR] ON PIMS_PROPERTY_DATA_SOURCE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_DATA_SOURCE_TYPE ("PROPERTY_DATA_SOURCE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_DATA_SOURCE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PIDSRT_I_S_U_TR] ON PIMS_PROPERTY_DATA_SOURCE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_DATA_SOURCE_TYPE_CODE = deleted.PROPERTY_DATA_SOURCE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_DATA_SOURCE_TYPE
    set "PROPERTY_DATA_SOURCE_TYPE_CODE" = inserted."PROPERTY_DATA_SOURCE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_DATA_SOURCE_TYPE
    inner join inserted
    on (PIMS_PROPERTY_DATA_SOURCE_TYPE.PROPERTY_DATA_SOURCE_TYPE_CODE = inserted.PROPERTY_DATA_SOURCE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPSTS_I_S_I_TR] ON PIMS_PROPERTY_STATUS_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_STATUS_TYPE ("PROPERTY_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPSTS_I_S_U_TR] ON PIMS_PROPERTY_STATUS_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_STATUS_TYPE_CODE = deleted.PROPERTY_STATUS_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_STATUS_TYPE
    set "PROPERTY_STATUS_TYPE_CODE" = inserted."PROPERTY_STATUS_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_STATUS_TYPE
    inner join inserted
    on (PIMS_PROPERTY_STATUS_TYPE.PROPERTY_STATUS_TYPE_CODE = inserted.PROPERTY_STATUS_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ORGIDT_I_S_I_TR] ON PIMS_ORG_IDENTIFIER_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_ORG_IDENTIFIER_TYPE ("ORG_IDENTIFIER_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "ORG_IDENTIFIER_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_ORGIDT_I_S_U_TR] ON PIMS_ORG_IDENTIFIER_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.ORG_IDENTIFIER_TYPE_CODE = deleted.ORG_IDENTIFIER_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_ORG_IDENTIFIER_TYPE
    set "ORG_IDENTIFIER_TYPE_CODE" = inserted."ORG_IDENTIFIER_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_ORG_IDENTIFIER_TYPE
    inner join inserted
    on (PIMS_ORG_IDENTIFIER_TYPE.ORG_IDENTIFIER_TYPE_CODE = inserted.ORG_IDENTIFIER_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LEASE_I_S_U_TR] ON PIMS_LEASE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;
                                      
  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_ID = deleted.LEASE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE
    set "LEASE_ID" = inserted."LEASE_ID",
      "MOTI_NAME_ID" = inserted."MOTI_NAME_ID",
      "LEASE_PAY_RVBL_TYPE_CODE" = inserted."LEASE_PAY_RVBL_TYPE_CODE",
      "LEASE_LICENSE_TYPE_CODE" = inserted."LEASE_LICENSE_TYPE_CODE",
      "LEASE_CATEGORY_TYPE_CODE" = inserted."LEASE_CATEGORY_TYPE_CODE",
      "LEASE_PURPOSE_TYPE_CODE" = inserted."LEASE_PURPOSE_TYPE_CODE",
      "LEASE_PROGRAM_TYPE_CODE" = inserted."LEASE_PROGRAM_TYPE_CODE",
      "LEASE_INITIATOR_TYPE_CODE" = inserted."LEASE_INITIATOR_TYPE_CODE",
      "LEASE_RESPONSIBILITY_TYPE_CODE" = inserted."LEASE_RESPONSIBILITY_TYPE_CODE",
      "LEASE_PMT_FREQ_TYPE_CODE" = inserted."LEASE_PMT_FREQ_TYPE_CODE",
      "LEASE_PURPOSE_OTHER_DESC" = inserted."LEASE_PURPOSE_OTHER_DESC",
      "L_FILE_NO" = inserted."L_FILE_NO",
      "TFA_FILE_NO" = inserted."TFA_FILE_NO",
      "PS_FILE_NO" = inserted."PS_FILE_NO",
      "LEASE_DESCRIPTION" = inserted."LEASE_DESCRIPTION",
      "LEASE_NOTES" = inserted."LEASE_NOTES",
      "ORIG_START_DATE" = inserted."ORIG_START_DATE",
      "ORIG_EXPIRY_DATE" = inserted."ORIG_EXPIRY_DATE",
      "IS_ORIG_EXPIRY_REQUIRED" = inserted."IS_ORIG_EXPIRY_REQUIRED",
      "INCLUDED_RENEWALS" = inserted."INCLUDED_RENEWALS",  
      "RENEWAL_COUNT" = inserted."RENEWAL_COUNT",
      "RENEWAL_TERM_MONTHS" = inserted."RENEWAL_TERM_MONTHS",
      "LEASE_AMOUNT" = inserted."LEASE_AMOUNT",
      "RESPONSIBILITY_EFFECTIVE_DATE" = inserted."RESPONSIBILITY_EFFECTIVE_DATE",
      "INSPECTION_DATE" = inserted."INSPECTION_DATE",
      "INSPECTION_NOTES" = inserted."INSPECTION_NOTES",
      "IS_SUBJECT_TO_RTA" = inserted."IS_SUBJECT_TO_RTA",
      "IS_COMM_BLDG" = inserted."IS_COMM_BLDG",
      "IS_OTHER_IMPROVEMENT" = inserted."IS_OTHER_IMPROVEMENT",
      "IS_EXPIRED" = inserted."IS_EXPIRED",
      "HAS_PHYSICAL_FILE" = inserted."HAS_PHYSICAL_FILE",
      "HAS_DIGITAL_FILE" = inserted."HAS_DIGITAL_FILE",
      "HAS_PHYSICIAL_LICENSE" = inserted."HAS_PHYSICIAL_LICENSE",
      "HAS_DIGITAL_LICENSE" = inserted."HAS_DIGITAL_LICENSE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE
    inner join inserted
    on (PIMS_LEASE.LEASE_ID = inserted.LEASE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;

GO


CREATE TRIGGER [dbo].[PIMS_LEASE_I_S_I_TR] ON PIMS_LEASE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE ("LEASE_ID",
      "MOTI_NAME_ID",
      "LEASE_PAY_RVBL_TYPE_CODE",
      "LEASE_LICENSE_TYPE_CODE",
      "LEASE_CATEGORY_TYPE_CODE",
      "LEASE_PURPOSE_TYPE_CODE",
      "LEASE_PROGRAM_TYPE_CODE",
      "LEASE_INITIATOR_TYPE_CODE",
      "LEASE_RESPONSIBILITY_TYPE_CODE",
      "LEASE_PMT_FREQ_TYPE_CODE",
      "LEASE_PURPOSE_OTHER_DESC",
      "L_FILE_NO",
      "TFA_FILE_NO",
      "PS_FILE_NO",
      "LEASE_DESCRIPTION",
      "LEASE_NOTES",
      "ORIG_START_DATE",
      "ORIG_EXPIRY_DATE",
      "IS_ORIG_EXPIRY_REQUIRED",
      "INCLUDED_RENEWALS",
      "RENEWAL_COUNT",             
      "RENEWAL_TERM_MONTHS",      
      "LEASE_AMOUNT",
      "RESPONSIBILITY_EFFECTIVE_DATE",
      "INSPECTION_DATE",
      "INSPECTION_NOTES",
      "IS_SUBJECT_TO_RTA",
      "IS_COMM_BLDG",
      "IS_OTHER_IMPROVEMENT",
      "IS_EXPIRED",
      "HAS_PHYSICAL_FILE",
      "HAS_DIGITAL_FILE",
      "HAS_PHYSICIAL_LICENSE",
      "HAS_DIGITAL_LICENSE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "LEASE_ID",
      "MOTI_NAME_ID",
      "LEASE_PAY_RVBL_TYPE_CODE",
      "LEASE_LICENSE_TYPE_CODE",
      "LEASE_CATEGORY_TYPE_CODE",
      "LEASE_PURPOSE_TYPE_CODE",
      "LEASE_PROGRAM_TYPE_CODE",
      "LEASE_INITIATOR_TYPE_CODE",
      "LEASE_RESPONSIBILITY_TYPE_CODE",
      "LEASE_PMT_FREQ_TYPE_CODE",
      "LEASE_PURPOSE_OTHER_DESC",
      "L_FILE_NO",
      "TFA_FILE_NO",
      "PS_FILE_NO",
      "LEASE_DESCRIPTION",
      "LEASE_NOTES",
      "ORIG_START_DATE",
      "ORIG_EXPIRY_DATE",
      "IS_ORIG_EXPIRY_REQUIRED",
      "INCLUDED_RENEWALS",
      "RENEWAL_COUNT",   
      "RENEWAL_TERM_MONTHS",      
      "LEASE_AMOUNT",
      "RESPONSIBILITY_EFFECTIVE_DATE",
      "INSPECTION_DATE",
      "INSPECTION_NOTES",
      "IS_SUBJECT_TO_RTA",
      "IS_COMM_BLDG",
      "IS_OTHER_IMPROVEMENT",
      "IS_EXPIRED",
      "HAS_PHYSICAL_FILE",
      "HAS_DIGITAL_FILE",
      "HAS_PHYSICIAL_LICENSE",
      "HAS_DIGITAL_LICENSE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;

GO


CREATE TRIGGER [dbo].[PIMS_LEASE_A_S_IUD_TR] ON PIMS_LEASE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_LEASE_HIST set END_DATE_HIST = @curr_date where LEASE_ID in (select LEASE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_LEASE_HIST ([LEASE_ID], [MOTI_NAME_ID], [LEASE_PAY_RVBL_TYPE_CODE], [LEASE_LICENSE_TYPE_CODE], [LEASE_CATEGORY_TYPE_CODE], [LEASE_PURPOSE_TYPE_CODE], [LEASE_PROGRAM_TYPE_CODE], [LEASE_INITIATOR_TYPE_CODE], [LEASE_RESPONSIBILITY_TYPE_CODE], [LEASE_PMT_FREQ_TYPE_CODE], [LEASE_PURPOSE_OTHER_DESC], [L_FILE_NO], [TFA_FILE_NO], [PS_FILE_NO], [LEASE_DESCRIPTION], [LEASE_NOTES], [ORIG_START_DATE], [ORIG_EXPIRY_DATE], [IS_ORIG_EXPIRY_REQUIRED], [INCLUDED_RENEWALS], [RENEWAL_COUNT], [RENEWAL_TERM_MONTHS], [LEASE_AMOUNT], [RESPONSIBILITY_EFFECTIVE_DATE], [INSPECTION_DATE], [INSPECTION_NOTES], [IS_SUBJECT_TO_RTA], [IS_COMM_BLDG], [IS_OTHER_IMPROVEMENT], [IS_EXPIRED], [HAS_PHYSICAL_FILE], [HAS_DIGITAL_FILE], [HAS_PHYSICIAL_LICENSE], [HAS_DIGITAL_LICENSE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _LEASE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [LEASE_ID], [MOTI_NAME_ID], [LEASE_PAY_RVBL_TYPE_CODE], [LEASE_LICENSE_TYPE_CODE], [LEASE_CATEGORY_TYPE_CODE], [LEASE_PURPOSE_TYPE_CODE], [LEASE_PROGRAM_TYPE_CODE], [LEASE_INITIATOR_TYPE_CODE], [LEASE_RESPONSIBILITY_TYPE_CODE], [LEASE_PMT_FREQ_TYPE_CODE], [LEASE_PURPOSE_OTHER_DESC], [L_FILE_NO], [TFA_FILE_NO], [PS_FILE_NO], [LEASE_DESCRIPTION], [LEASE_NOTES], [ORIG_START_DATE], [ORIG_EXPIRY_DATE], [IS_ORIG_EXPIRY_REQUIRED], [INCLUDED_RENEWALS], [RENEWAL_COUNT], [RENEWAL_TERM_MONTHS], [LEASE_AMOUNT], [RESPONSIBILITY_EFFECTIVE_DATE], [INSPECTION_DATE], [INSPECTION_NOTES], [IS_SUBJECT_TO_RTA], [IS_COMM_BLDG], [IS_OTHER_IMPROVEMENT], [IS_EXPIRED], [HAS_PHYSICAL_FILE], [HAS_DIGITAL_FILE], [HAS_PHYSICIAL_LICENSE], [HAS_DIGITAL_LICENSE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_LEASE_H_ID_SEQ]) as [_LEASE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;

GO


CREATE TRIGGER [dbo].[PIMS_LSCATT_I_S_I_TR] ON PIMS_LEASE_CATEGORY_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_CATEGORY_TYPE ("LEASE_CATEGORY_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_CATEGORY_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSCATT_I_S_U_TR] ON PIMS_LEASE_CATEGORY_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_CATEGORY_TYPE_CODE = deleted.LEASE_CATEGORY_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_CATEGORY_TYPE
    set "LEASE_CATEGORY_TYPE_CODE" = inserted."LEASE_CATEGORY_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_CATEGORY_TYPE
    inner join inserted
    on (PIMS_LEASE_CATEGORY_TYPE.LEASE_CATEGORY_TYPE_CODE = inserted.LEASE_CATEGORY_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROPLS_A_S_IUD_TR] ON PIMS_PROPERTY_LEASE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_LEASE_HIST set END_DATE_HIST = @curr_date where PROPERTY_LEASE_ID in (select PROPERTY_LEASE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_LEASE_HIST ([PROPERTY_LEASE_ID], [PROPERTY_ID], [LEASE_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_LEASE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_LEASE_ID], [PROPERTY_ID], [LEASE_ID], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_LEASE_H_ID_SEQ]) as [_PROPERTY_LEASE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROPLS_I_S_I_TR] ON PIMS_PROPERTY_LEASE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_LEASE ("PROPERTY_LEASE_ID",
      "PROPERTY_ID",
      "LEASE_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_LEASE_ID",
      "PROPERTY_ID",
      "LEASE_ID",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PROPLS_I_S_U_TR] ON PIMS_PROPERTY_LEASE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_LEASE_ID = deleted.PROPERTY_LEASE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_LEASE
    set "PROPERTY_LEASE_ID" = inserted."PROPERTY_LEASE_ID",
      "PROPERTY_ID" = inserted."PROPERTY_ID",
      "LEASE_ID" = inserted."LEASE_ID",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_LEASE
    inner join inserted
    on (PIMS_PROPERTY_LEASE.PROPERTY_LEASE_ID = inserted.PROPERTY_LEASE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPMTF_I_S_I_TR] ON PIMS_LEASE_PMT_FREQ_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PMT_FREQ_TYPE ("LEASE_PMT_FREQ_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_PMT_FREQ_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPMTF_I_S_U_TR] ON PIMS_LEASE_PMT_FREQ_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PMT_FREQ_TYPE_CODE = deleted.LEASE_PMT_FREQ_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PMT_FREQ_TYPE
    set "LEASE_PMT_FREQ_TYPE_CODE" = inserted."LEASE_PMT_FREQ_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PMT_FREQ_TYPE
    inner join inserted
    on (PIMS_LEASE_PMT_FREQ_TYPE.LEASE_PMT_FREQ_TYPE_CODE = inserted.LEASE_PMT_FREQ_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPRGT_I_S_I_TR] ON PIMS_LEASE_PROGRAM_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PROGRAM_TYPE ("LEASE_PROGRAM_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_PROGRAM_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPRGT_I_S_U_TR] ON PIMS_LEASE_PROGRAM_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PROGRAM_TYPE_CODE = deleted.LEASE_PROGRAM_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PROGRAM_TYPE
    set "LEASE_PROGRAM_TYPE_CODE" = inserted."LEASE_PROGRAM_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PROGRAM_TYPE
    inner join inserted
    on (PIMS_LEASE_PROGRAM_TYPE.LEASE_PROGRAM_TYPE_CODE = inserted.LEASE_PROGRAM_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TENANT_I_S_U_TR] ON PIMS_LEASE_TENANT INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_TENANT_ID = deleted.LEASE_TENANT_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_TENANT
    set "LEASE_TENANT_ID" = inserted."LEASE_TENANT_ID",
      "LEASE_ID" = inserted."LEASE_ID",
      "PERSON_ID" = inserted."PERSON_ID",
      "ORGANIZATION_ID" = inserted."ORGANIZATION_ID",
      "LESSOR_TYPE_CODE" = inserted."LESSOR_TYPE_CODE",
      "NOTE" = inserted."NOTE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_TENANT
    inner join inserted
    on (PIMS_LEASE_TENANT.LEASE_TENANT_ID = inserted.LEASE_TENANT_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TENANT_I_S_I_TR] ON PIMS_LEASE_TENANT INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_TENANT ("LEASE_TENANT_ID",
      "LEASE_ID",
      "PERSON_ID",
      "ORGANIZATION_ID",
      "LESSOR_TYPE_CODE",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "LEASE_TENANT_ID",
      "LEASE_ID",
      "PERSON_ID",
      "ORGANIZATION_ID",
      "LESSOR_TYPE_CODE",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_TENANT_A_S_IUD_TR] ON PIMS_LEASE_TENANT FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_LEASE_TENANT_HIST set END_DATE_HIST = @curr_date where LEASE_TENANT_ID in (select LEASE_TENANT_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_LEASE_TENANT_HIST ([LEASE_TENANT_ID], [LEASE_ID], [PERSON_ID], [ORGANIZATION_ID], [LESSOR_TYPE_CODE], [NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _LEASE_TENANT_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [LEASE_TENANT_ID], [LEASE_ID], [PERSON_ID], [ORGANIZATION_ID], [LESSOR_TYPE_CODE], [NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_LEASE_TENANT_H_ID_SEQ]) as [_LEASE_TENANT_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSSRTY_I_S_I_TR] ON PIMS_LESSOR_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LESSOR_TYPE ("LESSOR_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LESSOR_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSSRTY_I_S_U_TR] ON PIMS_LESSOR_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LESSOR_TYPE_CODE = deleted.LESSOR_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LESSOR_TYPE
    set "LESSOR_TYPE_CODE" = inserted."LESSOR_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LESSOR_TYPE
    inner join inserted
    on (PIMS_LESSOR_TYPE.LESSOR_TYPE_CODE = inserted.LESSOR_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPRTY_I_S_I_TR] ON PIMS_LEASE_PAY_RVBL_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PAY_RVBL_TYPE ("LEASE_PAY_RVBL_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_PAY_RVBL_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPRTY_I_S_U_TR] ON PIMS_LEASE_PAY_RVBL_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PAY_RVBL_TYPE_CODE = deleted.LEASE_PAY_RVBL_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PAY_RVBL_TYPE
    set "LEASE_PAY_RVBL_TYPE_CODE" = inserted."LEASE_PAY_RVBL_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PAY_RVBL_TYPE
    inner join inserted
    on (PIMS_LEASE_PAY_RVBL_TYPE.LEASE_PAY_RVBL_TYPE_CODE = inserted.LEASE_PAY_RVBL_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LELIST_I_S_I_TR] ON PIMS_LEASE_LICENSE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_LICENSE_TYPE ("LEASE_LICENSE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_LICENSE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LELIST_I_S_U_TR] ON PIMS_LEASE_LICENSE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_LICENSE_TYPE_CODE = deleted.LEASE_LICENSE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_LICENSE_TYPE
    set "LEASE_LICENSE_TYPE_CODE" = inserted."LEASE_LICENSE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_LICENSE_TYPE
    inner join inserted
    on (PIMS_LEASE_LICENSE_TYPE.LEASE_LICENSE_TYPE_CODE = inserted.LEASE_LICENSE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_INSRNC_A_S_IUD_TR] ON PIMS_INSURANCE FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_INSURANCE_HIST set END_DATE_HIST = @curr_date where INSURANCE_ID in (select INSURANCE_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_INSURANCE_HIST ([INSURANCE_ID], [LEASE_ID], [INSURANCE_TYPE_CODE], [INSURER_ORG_ID], [INSURER_CONTACT_ID], [MOTI_RISK_MGMT_CONTACT_ID], [BCTFA_RISK_MGMT_CONTACT_ID], [INSURANCE_PAYEE_TYPE_CODE], [OTHER_INSURANCE_TYPE], [COVERAGE_DESCRIPTION], [COVERAGE_LIMIT], [INSURED_VALUE], [START_DATE], [EXPIRY_DATE], [RISK ASSESSMENT_COMPLETED_DATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _INSURANCE_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [INSURANCE_ID], [LEASE_ID], [INSURANCE_TYPE_CODE], [INSURER_ORG_ID], [INSURER_CONTACT_ID], [MOTI_RISK_MGMT_CONTACT_ID], [BCTFA_RISK_MGMT_CONTACT_ID], [INSURANCE_PAYEE_TYPE_CODE], [OTHER_INSURANCE_TYPE], [COVERAGE_DESCRIPTION], [COVERAGE_LIMIT], [INSURED_VALUE], [START_DATE], [EXPIRY_DATE], [RISK ASSESSMENT_COMPLETED_DATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_INSURANCE_H_ID_SEQ]) as [_INSURANCE_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_INSRNC_I_S_I_TR] ON PIMS_INSURANCE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_INSURANCE ("INSURANCE_ID",
      "LEASE_ID",
      "INSURANCE_TYPE_CODE",
      "INSURER_ORG_ID",
      "INSURER_CONTACT_ID",
      "MOTI_RISK_MGMT_CONTACT_ID",
      "BCTFA_RISK_MGMT_CONTACT_ID",
      "INSURANCE_PAYEE_TYPE_CODE",
      "OTHER_INSURANCE_TYPE",
      "COVERAGE_DESCRIPTION",
      "COVERAGE_LIMIT",
      "INSURED_VALUE",
      "START_DATE",
      "EXPIRY_DATE",
      "RISK ASSESSMENT_COMPLETED_DATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "INSURANCE_ID",
      "LEASE_ID",
      "INSURANCE_TYPE_CODE",
      "INSURER_ORG_ID",
      "INSURER_CONTACT_ID",
      "MOTI_RISK_MGMT_CONTACT_ID",
      "BCTFA_RISK_MGMT_CONTACT_ID",
      "INSURANCE_PAYEE_TYPE_CODE",
      "OTHER_INSURANCE_TYPE",
      "COVERAGE_DESCRIPTION",
      "COVERAGE_LIMIT",
      "INSURED_VALUE",
      "START_DATE",
      "EXPIRY_DATE",
      "RISK ASSESSMENT_COMPLETED_DATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_INSRNC_I_S_U_TR] ON PIMS_INSURANCE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.INSURANCE_ID = deleted.INSURANCE_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_INSURANCE
    set "INSURANCE_ID" = inserted."INSURANCE_ID",
      "LEASE_ID" = inserted."LEASE_ID",
      "INSURANCE_TYPE_CODE" = inserted."INSURANCE_TYPE_CODE",
      "INSURER_ORG_ID" = inserted."INSURER_ORG_ID",
      "INSURER_CONTACT_ID" = inserted."INSURER_CONTACT_ID",
      "MOTI_RISK_MGMT_CONTACT_ID" = inserted."MOTI_RISK_MGMT_CONTACT_ID",
      "BCTFA_RISK_MGMT_CONTACT_ID" = inserted."BCTFA_RISK_MGMT_CONTACT_ID",
      "INSURANCE_PAYEE_TYPE_CODE" = inserted."INSURANCE_PAYEE_TYPE_CODE",
      "OTHER_INSURANCE_TYPE" = inserted."OTHER_INSURANCE_TYPE",
      "COVERAGE_DESCRIPTION" = inserted."COVERAGE_DESCRIPTION",
      "COVERAGE_LIMIT" = inserted."COVERAGE_LIMIT",
      "INSURED_VALUE" = inserted."INSURED_VALUE",
      "START_DATE" = inserted."START_DATE",
      "EXPIRY_DATE" = inserted."EXPIRY_DATE",
      "RISK ASSESSMENT_COMPLETED_DATE" = inserted."RISK ASSESSMENT_COMPLETED_DATE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_INSURANCE
    inner join inserted
    on (PIMS_INSURANCE.INSURANCE_ID = inserted.INSURANCE_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_INSPAY_I_S_I_TR] ON PIMS_INSURANCE_PAYEE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_INSURANCE_PAYEE_TYPE ("INSURANCE_PAYEE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "INSURANCE_PAYEE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_INSPAY_I_S_U_TR] ON PIMS_INSURANCE_PAYEE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.INSURANCE_PAYEE_TYPE_CODE = deleted.INSURANCE_PAYEE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_INSURANCE_PAYEE_TYPE
    set "INSURANCE_PAYEE_TYPE_CODE" = inserted."INSURANCE_PAYEE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_INSURANCE_PAYEE_TYPE
    inner join inserted
    on (PIMS_INSURANCE_PAYEE_TYPE.INSURANCE_PAYEE_TYPE_CODE = inserted.INSURANCE_PAYEE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_INSPYT_I_S_I_TR] ON PIMS_INSURANCE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_INSURANCE_TYPE ("INSURANCE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "INSURANCE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_INSPYT_I_S_U_TR] ON PIMS_INSURANCE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.INSURANCE_TYPE_CODE = deleted.INSURANCE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_INSURANCE_TYPE
    set "INSURANCE_TYPE_CODE" = inserted."INSURANCE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_INSURANCE_TYPE
    inner join inserted
    on (PIMS_INSURANCE_TYPE.INSURANCE_TYPE_CODE = inserted.INSURANCE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SECDEP_A_S_IUD_TR] ON PIMS_SECURITY_DEPOSIT FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_SECURITY_DEPOSIT_HIST set END_DATE_HIST = @curr_date where SECURITY_DEPOSIT_ID in (select SECURITY_DEPOSIT_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_SECURITY_DEPOSIT_HIST ([SECURITY_DEPOSIT_ID], [LEASE_ID], [SEC_DEP_HOLDER_TYPE_CODE], [SECURITY_DEPOSIT_TYPE_CODE], [DESCRIPTION], [AMOUNT_PAID], [TOTAL_AMOUNT], [DEPOSIT_DATE], [ANNUAL_INTEREST_RATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _SECURITY_DEPOSIT_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [SECURITY_DEPOSIT_ID], [LEASE_ID], [SEC_DEP_HOLDER_TYPE_CODE], [SECURITY_DEPOSIT_TYPE_CODE], [DESCRIPTION], [AMOUNT_PAID], [TOTAL_AMOUNT], [DEPOSIT_DATE], [ANNUAL_INTEREST_RATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_SECURITY_DEPOSIT_H_ID_SEQ]) as [_SECURITY_DEPOSIT_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SECDEP_I_S_I_TR] ON PIMS_SECURITY_DEPOSIT INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_SECURITY_DEPOSIT ("SECURITY_DEPOSIT_ID",
      "LEASE_ID",
      "SEC_DEP_HOLDER_TYPE_CODE",
      "SECURITY_DEPOSIT_TYPE_CODE",
      "DESCRIPTION",
      "AMOUNT_PAID",
      "TOTAL_AMOUNT",
      "DEPOSIT_DATE",
      "ANNUAL_INTEREST_RATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "SECURITY_DEPOSIT_ID",
      "LEASE_ID",
      "SEC_DEP_HOLDER_TYPE_CODE",
      "SECURITY_DEPOSIT_TYPE_CODE",
      "DESCRIPTION",
      "AMOUNT_PAID",
      "TOTAL_AMOUNT",
      "DEPOSIT_DATE",
      "ANNUAL_INTEREST_RATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SECDEP_I_S_U_TR] ON PIMS_SECURITY_DEPOSIT INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.SECURITY_DEPOSIT_ID = deleted.SECURITY_DEPOSIT_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_SECURITY_DEPOSIT
    set "SECURITY_DEPOSIT_ID" = inserted."SECURITY_DEPOSIT_ID",
      "LEASE_ID" = inserted."LEASE_ID",
      "SEC_DEP_HOLDER_TYPE_CODE" = inserted."SEC_DEP_HOLDER_TYPE_CODE",
      "SECURITY_DEPOSIT_TYPE_CODE" = inserted."SECURITY_DEPOSIT_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "AMOUNT_PAID" = inserted."AMOUNT_PAID",
      "TOTAL_AMOUNT" = inserted."TOTAL_AMOUNT",
      "DEPOSIT_DATE" = inserted."DEPOSIT_DATE",
      "ANNUAL_INTEREST_RATE" = inserted."ANNUAL_INTEREST_RATE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_SECURITY_DEPOSIT
    inner join inserted
    on (PIMS_SECURITY_DEPOSIT.SECURITY_DEPOSIT_ID = inserted.SECURITY_DEPOSIT_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SECDPT_I_S_I_TR] ON PIMS_SECURITY_DEPOSIT_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_SECURITY_DEPOSIT_TYPE ("SECURITY_DEPOSIT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "SECURITY_DEPOSIT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SECDPT_I_S_U_TR] ON PIMS_SECURITY_DEPOSIT_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.SECURITY_DEPOSIT_TYPE_CODE = deleted.SECURITY_DEPOSIT_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_SECURITY_DEPOSIT_TYPE
    set "SECURITY_DEPOSIT_TYPE_CODE" = inserted."SECURITY_DEPOSIT_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_SECURITY_DEPOSIT_TYPE
    inner join inserted
    on (PIMS_SECURITY_DEPOSIT_TYPE.SECURITY_DEPOSIT_TYPE_CODE = inserted.SECURITY_DEPOSIT_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SCHLDT_I_S_I_TR] ON PIMS_SEC_DEP_HOLDER_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_SEC_DEP_HOLDER_TYPE ("SEC_DEP_HOLDER_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "SEC_DEP_HOLDER_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SCHLDT_I_S_U_TR] ON PIMS_SEC_DEP_HOLDER_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.SEC_DEP_HOLDER_TYPE_CODE = deleted.SEC_DEP_HOLDER_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_SEC_DEP_HOLDER_TYPE
    set "SEC_DEP_HOLDER_TYPE_CODE" = inserted."SEC_DEP_HOLDER_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_SEC_DEP_HOLDER_TYPE
    inner join inserted
    on (PIMS_SEC_DEP_HOLDER_TYPE.SEC_DEP_HOLDER_TYPE_CODE = inserted.SEC_DEP_HOLDER_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPRPTY_I_S_I_TR] ON PIMS_LEASE_PURPOSE_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PURPOSE_TYPE ("LEASE_PURPOSE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_PURPOSE_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPRPTY_I_S_U_TR] ON PIMS_LEASE_PURPOSE_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PURPOSE_TYPE_CODE = deleted.LEASE_PURPOSE_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PURPOSE_TYPE
    set "LEASE_PURPOSE_TYPE_CODE" = inserted."LEASE_PURPOSE_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PURPOSE_TYPE
    inner join inserted
    on (PIMS_LEASE_PURPOSE_TYPE.LEASE_PURPOSE_TYPE_CODE = inserted.LEASE_PURPOSE_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPTAX_A_S_IUD_TR] ON PIMS_PROPERTY_TAX FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_TAX_HIST set END_DATE_HIST = @curr_date where PROPERTY_TAX_ID in (select PROPERTY_TAX_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_TAX_HIST ([PROPERTY_TAX_ID], [PROPERTY_ID], [PROPERTY_TAX_REMIT_TYPE_CODE], [TAX_FOLIO_NO], [PAYMENT_AMOUNT], [LAST_PAYMENT_DATE], [PAYMENT_NOTES], [BCTFA_NOTIFICATION_DATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_TAX_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_TAX_ID], [PROPERTY_ID], [PROPERTY_TAX_REMIT_TYPE_CODE], [TAX_FOLIO_NO], [PAYMENT_AMOUNT], [LAST_PAYMENT_DATE], [PAYMENT_NOTES], [BCTFA_NOTIFICATION_DATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_TAX_H_ID_SEQ]) as [_PROPERTY_TAX_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPTAX_I_S_I_TR] ON PIMS_PROPERTY_TAX INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_TAX ("PROPERTY_TAX_ID",
      "PROPERTY_ID",
      "PROPERTY_TAX_REMIT_TYPE_CODE",
      "TAX_FOLIO_NO",
      "PAYMENT_AMOUNT",
      "LAST_PAYMENT_DATE",
      "PAYMENT_NOTES",
      "BCTFA_NOTIFICATION_DATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_TAX_ID",
      "PROPERTY_ID",
      "PROPERTY_TAX_REMIT_TYPE_CODE",
      "TAX_FOLIO_NO",
      "PAYMENT_AMOUNT",
      "LAST_PAYMENT_DATE",
      "PAYMENT_NOTES",
      "BCTFA_NOTIFICATION_DATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PRPTAX_I_S_U_TR] ON PIMS_PROPERTY_TAX INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_TAX_ID = deleted.PROPERTY_TAX_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_TAX
    set "PROPERTY_TAX_ID" = inserted."PROPERTY_TAX_ID",
      "PROPERTY_ID" = inserted."PROPERTY_ID",
      "PROPERTY_TAX_REMIT_TYPE_CODE" = inserted."PROPERTY_TAX_REMIT_TYPE_CODE",
      "TAX_FOLIO_NO" = inserted."TAX_FOLIO_NO",
      "PAYMENT_AMOUNT" = inserted."PAYMENT_AMOUNT",
      "LAST_PAYMENT_DATE" = inserted."LAST_PAYMENT_DATE",
      "PAYMENT_NOTES" = inserted."PAYMENT_NOTES",
      "BCTFA_NOTIFICATION_DATE" = inserted."BCTFA_NOTIFICATION_DATE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_TAX
    inner join inserted
    on (PIMS_PROPERTY_TAX.PROPERTY_TAX_ID = inserted.PROPERTY_TAX_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PTRMTT_I_S_I_TR] ON PIMS_PROPERTY_TAX_REMIT_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_TAX_REMIT_TYPE ("PROPERTY_TAX_REMIT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_TAX_REMIT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PTRMTT_I_S_U_TR] ON PIMS_PROPERTY_TAX_REMIT_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_TAX_REMIT_TYPE_CODE = deleted.PROPERTY_TAX_REMIT_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_TAX_REMIT_TYPE
    set "PROPERTY_TAX_REMIT_TYPE_CODE" = inserted."PROPERTY_TAX_REMIT_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_TAX_REMIT_TYPE
    inner join inserted
    on (PIMS_PROPERTY_TAX_REMIT_TYPE.PROPERTY_TAX_REMIT_TYPE_CODE = inserted.PROPERTY_TAX_REMIT_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SPDCLT_I_S_I_TR] ON PIMS_SURPLUS_DECLARATION_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_SURPLUS_DECLARATION_TYPE ("SURPLUS_DECLARATION_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "SURPLUS_DECLARATION_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SPDCLT_I_S_U_TR] ON PIMS_SURPLUS_DECLARATION_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.SURPLUS_DECLARATION_TYPE_CODE = deleted.SURPLUS_DECLARATION_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_SURPLUS_DECLARATION_TYPE
    set "SURPLUS_DECLARATION_TYPE_CODE" = inserted."SURPLUS_DECLARATION_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_SURPLUS_DECLARATION_TYPE
    inner join inserted
    on (PIMS_SURPLUS_DECLARATION_TYPE.SURPLUS_DECLARATION_TYPE_CODE = inserted.SURPLUS_DECLARATION_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PIMPRV_A_S_IUD_TR] ON PIMS_PROPERTY_IMPROVEMENT FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_PROPERTY_IMPROVEMENT_HIST set END_DATE_HIST = @curr_date where PROPERTY_IMPROVEMENT_ID in (select PROPERTY_IMPROVEMENT_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_PROPERTY_IMPROVEMENT_HIST ([PROPERTY_IMPROVEMENT_ID], [PROPERTY_LEASE_ID], [PROPERTY_IMPROVEMENT_TYPE_CODE], [IMPROVEMENT_DESCRIPTION], [STRUCTURE_SIZE], [UNIT], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _PROPERTY_IMPROVEMENT_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [PROPERTY_IMPROVEMENT_ID], [PROPERTY_LEASE_ID], [PROPERTY_IMPROVEMENT_TYPE_CODE], [IMPROVEMENT_DESCRIPTION], [STRUCTURE_SIZE], [UNIT], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_PROPERTY_IMPROVEMENT_H_ID_SEQ]) as [_PROPERTY_IMPROVEMENT_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PIMPRV_I_S_U_TR] ON PIMS_PROPERTY_IMPROVEMENT INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_IMPROVEMENT_ID = deleted.PROPERTY_IMPROVEMENT_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_IMPROVEMENT
    set "PROPERTY_IMPROVEMENT_ID" = inserted."PROPERTY_IMPROVEMENT_ID",
      "PROPERTY_LEASE_ID" = inserted."PROPERTY_LEASE_ID",
      "PROPERTY_IMPROVEMENT_TYPE_CODE" = inserted."PROPERTY_IMPROVEMENT_TYPE_CODE",
      "IMPROVEMENT_DESCRIPTION" = inserted."IMPROVEMENT_DESCRIPTION",
      "STRUCTURE_SIZE" = inserted."STRUCTURE_SIZE",
      "UNIT" = inserted."UNIT",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_IMPROVEMENT
    inner join inserted
    on (PIMS_PROPERTY_IMPROVEMENT.PROPERTY_IMPROVEMENT_ID = inserted.PROPERTY_IMPROVEMENT_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PIMPRV_I_S_I_TR] ON PIMS_PROPERTY_IMPROVEMENT INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_IMPROVEMENT ("PROPERTY_IMPROVEMENT_ID",
      "PROPERTY_LEASE_ID",
      "PROPERTY_IMPROVEMENT_TYPE_CODE",
      "IMPROVEMENT_DESCRIPTION",
      "STRUCTURE_SIZE",
      "UNIT",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "PROPERTY_IMPROVEMENT_ID",
      "PROPERTY_LEASE_ID",
      "PROPERTY_IMPROVEMENT_TYPE_CODE",
      "IMPROVEMENT_DESCRIPTION",
      "STRUCTURE_SIZE",
      "UNIT",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PIMPRT_I_S_I_TR] ON PIMS_PROPERTY_IMPROVEMENT_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_PROPERTY_IMPROVEMENT_TYPE ("PROPERTY_IMPROVEMENT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "PROPERTY_IMPROVEMENT_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_PIMPRT_I_S_U_TR] ON PIMS_PROPERTY_IMPROVEMENT_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.PROPERTY_IMPROVEMENT_TYPE_CODE = deleted.PROPERTY_IMPROVEMENT_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_PROPERTY_IMPROVEMENT_TYPE
    set "PROPERTY_IMPROVEMENT_TYPE_CODE" = inserted."PROPERTY_IMPROVEMENT_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_PROPERTY_IMPROVEMENT_TYPE
    inner join inserted
    on (PIMS_PROPERTY_IMPROVEMENT_TYPE.PROPERTY_IMPROVEMENT_TYPE_CODE = inserted.PROPERTY_IMPROVEMENT_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SDRTRN_A_S_IUD_TR] ON PIMS_SECURITY_DEPOSIT_RETURN FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_SECURITY_DEPOSIT_RETURN_HIST set END_DATE_HIST = @curr_date where SECURITY_DEPOSIT_RETURN_ID in (select SECURITY_DEPOSIT_RETURN_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_SECURITY_DEPOSIT_RETURN_HIST ([SECURITY_DEPOSIT_RETURN_ID], [LEASE_ID], [SECURITY_DEPOSIT_TYPE_CODE], [TERMINATION_DATE], [DEPOSIT_TOTAL], [CLAIMS_AGAINST], [RETURN_AMOUNT], [RETURN_DATE], [CHEQUE_NUMBER], [PAYEE_NAME], [PAYEE_ADDRESS], [TERMINATION_NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _SECURITY_DEPOSIT_RETURN_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [SECURITY_DEPOSIT_RETURN_ID], [LEASE_ID], [SECURITY_DEPOSIT_TYPE_CODE], [TERMINATION_DATE], [DEPOSIT_TOTAL], [CLAIMS_AGAINST], [RETURN_AMOUNT], [RETURN_DATE], [CHEQUE_NUMBER], [PAYEE_NAME], [PAYEE_ADDRESS], [TERMINATION_NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_SECURITY_DEPOSIT_RETURN_H_ID_SEQ]) as [_SECURITY_DEPOSIT_RETURN_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SDRTRN_I_S_I_TR] ON PIMS_SECURITY_DEPOSIT_RETURN INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_SECURITY_DEPOSIT_RETURN ("SECURITY_DEPOSIT_RETURN_ID",
      "LEASE_ID",
      "SECURITY_DEPOSIT_TYPE_CODE",
      "TERMINATION_DATE",
      "DEPOSIT_TOTAL",
      "CLAIMS_AGAINST",
      "RETURN_AMOUNT",
      "RETURN_DATE",
      "CHEQUE_NUMBER",
      "PAYEE_NAME",
      "PAYEE_ADDRESS",
      "TERMINATION_NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "SECURITY_DEPOSIT_RETURN_ID",
      "LEASE_ID",
      "SECURITY_DEPOSIT_TYPE_CODE",
      "TERMINATION_DATE",
      "DEPOSIT_TOTAL",
      "CLAIMS_AGAINST",
      "RETURN_AMOUNT",
      "RETURN_DATE",
      "CHEQUE_NUMBER",
      "PAYEE_NAME",
      "PAYEE_ADDRESS",
      "TERMINATION_NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_SDRTRN_I_S_U_TR] ON PIMS_SECURITY_DEPOSIT_RETURN INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.SECURITY_DEPOSIT_RETURN_ID = deleted.SECURITY_DEPOSIT_RETURN_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_SECURITY_DEPOSIT_RETURN
    set "SECURITY_DEPOSIT_RETURN_ID" = inserted."SECURITY_DEPOSIT_RETURN_ID",
      "LEASE_ID" = inserted."LEASE_ID",
      "SECURITY_DEPOSIT_TYPE_CODE" = inserted."SECURITY_DEPOSIT_TYPE_CODE",
      "TERMINATION_DATE" = inserted."TERMINATION_DATE",
      "DEPOSIT_TOTAL" = inserted."DEPOSIT_TOTAL",
      "CLAIMS_AGAINST" = inserted."CLAIMS_AGAINST",
      "RETURN_AMOUNT" = inserted."RETURN_AMOUNT",
      "RETURN_DATE" = inserted."RETURN_DATE",
      "CHEQUE_NUMBER" = inserted."CHEQUE_NUMBER",
      "PAYEE_NAME" = inserted."PAYEE_NAME",
      "PAYEE_ADDRESS" = inserted."PAYEE_ADDRESS",
      "TERMINATION_NOTE" = inserted."TERMINATION_NOTE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_SECURITY_DEPOSIT_RETURN
    inner join inserted
    on (PIMS_SECURITY_DEPOSIT_RETURN.SECURITY_DEPOSIT_RETURN_ID = inserted.SECURITY_DEPOSIT_RETURN_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LINITT_I_S_U_TR] ON PIMS_LEASE_INITIATOR_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_INITIATOR_TYPE_CODE = deleted.LEASE_INITIATOR_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_INITIATOR_TYPE
    set "LEASE_INITIATOR_TYPE_CODE" = inserted."LEASE_INITIATOR_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_INITIATOR_TYPE
    inner join inserted
    on (PIMS_LEASE_INITIATOR_TYPE.LEASE_INITIATOR_TYPE_CODE = inserted.LEASE_INITIATOR_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LINITT_I_S_I_TR] ON PIMS_LEASE_INITIATOR_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_INITIATOR_TYPE ("LEASE_INITIATOR_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_INITIATOR_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LRESPT_I_S_I_TR] ON PIMS_LEASE_RESPONSIBILITY_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_RESPONSIBILITY_TYPE ("LEASE_RESPONSIBILITY_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_RESPONSIBILITY_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LRESPT_I_S_U_TR] ON PIMS_LEASE_RESPONSIBILITY_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_RESPONSIBILITY_TYPE_CODE = deleted.LEASE_RESPONSIBILITY_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_RESPONSIBILITY_TYPE
    set "LEASE_RESPONSIBILITY_TYPE_CODE" = inserted."LEASE_RESPONSIBILITY_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_RESPONSIBILITY_TYPE
    inner join inserted
    on (PIMS_LEASE_RESPONSIBILITY_TYPE.LEASE_RESPONSIBILITY_TYPE_CODE = inserted.LEASE_RESPONSIBILITY_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSTERM_I_S_I_TR] ON PIMS_LEASE_TERM INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_TERM ("LEASE_TERM_ID",
      "LEASE_ID",
      "LEASE_TERM_STATUS_TYPE_CODE",
      "TERM_START_DATE",
      "TERM_EXPIRY_DATE",
      "TERM_RENEWAL_DATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "LEASE_TERM_ID",
      "LEASE_ID",
      "LEASE_TERM_STATUS_TYPE_CODE",
      "TERM_START_DATE",
      "TERM_EXPIRY_DATE",
      "TERM_RENEWAL_DATE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSTERM_I_S_U_TR] ON PIMS_LEASE_TERM INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_TERM_ID = deleted.LEASE_TERM_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_TERM
    set "LEASE_TERM_ID" = inserted."LEASE_TERM_ID",
      "LEASE_ID" = inserted."LEASE_ID",
      "LEASE_TERM_STATUS_TYPE_CODE" = inserted."LEASE_TERM_STATUS_TYPE_CODE",
      "TERM_START_DATE" = inserted."TERM_START_DATE",
      "TERM_EXPIRY_DATE" = inserted."TERM_EXPIRY_DATE",
      "TERM_RENEWAL_DATE" = inserted."TERM_RENEWAL_DATE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_TERM
    inner join inserted
    on (PIMS_LEASE_TERM.LEASE_TERM_ID = inserted.LEASE_TERM_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSTERM_A_S_IUD_TR] ON PIMS_LEASE_TERM FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_LEASE_TERM_HIST set END_DATE_HIST = @curr_date where LEASE_TERM_ID in (select LEASE_TERM_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_LEASE_TERM_HIST ([LEASE_TERM_ID], [LEASE_ID], [LEASE_TERM_STATUS_TYPE_CODE], [TERM_START_DATE], [TERM_EXPIRY_DATE], [TERM_RENEWAL_DATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _LEASE_TERM_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [LEASE_TERM_ID], [LEASE_ID], [LEASE_TERM_STATUS_TYPE_CODE], [TERM_START_DATE], [TERM_EXPIRY_DATE], [TERM_RENEWAL_DATE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_LEASE_TERM_H_ID_SEQ]) as [_LEASE_TERM_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LTRMST_I_S_U_TR] ON PIMS_LEASE_TERM_STATUS_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_TERM_STATUS_TYPE_CODE = deleted.LEASE_TERM_STATUS_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_TERM_STATUS_TYPE
    set "LEASE_TERM_STATUS_TYPE_CODE" = inserted."LEASE_TERM_STATUS_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_TERM_STATUS_TYPE
    inner join inserted
    on (PIMS_LEASE_TERM_STATUS_TYPE.LEASE_TERM_STATUS_TYPE_CODE = inserted.LEASE_TERM_STATUS_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LTRMST_I_S_I_TR] ON PIMS_LEASE_TERM_STATUS_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_TERM_STATUS_TYPE ("LEASE_TERM_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_TERM_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPYPER_I_S_U_TR] ON PIMS_LEASE_PAYMENT_PERIOD INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PAYMENT_PERIOD_ID = deleted.LEASE_PAYMENT_PERIOD_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PAYMENT_PERIOD
    set "LEASE_PAYMENT_PERIOD_ID" = inserted."LEASE_PAYMENT_PERIOD_ID",
      "PERIOD_START_DATE" = inserted."PERIOD_START_DATE",
      "IS_PERIOD_CLOSED" = inserted."IS_PERIOD_CLOSED",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PAYMENT_PERIOD
    inner join inserted
    on (PIMS_LEASE_PAYMENT_PERIOD.LEASE_PAYMENT_PERIOD_ID = inserted.LEASE_PAYMENT_PERIOD_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPYPER_I_S_I_TR] ON PIMS_LEASE_PAYMENT_PERIOD INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PAYMENT_PERIOD ("LEASE_PAYMENT_PERIOD_ID",
      "PERIOD_START_DATE",
      "IS_PERIOD_CLOSED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "LEASE_PAYMENT_PERIOD_ID",
      "PERIOD_START_DATE",
      "IS_PERIOD_CLOSED",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPYPER_A_S_IUD_TR] ON PIMS_LEASE_PAYMENT_PERIOD FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_LEASE_PAYMENT_PERIOD_HIST set END_DATE_HIST = @curr_date where LEASE_PAYMENT_PERIOD_ID in (select LEASE_PAYMENT_PERIOD_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_LEASE_PAYMENT_PERIOD_HIST ([LEASE_PAYMENT_PERIOD_ID], [PERIOD_START_DATE], [IS_PERIOD_CLOSED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _LEASE_PAYMENT_PERIOD_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [LEASE_PAYMENT_PERIOD_ID], [PERIOD_START_DATE], [IS_PERIOD_CLOSED], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_LEASE_PAYMENT_PERIOD_H_ID_SEQ]) as [_LEASE_PAYMENT_PERIOD_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPMMT_I_S_I_TR] ON PIMS_LEASE_PAYMENT_METHOD_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PAYMENT_METHOD_TYPE ("LEASE_PAYMENT_METHOD_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_PAYMENT_METHOD_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPMMT_I_S_U_TR] ON PIMS_LEASE_PAYMENT_METHOD_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PAYMENT_METHOD_TYPE_CODE = deleted.LEASE_PAYMENT_METHOD_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PAYMENT_METHOD_TYPE
    set "LEASE_PAYMENT_METHOD_TYPE_CODE" = inserted."LEASE_PAYMENT_METHOD_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PAYMENT_METHOD_TYPE
    inner join inserted
    on (PIMS_LEASE_PAYMENT_METHOD_TYPE.LEASE_PAYMENT_METHOD_TYPE_CODE = inserted.LEASE_PAYMENT_METHOD_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPFCST_A_S_IUD_TR] ON PIMS_LEASE_PAYMENT_FORECAST FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_LEASE_PAYMENT_FORECAST_HIST set END_DATE_HIST = @curr_date where LEASE_PAYMENT_FORECAST_ID in (select LEASE_PAYMENT_FORECAST_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_LEASE_PAYMENT_FORECAST_HIST ([LEASE_PAYMENT_FORECAST_ID], [LEASE_TERM_ID], [LEASE_PAYMENT_PERIOD_ID], [LEASE_PAYMENT_STATUS_TYPE_CODE], [PAYMENT_DUE_DATE], [FORECAST_PAYMENT_PRE_TAX], [FORECAST_PAYMENT_PST], [FORECAST_PAYMENT_GST], [FORECAST_PAYMENT_TOTAL], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _LEASE_PAYMENT_FORECAST_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [LEASE_PAYMENT_FORECAST_ID], [LEASE_TERM_ID], [LEASE_PAYMENT_PERIOD_ID], [LEASE_PAYMENT_STATUS_TYPE_CODE], [PAYMENT_DUE_DATE], [FORECAST_PAYMENT_PRE_TAX], [FORECAST_PAYMENT_PST], [FORECAST_PAYMENT_GST], [FORECAST_PAYMENT_TOTAL], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_LEASE_PAYMENT_FORECAST_H_ID_SEQ]) as [_LEASE_PAYMENT_FORECAST_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPFCST_I_S_U_TR] ON PIMS_LEASE_PAYMENT_FORECAST INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PAYMENT_FORECAST_ID = deleted.LEASE_PAYMENT_FORECAST_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PAYMENT_FORECAST
    set "LEASE_PAYMENT_FORECAST_ID" = inserted."LEASE_PAYMENT_FORECAST_ID",
      "LEASE_TERM_ID" = inserted."LEASE_TERM_ID",
      "LEASE_PAYMENT_PERIOD_ID" = inserted."LEASE_PAYMENT_PERIOD_ID",
      "LEASE_PAYMENT_STATUS_TYPE_CODE" = inserted."LEASE_PAYMENT_STATUS_TYPE_CODE",
      "PAYMENT_DUE_DATE" = inserted."PAYMENT_DUE_DATE",
      "FORECAST_PAYMENT_PRE_TAX" = inserted."FORECAST_PAYMENT_PRE_TAX",
      "FORECAST_PAYMENT_PST" = inserted."FORECAST_PAYMENT_PST",
      "FORECAST_PAYMENT_GST" = inserted."FORECAST_PAYMENT_GST",
      "FORECAST_PAYMENT_TOTAL" = inserted."FORECAST_PAYMENT_TOTAL",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PAYMENT_FORECAST
    inner join inserted
    on (PIMS_LEASE_PAYMENT_FORECAST.LEASE_PAYMENT_FORECAST_ID = inserted.LEASE_PAYMENT_FORECAST_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPFCST_I_S_I_TR] ON PIMS_LEASE_PAYMENT_FORECAST INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PAYMENT_FORECAST ("LEASE_PAYMENT_FORECAST_ID",
      "LEASE_TERM_ID",
      "LEASE_PAYMENT_PERIOD_ID",
      "LEASE_PAYMENT_STATUS_TYPE_CODE",
      "PAYMENT_DUE_DATE",
      "FORECAST_PAYMENT_PRE_TAX",
      "FORECAST_PAYMENT_PST",
      "FORECAST_PAYMENT_GST",
      "FORECAST_PAYMENT_TOTAL",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "LEASE_PAYMENT_FORECAST_ID",
      "LEASE_TERM_ID",
      "LEASE_PAYMENT_PERIOD_ID",
      "LEASE_PAYMENT_STATUS_TYPE_CODE",
      "PAYMENT_DUE_DATE",
      "FORECAST_PAYMENT_PRE_TAX",
      "FORECAST_PAYMENT_PST",
      "FORECAST_PAYMENT_GST",
      "FORECAST_PAYMENT_TOTAL",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPYMT_I_S_I_TR] ON PIMS_LEASE_PAYMENT INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PAYMENT ("LEASE_PAYMENT_ID",
      "LEASE_TERM_ID",
      "LEASE_PAYMENT_PERIOD_ID",
      "LEASE_PAYMENT_METHOD_TYPE_CODE",
      "PAYMENT_RECEIVED_DATE",
      "PAYMENT_AMOUNT_PRE_TAX",
      "PAYMENT_AMOUNT_PST",
      "PAYMENT_AMOUNT_GST",
      "PAYMENT_AMOUNT_TOTAL",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY")
    select "LEASE_PAYMENT_ID",
      "LEASE_TERM_ID",
      "LEASE_PAYMENT_PERIOD_ID",
      "LEASE_PAYMENT_METHOD_TYPE_CODE",
      "PAYMENT_RECEIVED_DATE",
      "PAYMENT_AMOUNT_PRE_TAX",
      "PAYMENT_AMOUNT_PST",
      "PAYMENT_AMOUNT_GST",
      "PAYMENT_AMOUNT_TOTAL",
      "NOTE",
      "CONCURRENCY_CONTROL_NUMBER",
      "APP_CREATE_TIMESTAMP",
      "APP_CREATE_USERID",
      "APP_CREATE_USER_GUID",
      "APP_CREATE_USER_DIRECTORY",
      "APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPYMT_I_S_U_TR] ON PIMS_LEASE_PAYMENT INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PAYMENT_ID = deleted.LEASE_PAYMENT_ID)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PAYMENT
    set "LEASE_PAYMENT_ID" = inserted."LEASE_PAYMENT_ID",
      "LEASE_TERM_ID" = inserted."LEASE_TERM_ID",
      "LEASE_PAYMENT_PERIOD_ID" = inserted."LEASE_PAYMENT_PERIOD_ID",
      "LEASE_PAYMENT_METHOD_TYPE_CODE" = inserted."LEASE_PAYMENT_METHOD_TYPE_CODE",
      "PAYMENT_RECEIVED_DATE" = inserted."PAYMENT_RECEIVED_DATE",
      "PAYMENT_AMOUNT_PRE_TAX" = inserted."PAYMENT_AMOUNT_PRE_TAX",
      "PAYMENT_AMOUNT_PST" = inserted."PAYMENT_AMOUNT_PST",
      "PAYMENT_AMOUNT_GST" = inserted."PAYMENT_AMOUNT_GST",
      "PAYMENT_AMOUNT_TOTAL" = inserted."PAYMENT_AMOUNT_TOTAL",
      "NOTE" = inserted."NOTE",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER",
      "APP_LAST_UPDATE_TIMESTAMP" = inserted."APP_LAST_UPDATE_TIMESTAMP",
      "APP_LAST_UPDATE_USERID" = inserted."APP_LAST_UPDATE_USERID",
      "APP_LAST_UPDATE_USER_GUID" = inserted."APP_LAST_UPDATE_USER_GUID",
      "APP_LAST_UPDATE_USER_DIRECTORY" = inserted."APP_LAST_UPDATE_USER_DIRECTORY"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PAYMENT
    inner join inserted
    on (PIMS_LEASE_PAYMENT.LEASE_PAYMENT_ID = inserted.LEASE_PAYMENT_ID);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LSPYMT_A_S_IUD_TR] ON PIMS_LEASE_PAYMENT FOR INSERT, UPDATE, DELETE AS
SET NOCOUNT ON
BEGIN TRY
DECLARE @curr_date datetime;
SET @curr_date = getutcdate();
  IF NOT EXISTS(SELECT * FROM inserted) AND NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- historical
  IF EXISTS(SELECT * FROM deleted)
    update PIMS_LEASE_PAYMENT_HIST set END_DATE_HIST = @curr_date where LEASE_PAYMENT_ID in (select LEASE_PAYMENT_ID from deleted) and END_DATE_HIST is null;

  IF EXISTS(SELECT * FROM inserted)
    insert into PIMS_LEASE_PAYMENT_HIST ([LEASE_PAYMENT_ID], [LEASE_TERM_ID], [LEASE_PAYMENT_PERIOD_ID], [LEASE_PAYMENT_METHOD_TYPE_CODE], [PAYMENT_RECEIVED_DATE], [PAYMENT_AMOUNT_PRE_TAX], [PAYMENT_AMOUNT_PST], [PAYMENT_AMOUNT_GST], [PAYMENT_AMOUNT_TOTAL], [NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], _LEASE_PAYMENT_HIST_ID, END_DATE_HIST, EFFECTIVE_DATE_HIST)
      select [LEASE_PAYMENT_ID], [LEASE_TERM_ID], [LEASE_PAYMENT_PERIOD_ID], [LEASE_PAYMENT_METHOD_TYPE_CODE], [PAYMENT_RECEIVED_DATE], [PAYMENT_AMOUNT_PRE_TAX], [PAYMENT_AMOUNT_PST], [PAYMENT_AMOUNT_GST], [PAYMENT_AMOUNT_TOTAL], [NOTE], [CONCURRENCY_CONTROL_NUMBER], [APP_CREATE_TIMESTAMP], [APP_CREATE_USERID], [APP_CREATE_USER_GUID], [APP_CREATE_USER_DIRECTORY], [APP_LAST_UPDATE_TIMESTAMP], [APP_LAST_UPDATE_USERID], [APP_LAST_UPDATE_USER_GUID], [APP_LAST_UPDATE_USER_DIRECTORY], [DB_CREATE_TIMESTAMP], [DB_CREATE_USERID], [DB_LAST_UPDATE_TIMESTAMP], [DB_LAST_UPDATE_USERID], (next value for [dbo].[PIMS_LEASE_PAYMENT_H_ID_SEQ]) as [_LEASE_PAYMENT_HIST_ID], null as [END_DATE_HIST], @curr_date as [EFFECTIVE_DATE_HIST] from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPSTST_I_S_I_TR] ON PIMS_LEASE_PAYMENT_STATUS_TYPE INSTEAD OF INSERT AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM inserted)
    RETURN;


  insert into PIMS_LEASE_PAYMENT_STATUS_TYPE ("LEASE_PAYMENT_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER")
    select "LEASE_PAYMENT_STATUS_TYPE_CODE",
      "DESCRIPTION",
      "IS_DISABLED",
      "DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER"
    from inserted;

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO


CREATE TRIGGER [dbo].[PIMS_LPSTST_I_S_U_TR] ON PIMS_LEASE_PAYMENT_STATUS_TYPE INSTEAD OF UPDATE AS
SET NOCOUNT ON
BEGIN TRY
  IF NOT EXISTS(SELECT * FROM deleted)
    RETURN;

  -- validate concurrency control
  if exists (select 1 from inserted, deleted where inserted.CONCURRENCY_CONTROL_NUMBER != deleted.CONCURRENCY_CONTROL_NUMBER+1 AND inserted.LEASE_PAYMENT_STATUS_TYPE_CODE = deleted.LEASE_PAYMENT_STATUS_TYPE_CODE)
    raiserror('CONCURRENCY FAILURE.',16,1)


  -- update statement
  update PIMS_LEASE_PAYMENT_STATUS_TYPE
    set "LEASE_PAYMENT_STATUS_TYPE_CODE" = inserted."LEASE_PAYMENT_STATUS_TYPE_CODE",
      "DESCRIPTION" = inserted."DESCRIPTION",
      "IS_DISABLED" = inserted."IS_DISABLED",
      "DISPLAY_ORDER" = inserted."DISPLAY_ORDER",
      "CONCURRENCY_CONTROL_NUMBER" = inserted."CONCURRENCY_CONTROL_NUMBER"
    , DB_LAST_UPDATE_TIMESTAMP = getutcdate()
    , DB_LAST_UPDATE_USERID = user_name()
    from PIMS_LEASE_PAYMENT_STATUS_TYPE
    inner join inserted
    on (PIMS_LEASE_PAYMENT_STATUS_TYPE.LEASE_PAYMENT_STATUS_TYPE_CODE = inserted.LEASE_PAYMENT_STATUS_TYPE_CODE);

END TRY
BEGIN CATCH
   IF @@trancount > 0 ROLLBACK TRANSACTION
   EXEC pims_error_handling
END CATCH;
GO

