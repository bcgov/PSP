<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Schema Compare  and Sparse_Update_Column</title>
<style type="text/css">
body { font-family:"Verdana", monospace; font-size:11px; }
.diff { border-width:1px; border-style:solid; border-color:gray; width:100%; padding: 0 0 0 0; font-family:"Verdana", monospace; font-size:11px; }td { padding: 0 3 0 3; }
tr { padding: 0 0 0 0; }
.L { width:4%; background:#e8e8e8; vertical-align:top; }
.B { width:46%; background:#e8e8e8; }
.U { width:46%; color:#808080; }
.A { width:46%; background:#c8f2c8; font-weight: bold; }
.D { width:46%; background:#ffded8; font-weight: bold; }
.C {  width:46%; background:#cad9fa; }
.SA {  background:#c8f2c8; }
.SD {  background:#ffded8; }
.SC {  background:#cad9fa; }
.HI { font-weight: bold; background:#ffff00; }
.Hr { font-weight: bold; font-size:125%; border-width:1px; border-style:solid; border-color:gray; padding: 2 2 2 2; }
</style>
</head>
<body>
<table class="diff" style="border-width:0px;"><tr><td style="padding-right:80px">2 Difference(s)</td><td style="background:#ffded8; padding-left:20px;">Only in source</td><td style="background:#cad9fa; padding-left:20px;">Both different</td><td style="background:#c8f2c8; padding-left:20px;">Only in target</td></tr></table>
<br>
<table class="diff">
<tr><td colspan=2 class="Hr"></td><td colspan=2 class="Hr">Sparse_Update_Column</td></tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">1</td>
<td class="A">&#x200B;--&nbsp;-----&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">2</td>
<td class="A">&#x200B;--&nbsp;Creat&#x200B;e&nbsp;functi&#x200B;on&nbsp;pims_&#x200B;Sparse_U&#x200B;pdate_Co&#x200B;lumn&nbsp;to&nbsp;&#x200B;return&nbsp;t&#x200B;he&nbsp;forma&#x200B;tted&nbsp;upd&#x200B;ate&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">3</td>
<td class="A">&#x200B;--&nbsp;check&#x200B;&nbsp;for&nbsp;eac&#x200B;h&nbsp;candia&#x200B;dte&nbsp;colu&#x200B;mn.</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">4</td>
<td class="A">&#x200B;--&nbsp;-----&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------&#x200B;--------</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">5</td>
<td class="A">&#x200B;CREATE&nbsp;F&#x200B;UNCTION&nbsp;&#x200B;Sparse_U&#x200B;pdate_Co&#x200B;lumn&nbsp;(@T&#x200B;ableName&#x200B;&nbsp;varchar&#x200B;(100))</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">6</td>
<td class="A">&#x200B;RETURNS&nbsp;&#x200B;varchar(&#x200B;max)</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">7</td>
<td class="A">&#x200B;AS</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">8</td>
<td class="A">&#x200B;BEGIN</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">9</td>
<td class="A">&#x200B;&nbsp;&nbsp;DECLAR&#x200B;E&nbsp;@tmpVa&#x200B;l&nbsp;varcha&#x200B;r(max)&nbsp;=&#x200B;&nbsp;'';</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">10</td>
<td class="A">&#x200B;&nbsp;&nbsp;DECLAR&#x200B;E&nbsp;@retVa&#x200B;l&nbsp;varcha&#x200B;r(max)&nbsp;=&#x200B;&nbsp;'';</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">11</td>
<td class="A">&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">12</td>
<td class="A">&#x200B;&nbsp;&nbsp;--&nbsp;Que&#x200B;ry&nbsp;to&nbsp;re&#x200B;turn&nbsp;che&#x200B;cks&nbsp;on&nbsp;t&#x200B;he&nbsp;updat&#x200B;able&nbsp;col&#x200B;umns&nbsp;in&nbsp;&#x200B;the&nbsp;spec&#x200B;ified&nbsp;ta&#x200B;ble.</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">13</td>
<td class="A">&#x200B;&nbsp;&nbsp;DECLAR&#x200B;E&nbsp;sql_st&#x200B;atement&nbsp;&#x200B;CURSOR&nbsp;F&#x200B;OR</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">14</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;SELE&#x200B;CT&nbsp;&nbsp;&nbsp;CON&#x200B;CAT('IF&nbsp;&#x200B;UPDATE('&#x200B;,&nbsp;COL.CO&#x200B;LUMN_NAM&#x200B;E,&nbsp;')',&nbsp;&#x200B;CHAR(10)&#x200B;,&nbsp;'&nbsp;&nbsp;BEG&#x200B;IN&nbsp;',&nbsp;CH&#x200B;AR(10),&nbsp;&#x200B;'&nbsp;&nbsp;updat&#x200B;e&nbsp;',&nbsp;COL&#x200B;.TABLE_N&#x200B;AME,&nbsp;CHA&#x200B;R(10),&nbsp;'&#x200B;&nbsp;&nbsp;set&nbsp;"'&#x200B;,&nbsp;COL.CO&#x200B;LUMN_NAM&#x200B;E,&nbsp;'"&nbsp;=&nbsp;&#x200B;inserted&#x200B;."',&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME,&nbsp;'"&#x200B;',&nbsp;CHAR(&#x200B;10),&nbsp;'&nbsp;&nbsp;&#x200B;from&nbsp;',&nbsp;&#x200B;COL.TABL&#x200B;E_NAME,&nbsp;&#x200B;CHAR(10)&#x200B;,&nbsp;'&nbsp;&nbsp;inn&#x200B;er&nbsp;join&nbsp;&#x200B;inserted&#x200B;',&nbsp;CHAR(&#x200B;10),&nbsp;'&nbsp;&nbsp;&#x200B;on&nbsp;(',&nbsp;C&#x200B;OL.TABLE&#x200B;_NAME,&nbsp;'&#x200B;.',&nbsp;COL.&#x200B;COLUMN_N&#x200B;AME,&nbsp;'&nbsp;=&#x200B;&nbsp;inserte&#x200B;d.',&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME,&nbsp;')&#x200B;;',&nbsp;CHAR&#x200B;(10),&nbsp;'&nbsp;&#x200B;&nbsp;END',&nbsp;C&#x200B;HAR(10),&#x200B;&nbsp;CHAR(10&#x200B;))&nbsp;AS&nbsp;UP&#x200B;DATE_STR</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">15</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;FROM&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inf&#x200B;ormation&#x200B;_schema.&#x200B;columns&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;COL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEF&#x200B;T&nbsp;JOIN</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">16</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inf&#x200B;ormation&#x200B;_schema.&#x200B;constrai&#x200B;nt_colum&#x200B;n_usage&nbsp;&#x200B;USG&nbsp;ON&nbsp;U&#x200B;SG.TABLE&#x200B;_NAME&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;=&nbsp;COL&#x200B;.TABLE_N&#x200B;AME</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">17</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;AND&nbsp;U&#x200B;SG.COLUM&#x200B;N_NAME&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;=&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME&nbsp;LEF&#x200B;T&nbsp;JOIN</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">18</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inf&#x200B;ormation&#x200B;_schema.&#x200B;table_co&#x200B;nstraint&#x200B;s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;CON&nbsp;ON&nbsp;C&#x200B;ON.TABLE&#x200B;_NAME&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;=&nbsp;USG&#x200B;.TABLE_N&#x200B;AME</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">19</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;AND&nbsp;C&#x200B;ON.CONST&#x200B;RAINT_NA&#x200B;ME&nbsp;=&nbsp;USG&#x200B;.CONSTRA&#x200B;INT_NAME</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">20</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;WHER&#x200B;E&nbsp;&nbsp;&nbsp;&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME&nbsp;NOT&#x200B;&nbsp;LIKE&nbsp;'A&#x200B;PP[_]CRE&#x200B;ATE%'</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">21</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;AND&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME&nbsp;NOT&#x200B;&nbsp;LIKE&nbsp;'A&#x200B;PP[_]LAS&#x200B;T%'</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">22</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;AND&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME&nbsp;NOT&#x200B;&nbsp;LIKE&nbsp;'D&#x200B;B[_]CREA&#x200B;TE%'</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">23</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;AND&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME&nbsp;NOT&#x200B;&nbsp;LIKE&nbsp;'D&#x200B;B[_]LAST&#x200B;%'</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">24</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;AND&nbsp;COL&#x200B;.COLUMN_&#x200B;NAME&nbsp;NOT&#x200B;&nbsp;LIKE&nbsp;'C&#x200B;ONCURREN&#x200B;CY[_]%'</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">25</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;AND&nbsp;((C&#x200B;ON.CONST&#x200B;RAINT_TY&#x200B;PE&nbsp;&#60;>&nbsp;'P&#x200B;RIMARY&nbsp;K&#x200B;EY')&nbsp;OR</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">26</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(C&#x200B;ON.CONST&#x200B;RAINT_TY&#x200B;PE&nbsp;IS&nbsp;NU&#x200B;LL))</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">27</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#x200B;&nbsp;AND&nbsp;COL&#x200B;.TABLE_N&#x200B;AME&nbsp;=&nbsp;'P&#x200B;IMS_LEAS&#x200B;E_PAYMEN&#x200B;T';</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">28</td>
<td class="A">&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">29</td>
<td class="A">&#x200B;&nbsp;&nbsp;OPEN&nbsp;s&#x200B;ql_state&#x200B;ment;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">30</td>
<td class="A">&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">31</td>
<td class="A">&#x200B;&nbsp;&nbsp;FETCH&nbsp;&#x200B;NEXT&nbsp;FRO&#x200B;M&nbsp;sql_st&#x200B;atement&nbsp;&#x200B;INTO&nbsp;@tm&#x200B;pVal;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">32</td>
<td class="A">&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">33</td>
<td class="A">&#x200B;&nbsp;&nbsp;WHILE&nbsp;&#x200B;@@FETCH_&#x200B;STATUS&nbsp;=&#x200B;&nbsp;0</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">34</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;BEGI&#x200B;N</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">35</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;&#x200B;@retVal&nbsp;&#x200B;=&nbsp;CONCAT&#x200B;_WS(CHAR&#x200B;(10),&nbsp;@r&#x200B;etVal,&nbsp;@&#x200B;tmpVal);</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">36</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;FETC&#x200B;H&nbsp;NEXT&nbsp;F&#x200B;ROM&nbsp;sql_&#x200B;statemen&#x200B;t&nbsp;INTO&nbsp;@&#x200B;tmpVal</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">37</td>
<td class="A">&#x200B;&nbsp;&nbsp;&nbsp;&nbsp;END</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">38</td>
<td class="A">&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">39</td>
<td class="A">&#x200B;&nbsp;&nbsp;CLOSE&nbsp;&#x200B;sql_stat&#x200B;ement;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">40</td>
<td class="A">&#x200B;&nbsp;&nbsp;DEALLO&#x200B;CATE&nbsp;sql&#x200B;_stateme&#x200B;nt;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">41</td>
<td class="A">&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">42</td>
<td class="A">&#x200B;&nbsp;&nbsp;RETURN&#x200B;&nbsp;@retVal&#x200B;;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">43</td>
<td class="A">&nbsp;</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">44</td>
<td class="A">&#x200B;END</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">45</td>
<td class="A">&#x200B;GO</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">46</td>
<td class="A">&#x200B;ALTER&nbsp;AU&#x200B;THORIZAT&#x200B;ION&nbsp;ON&nbsp;O&#x200B;BJECT::S&#x200B;parse_Up&#x200B;date_Col&#x200B;umn&nbsp;TO&nbsp;d&#x200B;bo</td>
</tr>
<tr>
<td class="L"> </td>
<td class="B">&nbsp;</td>
<td class="L">47</td>
<td class="A">&#x200B;GO</td>
</tr>
</table>
</body>
</html>