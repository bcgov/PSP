-- Script generated by Aqua Data Studio Schema Synchronization for MS SQL Server 2016 on Tue Oct 05 16:47:03 PDT 2021
-- Execute this script on:
-- 		PIMS_S09_01/pmbc - This database/schema will be modified
-- to synchronize it with MS SQL Server 2016:
-- 		PIMS_S09_02/pmbc

-- We recommend backing up the database prior to executing the script.

SET XACT_ABORT ON
GO
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
GO
BEGIN TRANSACTION
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

-- Create table pmbc.PMBC_PARCEL_POLYGON_FABRIC if not existing
PRINT N'Create table pmbc.PMBC_PARCEL_POLYGON_FABRIC'
GO
IF NOT EXISTS (SELECT *
               FROM   information_schema.tables
			   WHERE  table_schema = 'pmbc'
			      AND table_name   = 'PMBC_PARCEL_POLYGON_FABRIC')
  BEGIN
  CREATE TABLE [pmbc].[PMBC_PARCEL_POLYGON_FABRIC] (
    [PARCEL_FABRIC_POLY_ID] INTEGER NOT NULL,
    [GLOBAL_UID]            NVARCHAR(254),
    [PARCEL_NAME]           NVARCHAR(50),
    [PLAN_ID]               INTEGER,
    [PLAN_NUMBER]           NVARCHAR(128),
    [PIN]                   INTEGER,
    [PID]                   NVARCHAR(9),
    [PID_NUMBER]            INTEGER,
    [SOURCE_PARCEL_ID]      NVARCHAR(50),
    [PARCEL_STATUS]         NVARCHAR(20),
    [PARCEL_CLASS]          NVARCHAR(50),
    [OWNER_TYPE]            NVARCHAR(50),
    [PARCEL_START_DATE]     DATETIME,
    [SURVEY_DESIGNATION_1]  NVARCHAR(30),
    [SURVEY_DESIGNATION_2]  NVARCHAR(30),
    [SURVEY_DESIGNATION_3]  NVARCHAR(30),
    [LEGAL_DESCRIPTION]     NVARCHAR(2000), 
    [MUNICIPALITY]          NVARCHAR(254),
    [REGIONAL_DISTRICT]     NVARCHAR(50),
    [IS_REMAINDER_IND]      NVARCHAR(3),
    [GEOMETRY_SOURCE]       NVARCHAR(50),
    [POSITIONAL_ERROR]      BIGINT,
    [ERROR_REPORTED_BY]     NVARCHAR(50),
    [CAPTURE_METHOD]        NVARCHAR(50),
    [COMPILED_IND]          NVARCHAR(5),
    [STATED_AREA]           NVARCHAR(50),
    [WHEN_CREATED]          DATETIME,
    [WHEN_UPDATED]          DATETIME,
    [FEATURE_AREA_SQM]      BIGINT,
    [FEATURE_LENGTH_M]      BIGINT,
    [SHAPE]                 GEOMETRY,
    [OBJECTID]              NUMERIC(38),
    [SE_ANNO_CAD_DATA]      VARBINARY(max),
    CONSTRAINT [PRCPLY_PK] PRIMARY KEY ([PARCEL_FABRIC_POLY_ID])
    )

   EXECUTE sp_addextendedproperty N'MS_Description', N'The ParcelMap BC (PMBC) parcel fabric contains all active titled parcels and surveyed provincial Crown land parcels in BC. For building strata parcels, there is a record, with PID value, for each parcel within the strata parcel; the geometry for those records is the geometry for the overall strata. This dataset is polygonal and contains all parcel attributes.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', NULL, NULL
   EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_FABRIC_POLY_ID is a system generated unique identification number.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_FABRIC_POLY_ID'
   EXECUTE sp_addextendedproperty N'MS_Description', N'GLOBAL_UID is a unique global identifier (GUID) for the parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'GLOBAL_UID'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_NAME is the same as the PID, if there is one. If there is a PIN but no PID, then PARCEL_NAME is the PIN. If there is no PID nor PIN, then PARCEL_NAME is the parcel class value, e.g., COMMON OWNERSHIP, BUILDING STRATA, AIR SPACE, ROAD, PARK.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_NAME'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PLAN_ID is the unique identifier of the land survey plan that corresponds to this parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PLAN_ID'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PLAN_NUMBER is the Land Act, Land Title Act, or Strata Property Act Plan Number for the land survey plan that corresponds to this parcel, e.g., VIP1632, NO_PLAN.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PLAN_NUMBER'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PIN is the Crown Land Registry Parcel Identifier, if applicable.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PIN'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PID is the Land Title Register parcel identifier, a left-zero-padded nine-digit number that uniquely identifies a parcel in the land title register of in British Columbia. The registrar assigns PID numbers to parcels for which a title is being entered as a registered title. The Land Title Act refers to the PID as the permanent parcel identifier.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PID'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PID_NUMBER is the PID, without leading zeroes. PID is the Land Title Register parcel identifier, a nine-digit number that uniquely identifies a parcel in the land title register of in British Columbia. The registrar assigns PID numbers to parcels for which a title is being entered as a registered title. The Land Title Act refers to the PID as the permanent parcel identifier.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PID_NUMBER'
   EXECUTE sp_addextendedproperty N'MS_Description', N'SOURCE_PARCEL_ID is the unique parcel identifier supplied by the source data provider. The value is intended to assist local governments by providing traceability back to the source data provider''s parcel ID. It will not be populated during on-going operations, e.g., DATA_NEW, CPG000050, 999, 01762.146.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SOURCE_PARCEL_ID'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_STATUS is the status of the parcel, according to the Land Title Register or Crown Land Registry, as appropriate, i.e., ACTIVE, CANCELLED, INACTIVE, PENDING.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_STATUS'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_CLASS is the Parcel classification for maintenance, mapping, publishing and analysis, i.e., PRIMARY, SUBDIVISION, PART OF PRIMARY, BUILDING STRATA, BARE LAND STRATA, AIR SPACE, ROAD, HIGHWAY, PARK, INTEREST, COMMON OWNERSHIP, ABSOLUTE FEE BOOK, CROWN SUBDIVISION, RETURN TO CROWN.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_CLASS'
   EXECUTE sp_addextendedproperty N'MS_Description', N'OWNER_TYPE is the general ownership category, e.g., PRIVATE, CROWN PROVINCIAL, MUNICIPAL.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'OWNER_TYPE'
   EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_START_DATE is the date of the legal event that created the parcel, i.e., the date the plan was filed.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_START_DATE'
   EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_1 is, typically, the smallest division of lands in a survey. If available, this is generally the Parcel from a Subdivided short legal description or the Quadrant or Block from an Unsubdivided short legal description, e.g., PARCEL A, SW4.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_1'
   EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_2 is, typically, the second smallest division of lands in a survey. If available, this is generally the Lot from a Subdivided short legal description or the District Lot, Lot or Section from an Unsubdivided short legal description, e.g., LOT 2.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_2'
   EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_3 is, typically, the third smallest division of lands in a survey. If available, this is generally the Block from a Subdivided short legal description or the Range from an Unsubdivided short legal description, e.g., BLOCK H.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_3'
   EXECUTE sp_addextendedproperty N'MS_Description', N'LEGAL_DESCRIPTION is the full legal description of the parcel and is primarily recorded from the Land Title Register. Where recorded only in the Crown Land Registry, this attribute is to be populated from Tantalis for the fabric compilation, but maintained by PMBC during on-going operations.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'LEGAL_DESCRIPTION'
   EXECUTE sp_addextendedproperty N'MS_Description', N'MUNICIPALITY is the municipal area within which the parcel is located. The value is either RURAL (for parcels in unincorporated regions) or the name of a BC municipality.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'MUNICIPALITY'
   EXECUTE sp_addextendedproperty N'MS_Description', N'REGIONAL_DISTRICT is the name of the regional district in which the parcel is located, e.g., CAPITAL REGIONAL DISTRICT.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'REGIONAL_DISTRICT'
   EXECUTE sp_addextendedproperty N'MS_Description', N'IS_REMAINDER_IND indicates if the parcel is a remainder of the original, i.e., YES, NO.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'IS_REMAINDER_IND'
   EXECUTE sp_addextendedproperty N'MS_Description', N'GEOMETRY_SOURCE is the source of the parcel geometry data, e.g., ICIS CADASTRE, ICF, PMBC OPERATIONS.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'GEOMETRY_SOURCE'
   EXECUTE sp_addextendedproperty N'MS_Description', N'POSITIONAL_ERROR is the semi-major axis at the 95% confidence level of the least accurate point of the parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'POSITIONAL_ERROR'
   EXECUTE sp_addextendedproperty N'MS_Description', N'ERROR_REPORTED_BY is the organization or process reporting the error, i.e., LSA, DATA COMPILATION.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'ERROR_REPORTED_BY'
   EXECUTE sp_addextendedproperty N'MS_Description', N'CAPTURE_METHOD is an indicator of relative accuracy, i.e., UNKNOWN, COGO, SURVEY PLAN DATASET.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'CAPTURE_METHOD'
   EXECUTE sp_addextendedproperty N'MS_Description', N'COMPILED_IND indicates if the parcel polygon was generated from inverted dimensions, i.e., True, False. "True" means that the parcel geometry was from a previous source cadastre and not precision input based on plan dimensions.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'COMPILED_IND'
   EXECUTE sp_addextendedproperty N'MS_Description', N'STATED_AREA is the area of the parcel, in square metres. It is automatically calculated if misclose is small; it can be edited to reflect the recorded plan value.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'STATED_AREA'
   EXECUTE sp_addextendedproperty N'MS_Description', N'WHEN_CREATED is the date and time the source record was created (not the time when it was loaded into the BC Geographic Warehouse).', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'WHEN_CREATED'
   EXECUTE sp_addextendedproperty N'MS_Description', N'WHEN_UPDATED is the date and time the source record was last modified (not the time when it was loaded into, or modified in, the BC Geographic Warehouse).', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'WHEN_UPDATED'
   EXECUTE sp_addextendedproperty N'MS_Description', N'FEATURE_AREA_SQM is the system calculated area of a two-dimensional polygon in square meters.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'FEATURE_AREA_SQM'
   EXECUTE sp_addextendedproperty N'MS_Description', N'FEATURE_LENGTH_M is the system calculated length or perimeter of a geometry in meters.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'FEATURE_LENGTH_M'
   EXECUTE sp_addextendedproperty N'MS_Description', N'SHAPE is the column used to reference the spatial coordinates defining the feature.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SHAPE'
   EXECUTE sp_addextendedproperty N'MS_Description', N'OBJECTID is a column required by spatial layers that interact with ESRI ArcSDE. It is populated with unique values automatically by SDE.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'OBJECTID'
   EXECUTE sp_addextendedproperty N'MS_Description', N'SE_ANNO_CAD_DATA is a binary column used by spatial tools to store annotation, curve features and CAD data when using the SDO_GEOMETRY storage data type.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SE_ANNO_CAD_DATA'
   END
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

-- Create table pmbc.PMBC_BCTFA_PID if not existing
PRINT N'Create table pmbc.PMBC_BCTFA_PID'
GO
IF NOT EXISTS (SELECT *
               FROM   information_schema.tables
			   WHERE  table_schema = 'pmbc'
			      AND table_name   = 'PMBC_BCTFA_PID')
  BEGIN
  CREATE TABLE [pmbc].[PMBC_BCTFA_PID] (
    [PID] INTEGER NOT NULL,
    [IS_BCTFA_OWNED] BIT CONSTRAINT [TFAPID_IS_BCTFA_OWNED_DEF] DEFAULT 0,
    [CONCURRENCY_CONTROL_NUMBER] BIGINT CONSTRAINT [TFAPID_CONCURRENCY_CONTROL_NUMBER_DEF] DEFAULT 1 NOT NULL,
    [APP_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TFAPID_APP_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TFAPID_APP_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_CREATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_CREATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [TFAPID_APP_CREATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TFAPID_APP_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [APP_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TFAPID_APP_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [APP_LAST_UPDATE_USER_GUID] UNIQUEIDENTIFIER,
    [APP_LAST_UPDATE_USER_DIRECTORY] NVARCHAR(30) CONSTRAINT [TFAPID_APP_LAST_UPDATE_USER_DIRECTORY_DEF] DEFAULT user_name() NOT NULL,
    [DB_CREATE_TIMESTAMP] DATETIME CONSTRAINT [TFAPID_DB_CREATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_CREATE_USERID] NVARCHAR(30) CONSTRAINT [TFAPID_DB_CREATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    [DB_LAST_UPDATE_TIMESTAMP] DATETIME CONSTRAINT [TFAPID_DB_LAST_UPDATE_TIMESTAMP_DEF] DEFAULT getutcdate() NOT NULL,
    [DB_LAST_UPDATE_USERID] NVARCHAR(30) CONSTRAINT [TFAPID_DB_LAST_UPDATE_USERID_DEF] DEFAULT user_name() NOT NULL,
    CONSTRAINT [TFAPID_PK] PRIMARY KEY CLUSTERED ([PID])
  )
  
  EXECUTE sp_addextendedproperty N'MS_Description', N'Property identifier and primary key', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'PID'
  EXECUTE sp_addextendedproperty N'MS_Description', N'Indicates if the property is owned by BCTFA', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'IS_BCTFA_OWNED'
  EXECUTE sp_addextendedproperty N'MS_Description', N'Application code is responsible for retrieving the row and then incrementing the value of the CONCURRENCY_CONTROL_NUMBER column by one prior to issuing an update. If this is done then the update will succeed, provided that the row was not updated by any other application or user.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'CONCURRENCY_CONTROL_NUMBER'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The date and time the user created the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_CREATE_TIMESTAMP'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The user account that created the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_CREATE_USERID'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The GUID of the user account that created the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_CREATE_USER_GUID'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The directory of the user account that created the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_CREATE_USER_DIRECTORY'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The date and time the user updated the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_LAST_UPDATE_TIMESTAMP'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The user account that updated the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_LAST_UPDATE_USERID'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The GUID of the user account that updated the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_LAST_UPDATE_USER_GUID'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The directory of the user account that updated the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'APP_LAST_UPDATE_USER_DIRECTORY'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The date and time the record was created.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'DB_CREATE_TIMESTAMP'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The user or proxy account that created the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'DB_CREATE_USERID'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The date and time the record was created or last updated.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'DB_LAST_UPDATE_TIMESTAMP'
  EXECUTE sp_addextendedproperty N'MS_Description', N'The user or proxy account that created or last updated the record.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_BCTFA_PID', 'COLUMN', N'DB_LAST_UPDATE_USERID'
  END
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

---- Drop view pmbc.PMBC_BCTFA_PARCEL_POLYGON_FABRIC
--PRINT N'Drop view pmbc.PMBC_BCTFA_PARCEL_POLYGON_FABRIC'
--IF NOT EXISTS (SELECT *
--               FROM   sys.views
--			         WHERE  table_schema = 'pmbc'
--			            AND table_name   = 'PMBC_BCTFA_PARCEL_POLYGON_FABRIC')
--  BEGIN
--  DROP VIEW IF EXISTS [pmbc].[PMBC_BCTFA_PARCEL_POLYGON_FABRIC]
--  END
--GO
--IF @@ERROR <> 0 SET NOEXEC ON
--GO

-- Create view pmbc.PMBC_BCTFA_PARCEL_POLYGON_FABRIC
PRINT N'Create view pmbc.PMBC_BCTFA_PARCEL_POLYGON_FABRIC'
GO
CREATE VIEW [pmbc].[PMBC_BCTFA_PARCEL_POLYGON_FABRIC] AS
  SELECT
    tfapid.PID,
    tfapid.IS_BCTFA_OWNED,
    tfapid.CONCURRENCY_CONTROL_NUMBER,
    tfapid.APP_CREATE_TIMESTAMP,
    tfapid.APP_CREATE_USERID,
    tfapid.APP_CREATE_USER_GUID,
    tfapid.APP_CREATE_USER_DIRECTORY,
    tfapid.APP_LAST_UPDATE_TIMESTAMP,
    tfapid.APP_LAST_UPDATE_USERID,
    tfapid.APP_LAST_UPDATE_USER_GUID,
    tfapid.APP_LAST_UPDATE_USER_DIRECTORY,
    tfapid.DB_CREATE_TIMESTAMP,
    tfapid.DB_CREATE_USERID,
    tfapid.DB_LAST_UPDATE_TIMESTAMP,
    tfapid.DB_LAST_UPDATE_USERID,
    fabric.PARCEL_FABRIC_POLY_ID,
    fabric.GLOBAL_UID,
    fabric.PARCEL_NAME,
    fabric.PLAN_ID,
    fabric.PLAN_NUMBER,
    fabric.PIN,
    fabric.PID_NUMBER,
    fabric.SOURCE_PARCEL_ID,
    fabric.PARCEL_STATUS,
    fabric.PARCEL_CLASS,
    fabric.OWNER_TYPE,
    fabric.PARCEL_START_DATE,
    fabric.SURVEY_DESIGNATION_1,
    fabric.SURVEY_DESIGNATION_2,
    fabric.SURVEY_DESIGNATION_3,
    fabric.LEGAL_DESCRIPTION,
    fabric.MUNICIPALITY,
    fabric.REGIONAL_DISTRICT,
    fabric.IS_REMAINDER_IND,
    fabric.GEOMETRY_SOURCE,
    fabric.POSITIONAL_ERROR,
    fabric.ERROR_REPORTED_BY,
    fabric.CAPTURE_METHOD,
    fabric.COMPILED_IND,
    fabric.STATED_AREA,
    fabric.WHEN_CREATED,
    fabric.WHEN_UPDATED,
    fabric.FEATURE_AREA_SQM,
    fabric.FEATURE_LENGTH_M,
    fabric.SHAPE,
    fabric.OBJECTID,
    fabric.SE_ANNO_CAD_DATA
  FROM
     pmbc.PMBC_BCTFA_PID             tfapid INNER JOIN 
     pmbc.PMBC_PARCEL_POLYGON_FABRIC fabric ON tfapid.PID = fabric.PID
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

COMMIT TRANSACTION
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO
DECLARE @Success AS BIT
SET @Success = 1
SET NOEXEC OFF
IF (@Success = 1) PRINT 'The database update succeeded'
ELSE BEGIN
   IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION
   PRINT 'The database update failed'
END
GO
