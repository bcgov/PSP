-- Script generated by Aqua Data Studio Schema Synchronization for MS SQL Server 2016 on Tue Oct 05 16:47:03 PDT 2021
-- Execute this script on:
-- 		PIMS_S09_01/pmbc - This database/schema will be modified
-- to synchronize it with MS SQL Server 2016:
-- 		PIMS_S09_02/pmbc

-- We recommend backing up the database prior to executing the script.

SET XACT_ABORT ON
GO
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
GO
BEGIN TRANSACTION
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

-- Create PMBC schema
IF NOT EXISTS (SELECT * 
               FROM   sys.schemas 
               WHERE  name = N'pmbc')
  EXEC('CREATE SCHEMA [pmbc]');
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


-- Drop table pmbc.PMBC_PARCEL_POLYGON_FABRIC
PRINT N'Drop table pmbc.PMBC_PARCEL_POLYGON_FABRIC'
GO
DROP TABLE IF EXISTS [pmbc].[PMBC_PARCEL_POLYGON_FABRIC]
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


-- Create table pmbc.PMBC_PARCEL_POLYGON_FABRIC
PRINT N'Create table pmbc.PMBC_PARCEL_POLYGON_FABRIC'
GO
CREATE TABLE [pmbc].[PMBC_PARCEL_POLYGON_FABRIC] (
    [PARCEL_FABRIC_POLY_ID] INTEGER NOT NULL,
    [GLOBAL_UID]            NVARCHAR(254),
    [PARCEL_NAME]           NVARCHAR(50),
    [PLAN_ID]               INTEGER,
    [PLAN_NUMBER]           NVARCHAR(128),
    [PIN]                   INTEGER,
    [PID]                   NVARCHAR(9),
    [PID_NUMBER]            INTEGER,
    [SOURCE_PARCEL_ID]      NVARCHAR(50),
    [PARCEL_STATUS]         NVARCHAR(20),
    [PARCEL_CLASS]          NVARCHAR(50),
    [OWNER_TYPE]            NVARCHAR(50),
    [PARCEL_START_DATE]     DATETIME,
    [SURVEY_DESIGNATION_1]  NVARCHAR(30),
    [SURVEY_DESIGNATION_2]  NVARCHAR(30),
    [SURVEY_DESIGNATION_3]  NVARCHAR(30),
    [LEGAL_DESCRIPTION]     NVARCHAR(2000), 
    [MUNICIPALITY]          NVARCHAR(254),
    [REGIONAL_DISTRICT]     NVARCHAR(50),
    [IS_REMAINDER_IND]      NVARCHAR(3),
    [GEOMETRY_SOURCE]       NVARCHAR(50),
    [POSITIONAL_ERROR]      BIGINT,
    [ERROR_REPORTED_BY]     NVARCHAR(50),
    [CAPTURE_METHOD]        NVARCHAR(50),
    [COMPILED_IND]          NVARCHAR(5),
    [STATED_AREA]           NVARCHAR(50),
    [WHEN_CREATED]          DATETIME,
    [WHEN_UPDATED]          DATETIME,
    [FEATURE_AREA_SQM]      BIGINT,
    [FEATURE_LENGTH_M]      BIGINT,
    [SHAPE]                 GEOMETRY,
    [OBJECTID]              NUMERIC(38),
    [SE_ANNO_CAD_DATA]      VARBINARY(max),
    CONSTRAINT [PRCPLY_PK] PRIMARY KEY ([PARCEL_FABRIC_POLY_ID])
)
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'The ParcelMap BC (PMBC) parcel fabric contains all active titled parcels and surveyed provincial Crown land parcels in BC. For building strata parcels, there is a record, with PID value, for each parcel within the strata parcel; the geometry for those records is the geometry for the overall strata. This dataset is polygonal and contains all parcel attributes.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', NULL, NULL
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_FABRIC_POLY_ID is a system generated unique identification number.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_FABRIC_POLY_ID'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'GLOBAL_UID is a unique global identifier (GUID) for the parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'GLOBAL_UID'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'     PARCEL_NAME is the same as the PID, if there is one. If there is a PIN but no PID, then PARCEL_NAME is the PIN. If there is no PID nor PIN, then PARCEL_NAME is the parcel class value, e.g., COMMON OWNERSHIP, BUILDING STRATA, AIR SPACE, ROAD, PARK.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_NAME'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PLAN_ID is the unique identifier of the land survey plan that corresponds to this parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PLAN_ID'
GO

EXECUTE sp_addextendedproperty N'MS_Description', N'PLAN_NUMBER is the Land Act, Land Title Act, or Strata Property Act Plan Number for the land survey plan that corresponds to this parcel, e.g., VIP1632, NO_PLAN.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PLAN_NUMBER'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PIN is the Crown Land Registry Parcel Identifier, if applicable.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PIN'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PID is the Land Title Register parcel identifier, a left-zero-padded nine-digit number that uniquely identifies a parcel in the land title register of in British Columbia. The registrar assigns PID numbers to parcels for which a title is being entered as a registered title. The Land Title Act refers to the PID as the permanent parcel identifier.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PID'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PID_NUMBER is the PID, without leading zeroes. PID is the Land Title Register parcel identifier, a nine-digit number that uniquely identifies a parcel in the land title register of in British Columbia. The registrar assigns PID numbers to parcels for which a title is being entered as a registered title. The Land Title Act refers to the PID as the permanent parcel identifier.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PID_NUMBER'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SOURCE_PARCEL_ID is the unique parcel identifier supplied by the source data provider. The value is intended to assist local governments by providing traceability back to the source data provider''s parcel ID. It will not be populated during on-going operations, e.g., DATA_NEW, CPG000050, 999, 01762.146.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SOURCE_PARCEL_ID'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_STATUS is the status of the parcel, according to the Land Title Register or Crown Land Registry, as appropriate, i.e., ACTIVE, CANCELLED, INACTIVE, PENDING.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_STATUS'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_CLASS is the Parcel classification for maintenance, mapping, publishing and analysis, i.e., PRIMARY, SUBDIVISION, PART OF PRIMARY, BUILDING STRATA, BARE LAND STRATA, AIR SPACE, ROAD, HIGHWAY, PARK, INTEREST, COMMON OWNERSHIP, ABSOLUTE FEE BOOK, CROWN SUBDIVISION, RETURN TO CROWN.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_CLASS'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'OWNER_TYPE is the general ownership category, e.g., PRIVATE, CROWN PROVINCIAL, MUNICIPAL.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'OWNER_TYPE'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'PARCEL_START_DATE is the date of the legal event that created the parcel, i.e., the date the plan was filed.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'PARCEL_START_DATE'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_1 is, typically, the smallest division of lands in a survey. If available, this is generally the Parcel from a Subdivided short legal description or the Quadrant or Block from an Unsubdivided short legal description, e.g., PARCEL A, SW4.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_1'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_2 is, typically, the second smallest division of lands in a survey. If available, this is generally the Lot from a Subdivided short legal description or the District Lot, Lot or Section from an Unsubdivided short legal description, e.g., LOT 2.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_2'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SURVEY_DESIGNATION_3 is, typically, the third smallest division of lands in a survey. If available, this is generally the Block from a Subdivided short legal description or the Range from an Unsubdivided short legal description, e.g., BLOCK H.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SURVEY_DESIGNATION_3'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'LEGAL_DESCRIPTION is the full legal description of the parcel and is primarily recorded from the Land Title Register. Where recorded only in the Crown Land Registry, this attribute is to be populated from Tantalis for the fabric compilation, but maintained by PMBC during on-going operations.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'LEGAL_DESCRIPTION'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'MUNICIPALITY is the municipal area within which the parcel is located. The value is either RURAL (for parcels in unincorporated regions) or the name of a BC municipality.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'MUNICIPALITY'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'REGIONAL_DISTRICT is the name of the regional district in which the parcel is located, e.g., CAPITAL REGIONAL DISTRICT.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'REGIONAL_DISTRICT'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'IS_REMAINDER_IND indicates if the parcel is a remainder of the original, i.e., YES, NO.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'IS_REMAINDER_IND'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'GEOMETRY_SOURCE is the source of the parcel geometry data, e.g., ICIS CADASTRE, ICF, PMBC OPERATIONS.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'GEOMETRY_SOURCE'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'POSITIONAL_ERROR is the semi-major axis at the 95% confidence level of the least accurate point of the parcel.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'POSITIONAL_ERROR'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'ERROR_REPORTED_BY is the organization or process reporting the error, i.e., LSA, DATA COMPILATION.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'ERROR_REPORTED_BY'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'CAPTURE_METHOD is an indicator of relative accuracy, i.e., UNKNOWN, COGO, SURVEY PLAN DATASET.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'CAPTURE_METHOD'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'COMPILED_IND indicates if the parcel polygon was generated from inverted dimensions, i.e., True, False. "True" means that the parcel geometry was from a previous source cadastre and not precision input based on plan dimensions.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'COMPILED_IND'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'STATED_AREA is the area of the parcel, in square metres. It is automatically calculated if misclose is small; it can be edited to reflect the recorded plan value.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'STATED_AREA'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'WHEN_CREATED is the date and time the source record was created (not the time when it was loaded into the BC Geographic Warehouse).', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'WHEN_CREATED'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'WHEN_UPDATED is the date and time the source record was last modified (not the time when it was loaded into, or modified in, the BC Geographic Warehouse).', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'WHEN_UPDATED'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'FEATURE_AREA_SQM is the system calculated area of a two-dimensional polygon in square meters.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'FEATURE_AREA_SQM'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'FEATURE_LENGTH_M is the system calculated length or perimeter of a geometry in meters.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'FEATURE_LENGTH_M'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SHAPE is the column used to reference the spatial coordinates defining the feature.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SHAPE'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'OBJECTID is a column required by spatial layers that interact with ESRI ArcSDE. It is populated with unique values automatically by SDE.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'OBJECTID'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


EXECUTE sp_addextendedproperty N'MS_Description', N'SE_ANNO_CAD_DATA is a binary column used by spatial tools to store annotation, curve features and CAD data when using the SDO_GEOMETRY storage data type.', 'SCHEMA', N'pmbc', 'TABLE', N'PMBC_PARCEL_POLYGON_FABRIC', 'COLUMN', N'SE_ANNO_CAD_DATA'
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO


COMMIT TRANSACTION
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO
DECLARE @Success AS BIT
SET @Success = 1
SET NOEXEC OFF
IF (@Success = 1) PRINT 'The database update succeeded'
ELSE BEGIN
   IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION
   PRINT 'The database update failed'
END
GO
