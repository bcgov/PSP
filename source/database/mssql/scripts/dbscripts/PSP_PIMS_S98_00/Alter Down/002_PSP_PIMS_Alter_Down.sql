-- Script generated by Aqua Data Studio Schema Synchronization for MS SQL Server 2016 on Fri Jan 10 15:38:00 PST 2025
-- Execute this script on:
-- 		PSP_PIMS_S98_00/dbo - This database/schema will be modified
-- to synchronize it with MS SQL Server 2016:
-- 		PSP_PIMS_S97_00/dbo

-- We recommend backing up the database prior to executing the script.

SET XACT_ABORT ON
GO
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
GO
BEGIN TRANSACTION
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

-- Alter table dbo.PIMS_PROPERTY_RESEARCH_FILE
PRINT N'Alter table dbo.PIMS_PROPERTY_RESEARCH_FILE'
GO
-- Truncate data prior to reducing the column length.
UPDATE [dbo].[PIMS_PROPERTY_RESEARCH_FILE]
SET    RESEARCH_SUMMARY           = SUBSTRING(RESEARCH_SUMMARY, 1, 1000)
     , CONCURRENCY_CONTROL_NUMBER = CONCURRENCY_CONTROL_NUMBER + 1
WHERE  LEN(RESEARCH_SUMMARY) > 1000
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO
ALTER TABLE [dbo].[PIMS_PROPERTY_RESEARCH_FILE] ALTER COLUMN [RESEARCH_SUMMARY] nvarchar(1000) NULL
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

-- Alter table dbo.PIMS_PROPERTY_RESEARCH_FILE_HIST
PRINT N'Alter table dbo.PIMS_PROPERTY_RESEARCH_FILE_HIST'
GO
-- Truncate data prior to reducing the column length.
UPDATE [dbo].[PIMS_PROPERTY_RESEARCH_FILE_HIST]
SET    RESEARCH_SUMMARY           = SUBSTRING(RESEARCH_SUMMARY, 1, 1000)
     , CONCURRENCY_CONTROL_NUMBER = CONCURRENCY_CONTROL_NUMBER + 1
WHERE  LEN(RESEARCH_SUMMARY) > 1000
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO
ALTER TABLE [dbo].[PIMS_PROPERTY_RESEARCH_FILE_HIST] ALTER COLUMN [RESEARCH_SUMMARY] nvarchar(1000) NULL
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

-- Alter table dbo.PIMS_LEASE
PRINT N'Alter table dbo.PIMS_LEASE'
GO
-- Truncate data prior to reducing the column length.
UPDATE [dbo].[PIMS_LEASE]
SET    LEASE_DESCRIPTION          = SUBSTRING(LEASE_DESCRIPTION, 1, 2000)
     , CONCURRENCY_CONTROL_NUMBER = CONCURRENCY_CONTROL_NUMBER + 1
WHERE  LEN(LEASE_DESCRIPTION) > 2000
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO
ALTER TABLE [dbo].[PIMS_LEASE] ALTER COLUMN [LEASE_DESCRIPTION] nvarchar(2000) NULL
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

-- Alter table dbo.PIMS_LEASE_HIST
PRINT N'Alter table dbo.PIMS_LEASE_HIST'
GO
-- Truncate data prior to reducing the column length.
UPDATE [dbo].[PIMS_LEASE_HIST]
SET    LEASE_DESCRIPTION          = SUBSTRING(LEASE_DESCRIPTION, 1, 2000)
     , CONCURRENCY_CONTROL_NUMBER = CONCURRENCY_CONTROL_NUMBER + 1
WHERE  LEN(LEASE_DESCRIPTION) > 2000
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO
ALTER TABLE [dbo].[PIMS_LEASE_HIST] ALTER COLUMN [LEASE_DESCRIPTION] nvarchar(2000) NULL
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO

COMMIT TRANSACTION
GO
IF @@ERROR <> 0 SET NOEXEC ON
GO
DECLARE @Success AS BIT
SET @Success = 1
SET NOEXEC OFF
IF (@Success = 1) PRINT 'The database update succeeded'
ELSE BEGIN
   IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION
   PRINT 'The database update failed'
END
GO
